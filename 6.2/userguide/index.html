<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<link rel="icon" type="image/x-icon" href="images/favicon.ico">
<title></title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1><span class="image"><img src="images/resteasy_logo_200x.png" alt="RESTEasy"></span></h1>
<div class="details">
<span id="revnumber">version 6.2.11.Final,</span>
<span id="revdate">2024-11-11</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a></li>
<li><a href="#_license">2. License</a></li>
<li><a href="#installation_configuration">3. Installation/Configuration</a>
<ul class="sectlevel2">
<li><a href="#_resteasy_modules_in_wildfly">3.1. RESTEasy modules in WildFly</a></li>
<li><a href="#_deploying_a_resteasy_application_to_wildfly">3.2. Deploying a RESTEasy application to WildFly</a></li>
<li><a href="#_standalone_resteasy">3.3. Deploying to other servlet containers</a></li>
<li><a href="#_microprofile_config">3.4. Configuration</a></li>
<li><a href="#_configuration_switches">3.5. Configuration switches</a></li>
<li><a href="#_jakarta.ws.rs.core.application">3.6. <code>jakarta.ws.rs.core.Application</code></a></li>
<li><a href="#_client_side">3.7. Client side</a></li>
<li><a href="#_configuring_providers">3.8. Configuring Providers</a></li>
</ul>
</li>
<li><a href="#_using_path">4. Using <code>@Path</code> and <code>@GET</code>, <code>@POST</code>, etc.</a>
<ul class="sectlevel2">
<li><a href="#_path_and_regular_expression_mappings">4.1. <code>@Path</code> and regular expression mappings</a></li>
</ul>
</li>
<li><a href="#_pathparam">5. @PathParam</a>
<ul class="sectlevel2">
<li><a href="#_advanced__pathparam_and_regular_expressions">5.1. Advanced @PathParam and Regular Expressions</a></li>
<li><a href="#_pathparam_and_pathsegment">5.2. @PathParam and PathSegment</a></li>
</ul>
</li>
<li><a href="#_queryparam">6. @QueryParam</a></li>
<li><a href="#_headerparam">7. @HeaderParam</a>
<ul class="sectlevel2">
<li><a href="#_header_delegates">7.1. Header Delegates</a></li>
</ul>
</li>
<li><a href="#_linkheader">8. Linking resources</a>
<ul class="sectlevel2">
<li><a href="#_link_headers">8.1. Link Headers</a></li>
<li><a href="#_atom_links_in_the_resource_representations">8.2. Atom links in the resource representations</a></li>
</ul>
</li>
<li><a href="#_matrixparam">9. @MatrixParam</a></li>
<li><a href="#_cookieparam">10. @CookieParam</a></li>
<li><a href="#_formparam">11. @FormParam</a></li>
<li><a href="#_form">12. @Form</a></li>
<li><a href="#_newparam">13. Improved <code>@&#8230;&#8203;Param</code> annotations</a></li>
<li><a href="#_optionalparam">14. Optional parameter types</a></li>
<li><a href="#_defaultvalue">15. @DefaultValue</a></li>
<li><a href="#_encoded_and_encoding">16. @Encoded and encoding</a></li>
<li><a href="#_context">17. @Context</a></li>
<li><a href="#_jakarta_rest_resource_locators_and_sub_resources">18. Jakarta RESTful Web Services Resource Locators and Sub Resources</a></li>
<li><a href="#_resources_metadata">19. Resources metadata configuration</a></li>
<li><a href="#_jakarta_rest_content_negotiation">20. Jakarta RESTful Web Services Content Negotiation</a>
<ul class="sectlevel2">
<li><a href="#_media_mappings">20.1. URL-based negotiation</a></li>
<li><a href="#_param_media_mappings">20.2. Query String Parameter-based negotiation</a></li>
</ul>
</li>
<li><a href="#_content_marshallingproviders">21. Content Marshalling/Providers</a>
<ul class="sectlevel2">
<li><a href="#_default_providers_and_default_jakarta_restful_web_services_content_marshalling">21.1. Default Providers and default Jakarta RESTful Web Services Content Marshalling</a></li>
<li><a href="#_content_marshalling_with__provider_classes">21.2. Content Marshalling with @Provider classes</a></li>
<li><a href="#_messagebodyworkers">21.3. Providers Utility Class</a></li>
<li><a href="#_configuring_document_marshalling">21.4. Configuring Document Marshalling</a></li>
<li><a href="#_text_media_types">21.5. Text media types and character sets</a></li>
</ul>
</li>
<li><a href="#_built_in_xml_bind_providers">22. Jakarta XML Binding providers</a>
<ul class="sectlevel2">
<li><a href="#_decorators">22.1. Jakarta XML Binding Decorators</a></li>
<li><a href="#_pluggable_xml_bind_context_s_with_contextresolvers">22.2. Pluggable JAXBContext&#8217;s with ContextResolvers</a></li>
<li><a href="#_jakarta_xml_binding_xml_provider">22.3. Jakarta XML Binding + XML provider</a></li>
<li><a href="#_jakarta_xml_binding_json_provider">22.4. Jakarta XML Binding + JSON provider</a></li>
<li><a href="#_jakarta_xml_binding_fastinfoset_provider">22.5. Jakarta XML Binding + FastinfoSet provider</a></li>
<li><a href="#_xml_bind_api_collections">22.6. Arrays and Collections of Jakarta XML Binding Objects</a></li>
<li><a href="#_xml_map">22.7. Maps of XML Objects</a></li>
<li><a href="#_xml_bind_interfaces">22.8. Interfaces, Abstract Classes, and Jakarta XML Binding</a></li>
<li><a href="#_configuring_jakarta_xml_binding_marshalling">22.9. Configuring Jakarta XML Binding Marshalling</a></li>
</ul>
</li>
<li><a href="#_atom">23. RESTEasy Atom Support</a>
<ul class="sectlevel2">
<li><a href="#_resteasy_atom">23.1. RESTEasy Atom API and Provider</a></li>
<li><a href="#_xml_bind_api_atom">23.2. Using Jakarta XML Binding with the Atom Provider</a></li>
</ul>
</li>
<li><a href="#_json">24. JSON Support via Jackson</a>
<ul class="sectlevel2">
<li><a href="#_using_jackson_2_outside_of_wildfly">24.1. Using Jackson 2 Outside of WildFly</a></li>
<li><a href="#_jakarta_xml_binding_annotations">24.2. Jakarta XML Binding Annotations</a></li>
<li><a href="#_additional_resteasy_specifics">24.3. Additional RESTEasy Specifics</a></li>
<li><a href="#_jsonp_support">24.4. JSONP Support</a></li>
<li><a href="#_jackson_json_decorator">24.5. Jackson JSON Decorator</a></li>
<li><a href="#_json_filter_support">24.6. JSON Filter Support</a></li>
</ul>
</li>
<li><a href="#_polymorphic_typing_deserialization">25. Polymorphic Typing deserialization</a></li>
<li><a href="#_json_p">26. JSON Support via Jakarta EE JSON-P API</a></li>
<li><a href="#_multipart">27. Multipart Providers</a>
<ul class="sectlevel2">
<li><a href="#_multipart_mixed_group">27.1. Multipart/mixed</a></li>
<li><a href="#_multipart_related_group">27.2. Multipart/related</a></li>
<li><a href="#_multipart_formdata_group">27.3. Multipart/form-data</a></li>
<li><a href="#_multipart_parsing_note">27.4. Note about multipart parsing and working with other frameworks</a></li>
<li><a href="#_multipart_overwrite_default_content_type">27.5. Overwriting the default fallback content type for multipart messages</a></li>
<li><a href="#_multipart_overwrite_content_type">27.6. Overwriting the content type for multipart messages</a></li>
<li><a href="#_multipart_overwrite_default_charset">27.7. Overwriting the default fallback charset for multipart messages</a></li>
</ul>
</li>
<li><a href="#_jakarta_rest_2.1_additions">28. Jakarta RESTful Web Services 2.1 Additions</a>
<ul class="sectlevel2">
<li><a href="#_completionstage_support">28.1. <code>CompletionStage</code> support</a></li>
</ul>
</li>
<li><a href="#_reactive_clients_api">29. Reactive Clients API</a>
<ul class="sectlevel2">
<li><a href="#_sse_server">29.1. Server-Sent Events (SSE)</a></li>
<li><a href="#_java_api_for_json_binding">29.2. Java API for JSON Binding</a></li>
<li><a href="#_json_patch_and_json_merge_patch">29.3. JSON Patch and JSON Merge Patch</a></li>
</ul>
</li>
<li><a href="#_stringconverter">30. String marshalling for String based @*Param</a>
<ul class="sectlevel2">
<li><a href="#_simple_conversion">30.1. Simple conversion</a></li>
<li><a href="#_paramconverter">30.2. ParamConverter</a></li>
<li><a href="#_stringparameterunmarshaller">30.3. StringParameterUnmarshaller</a></li>
<li><a href="#_collections">30.4. Collections</a></li>
<li><a href="#_extension_to_paramconverter_semantics">30.5. Extension to <code>ParamConverter</code> semantics</a></li>
<li><a href="#_default_multiple_valued_paramconverter">30.6. Default multiple valued <code>ParamConverter</code></a></li>
</ul>
</li>
<li><a href="#_responses_using_jakarta.ws.rs.core.response">31. Responses using jakarta.ws.rs.core.Response</a></li>
<li><a href="#_exceptionhandling">32. Exception Handling</a>
<ul class="sectlevel2">
<li><a href="#_exceptionmappers">32.1. Exception Mappers</a></li>
<li><a href="#_builtinexception">32.2. RESTEasy Built-in Internally-Thrown Exceptions</a></li>
<li><a href="#_resteasywebapplicationexception">32.3. Resteasy WebApplicationExceptions</a></li>
<li><a href="#_overring_resteasy_exceptions">32.4. Overriding RESTEasy Builtin Exceptions</a></li>
</ul>
</li>
<li><a href="#_gzip">33. Content encoding</a>
<ul class="sectlevel2">
<li><a href="#_gzip_compressiondecompression">33.1. GZIP Compression/Decompression</a></li>
<li><a href="#_general_content_encoding">33.2. General content encoding</a></li>
</ul>
</li>
<li><a href="#_cors">34. CORS</a></li>
<li><a href="#_contentrange">35. Content-Range Support</a></li>
<li><a href="#_cache_nocache_cachecontrol">36. RESTEasy Caching Features</a>
<ul class="sectlevel2">
<li><a href="#_cache_annotation">36.1. @Cache and @NoCache Annotations</a></li>
<li><a href="#_client_cache">36.2. Client "Browser" Cache</a></li>
<li><a href="#_server_cache">36.3. Local Server-Side Response Cache</a></li>
<li><a href="#_http_precondition">36.4. HTTP preconditions</a></li>
</ul>
</li>
<li><a href="#_interceptors">37. Filters and Interceptors</a>
<ul class="sectlevel2">
<li><a href="#_server_side_filters">37.1. Server Side Filters</a></li>
<li><a href="#_client_side_filters">37.2. Client Side Filters</a></li>
<li><a href="#_reader_and_writer_interceptors">37.3. Reader and Writer Interceptors</a></li>
<li><a href="#_per_resource_method_filters_and_interceptors">37.4. Per Resource Method Filters and Interceptors</a></li>
<li><a href="#_ordering">37.5. Ordering</a></li>
</ul>
</li>
<li><a href="#_asynchronous_http_request_processing">38. Asynchronous HTTP Request Processing</a>
<ul class="sectlevel2">
<li><a href="#_using_the_suspended_annotation">38.1. Using the <code>@Suspended</code> annotation</a></li>
<li><a href="#_using_reactive_return_types">38.2. Using Reactive return types</a></li>
<li><a href="#_asynchronous_filters">38.3. Asynchronous filters</a></li>
<li><a href="#_asynchronous_io">38.4. Asynchronous IO</a></li>
</ul>
</li>
<li><a href="#_async_job_service">39. Asynchronous Job Service</a>
<ul class="sectlevel2">
<li><a href="#_async_job">39.1. Using Async Jobs</a></li>
<li><a href="#_oneway">39.2. Oneway: Fire and Forget</a></li>
<li><a href="#_async_job_setup">39.3. Setup and Configuration</a></li>
</ul>
</li>
<li><a href="#_async_injection">40. Asynchronous Injection</a>
<ul class="sectlevel2">
<li><a href="#_contextinjector_interface">40.1. org.jboss.resteasy.spi.ContextInjector Interface</a></li>
<li><a href="#_singlefoo_example">40.2. Single&lt;Foo&gt; Example</a></li>
<li><a href="#_injectory_with_annotations_example">40.3. Async Injector With Annotations Example</a></li>
</ul>
</li>
<li><a href="#_reactive">41. Reactive programming support</a>
<ul class="sectlevel2">
<li><a href="#_completionstage">41.1. CompletionStage</a></li>
<li><a href="#_completionstage_in_jakarta_restful_web_services">41.2. CompletionStage in Jakarta RESTful Web Services</a></li>
<li><a href="#_beyond_completionstage">41.3. Beyond CompletionStage</a></li>
<li><a href="#_pluggable_reactive_types_rxjava_2_in_resteasy">41.4. Pluggable reactive types: RxJava 2 in RESTEasy</a></li>
<li><a href="#_proxies">41.5. Proxies</a></li>
<li><a href="#_adding_extensions">41.6. Adding extensions</a></li>
</ul>
</li>
<li><a href="#_se_bootstrap">42. Jakarta RESTful Web Services SeBootstrap</a>
<ul class="sectlevel2">
<li><a href="#_sebootstrap_overview">42.1. Overview</a></li>
<li><a href="#_sebootstrap_usage">42.2. Usage</a></li>
<li><a href="#_sebootstrap_config_options">42.3. Configuration Options</a></li>
</ul>
</li>
<li><a href="#_resteasy_embedded_container">43. Embedded Containers</a>
<ul class="sectlevel2">
<li><a href="#_undertow">43.1. Undertow</a></li>
<li><a href="#_oracle_jdk_http_server">43.2. Oracle JDK HTTP Server</a></li>
<li><a href="#_netty">43.3. Netty</a></li>
<li><a href="#_reactor_netty">43.4. Reactor-Netty</a></li>
<li><a href="#_vert_x">43.5. Vert.x</a></li>
<li><a href="#_embeddedjaxrsserver">43.6. EmbeddedJaxrsServer</a></li>
</ul>
</li>
<li><a href="#_resteasy_server_side_mock_framework">44. Server-side Mock Framework</a></li>
<li><a href="#_securing_jakarta_rest_and_resteasy">45. Securing Jakarta RESTful Web Services and RESTEasy</a></li>
<li><a href="#_json_web_signature_and_encryption_jose_jwt">46. JSON Web Signature and Encryption (JOSE-JWT)</a></li>
<li><a href="#_json_web_signature_jws">47. JSON Web Signature (JWS)</a></li>
<li><a href="#_json_web_encryption_jwe">48. JSON Web Encryption (JWE)</a></li>
<li><a href="#_signature">49. Doseta Digital Signature Framework</a>
<ul class="sectlevel2">
<li><a href="#_maven_settings">49.1. Maven settings</a></li>
<li><a href="#_signing_api">49.2. Signing API</a></li>
<li><a href="#_signature_verification_api">49.3. Signature Verification API</a></li>
<li><a href="#_managing_keys_via_a_keyrepository">49.4. Managing Keys via a KeyRepository</a></li>
</ul>
</li>
<li><a href="#_body_encryption_and_signing_via_smime">50. Body Encryption and Signing via SMIME</a>
<ul class="sectlevel2">
<li><a href="#_maven_settings_2">50.1. Maven settings</a></li>
<li><a href="#_message_body_encryption">50.2. Message Body Encryption</a></li>
<li><a href="#_message_body_signing">50.3. Message Body Signing</a></li>
<li><a href="#_applicationpkcs7_signature">50.4. application/pkcs7-signature</a></li>
</ul>
</li>
<li><a href="#_resteasy_enterprise_bean_integration">51. Jakarta Enterprise Beans Integration</a></li>
<li><a href="#_resteasy_spring_integration">52. Spring Integration</a>
<ul class="sectlevel2">
<li><a href="#_integration_overview">52.1. Overview</a></li>
<li><a href="#_basicintegration">52.2. Basic Integration</a></li>
<li><a href="#_customizedconfiguration">52.3. Customized Configuration</a></li>
<li><a href="#_springmvc">52.4. Spring MVC Integration</a></li>
<li><a href="#_springundertow">52.5. Undertow Embedded Spring Container</a></li>
<li><a href="#_springwebannotation">52.6. Processing Spring Web REST annotations in RESTEasy</a></li>
<li><a href="#_springbootstarter">52.7. Spring Boot starter</a></li>
<li><a href="#_springupgradeinwildfly">52.8. Upgrading in Wildfly</a></li>
</ul>
</li>
<li><a href="#_cdi">53. CDI Integration</a>
<ul class="sectlevel2">
<li><a href="#_using_cdi_beans_as_jakarta_restful_web_services_components">53.1. Using CDI beans as Jakarta RESTful Web Services components</a></li>
<li><a href="#_default_scopes">53.2. Default scopes</a></li>
<li><a href="#_configuration_within_wildfly">53.3. Configuration within WildFly</a></li>
<li><a href="#_configuration_with_different_distributions">53.4. Configuration with different distributions</a></li>
</ul>
</li>
<li><a href="#_resteasy_client_framework">54. RESTEasy Client API</a>
<ul class="sectlevel2">
<li><a href="#_jakarta_restful_web_services_client_api">54.1. Jakarta RESTful Web Services Client API</a></li>
<li><a href="#_client_proxies">54.2. RESTEasy Proxy Framework</a></li>
<li><a href="#_transport_layer">54.3. Apache HTTP Client 4.x and other backends</a></li>
<li><a href="#_client_utilities">54.4. Client Utilities</a></li>
</ul>
</li>
<li><a href="#_microprofile_rest_client">55. MicroProfile Rest Client</a>
<ul class="sectlevel2">
<li><a href="#_client_proxies_2">55.1. Client proxies</a></li>
<li><a href="#_concepts_imported_from_jakarta_restful_web_services">55.2. Concepts imported from Jakarta RESTful Web Services</a></li>
<li><a href="#_beyond_jakarta_restful_web_services_and_resteasy">55.3. Beyond Jakarta RESTful Web Services and RESTEasy</a></li>
</ul>
</li>
<li><a href="#_ajax_client">56. AJAX Client</a>
<ul class="sectlevel2">
<li><a href="#_generated_javascript_api">56.1. Generated JavaScript API</a></li>
<li><a href="#_using_the_javascript_api_to_build_ajax_queries">56.2. Using the JavaScript API to build AJAX queries</a></li>
<li><a href="#_caching_features">56.3. Caching Features</a></li>
</ul>
</li>
<li><a href="#_wadl">57. RESTEasy WADL Support</a>
<ul class="sectlevel2">
<li><a href="#_resteasy_wadl_support_for_servlet_container_deprecated">57.1. RESTEasy WADL Support for Servlet Container <strong>(Deprecated)</strong></a></li>
<li><a href="#_resteasy_wadl_support_for_servlet_containerupdated">57.2. RESTEasy WADL Support for Servlet Container(Updated)</a></li>
<li><a href="#_resteasy_wadl_support_for_sun_jdk_http_server">57.3. RESTEasy WADL support for Sun JDK HTTP Server</a></li>
<li><a href="#_resteasy_wadl_support_for_netty_container">57.4. RESTEasy WADL support for Netty Container</a></li>
<li><a href="#_resteasy_wadl_support_for_undertow_container">57.5. RESTEasy WADL Support for Undertow Container</a></li>
</ul>
</li>
<li><a href="#_tracing_feature">58. RESTEasy Tracing Feature</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">58.1. Overview</a></li>
<li><a href="#_tracing_info_mode">58.2. Tracing Info Mode</a></li>
<li><a href="#_tracing_info_level">58.3. Tracing Info Level</a></li>
<li><a href="#_basic_usages">58.4. Basic Usages</a></li>
<li><a href="#_client_side_tracing_info">58.5. Client Side Tracing Info</a></li>
<li><a href="#_json_formatted_response">58.6. Json Formatted Response</a></li>
<li><a href="#_on_demand_mode_usage">58.7. ON_DEMAND Mode Usage</a></li>
<li><a href="#_list_of_tracing_events">58.8. List Of Tracing Events</a></li>
<li><a href="#_tracing_example">58.9. Tracing Example</a></li>
</ul>
</li>
<li><a href="#_validation">59. Validation</a>
<ul class="sectlevel2">
<li><a href="#_violation_reporting">59.1. Violation reporting</a></li>
<li><a href="#_validation_service_providers">Validation Service Providers</a></li>
<li><a href="#_validation_implementations">59.2. Validation Implementations</a></li>
</ul>
</li>
<li><a href="#_i18n">60. Internationalization and Localization</a>
<ul class="sectlevel2">
<li><a href="#_internationalization">60.1. Internationalization</a></li>
</ul>
</li>
<li><a href="#_localization">61. Localization</a></li>
<li><a href="#_maven_and_resteasy">62. Maven and RESTEasy</a></li>
<li><a href="#_migration_from_older_versions">63. Migration from older versions</a>
<ul class="sectlevel2">
<li><a href="#_migration_to_resteasy_3_0_series">63.1. Migration to RESTEasy 3.0 series</a></li>
<li><a href="#_migration_to_resteasy_3.1">63.2. Migration to RESTEasy 3.1 series</a></li>
<li><a href="#_migration_to_resteasy_3_5_series">63.3. Migration to RESTEasy 3.5+ series</a></li>
<li><a href="#_migration_to_resteasy_4_series">63.4. Migration to RESTEasy 4 series</a></li>
</ul>
</li>
<li><a href="#_books_you_can_read">64. Books You Can Read</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>1. Overview</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This version, 6.2.11.Final, of RESTEasy supports <a href="https://jakarta.ee/specifications/restful-ws/3.1/jakarta-restful-ws-spec-3.1" target="_blank" rel="noopener">Jakarta RESTful Web Services 3.1</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Originally released in 2009, RESTEasy has tracked and implemented a series of official specifications that provide a Java API for RESTful Web Services over the HTTP protocol:</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">RESTEasy version</th>
<th class="tableblock halign-left valign-top">Specification</th>
<th class="tableblock halign-left valign-top">JavaDoc/Changes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.1+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jakarta.ee/specifications/restful-ws/3.1/jakarta-restful-ws-spec-3.1.html" target="_blank" rel="noopener">Jakarta RESTful Web Services 3.1</a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/" target="_blank" rel="noopener">JavaDoc</a></p>
</li>
<li>
<p><a href="https://jakarta.ee/specifications/restful-ws/3.1/jakarta-restful-ws-spec-3.1.html#changes-since-3.0-release" target="_blank" rel="noopener">Changes</a></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jakarta.ee/specifications/restful-ws/3.0/jakarta-restful-ws-spec-3.0.html" target="_blank" rel="noopener">Jakarta RESTful Web Services 3.0</a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://jakarta.ee/specifications/restful-ws/3.0/apidocs/" target="_blank" rel="noopener">JavaDoc</a></p>
</li>
<li>
<p><a href="https://jakarta.ee/specifications/restful-ws/3.0/jakarta-restful-ws-spec-3.0.html#changes-since-2.1-release" target="_blank" rel="noopener">Changes</a></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.5+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jakarta.ee/specifications/restful-ws/2.1/restful-ws-spec-2.1.html" target="_blank" rel="noopener">Jakarta RESTful Web Services 2.1</a></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><a href="https://jakarta.ee/specifications/restful-ws/2.1/apidocs/" target="_blank" rel="noopener">JavaDoc</a></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jcp.org/en/jsr/detail?id=339" target="_blank" rel="noopener">JAX-RS 2.0</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://download.oracle.com/otndocs/jcp/jaxrs-1.0-fr-eval-oth-JSpec/" target="_blank" rel="noopener">JAX-RS 1.0</a></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>JAX-RS 1.0 (<a href="https://download.oracle.com/otndocs/jcp/jaxrs-1.0-fr-eval-oth-JSpec/">JSR-311</a>), JAX-RS 2.0 (<a href="https://jcp.org/en/jsr/detail?id=339">JSR-339</a>), and JAX-RS 2.1 (<a href="https://jcp.org/en/jsr/detail?id=370">JSR-370</a>) are <a href="https://jcp.org/en/procedures/overview">Java Community Process (JCP)</a> specifications.
In 2017, the Java Enterprise Edition (Java EE) specifications, including JAX-RS, were transferred to the Eclipse Foundation (<a href="https://blogs.eclipse.org/post/mike-milinkovich/java-ee-moves-eclipse-foundation">
Java EE Moves to the Eclipse Foundation</a>), Java EE became Jakarta Enterprise Edition, and new governing committees under the umbrella of the <a href="https://projects.eclipse.org/proposals/eclipse-jakarta-ee-platform">Eclipse Jakarta EE Platform</a> were constituted.
For JAX-RS, the specifications are provided by the <a href="https://jakarta.ee/specifications/restful-ws/">Jakarta RESTful Web Services</a> committee. The first specification released under the authority of Jakarta RESTful Web Services was <a href="https://jakarta.ee/specifications/restful-ws/2.1/">Jakarta RESTful Web Services 2.1</a>, that being essentially identical to JAX-RS 2.1.</p>
</div>
<div class="paragraph">
<p>RESTEasy is a portable implementation of these specifications which can run in any Servlet container.
Tighter integration with the WildFly application server is also available to make the user experience nicer in that environment.
RESTEasy also comes with additional features on top of the plain old specifications.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>References in this document to JAX-RS refer to the Jakarta RESTful Web Services unless otherwise noted.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license"><a class="anchor" href="#_license"></a>2. License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy is distributed under the <a href="https://repository.jboss.org/licenses/apache-2.0.txt">Apache License 2.0</a>.
Some dependencies are covered by other open source licenses.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation_configuration"><a class="anchor" href="#installation_configuration"></a>3. Installation/Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy is installed and configured in different ways depending on which environment you are running in.
If you are running in WildFly, RESTEasy is already bundled and integrated completely so there is very little you have to do.
If you are running in a different environment, there is some manual installation and configuration you will have to do.</p>
</div>
<div class="sect2">
<h3 id="_resteasy_modules_in_wildfly"><a class="anchor" href="#_resteasy_modules_in_wildfly"></a>3.1. RESTEasy modules in WildFly</h3>
<div class="paragraph">
<p>In WildFly, RESTEasy and the Jakarta RESTful Web Services API are automatically loaded into your deployment&#8217;s classpath if and
only if you are deploying a Jakarta RESTful Web Services application (as determined by the presence of Jakarta RESTful Web Services
annotations). However, only some RESTEasy features are automatically loaded.
See the <a href="#jboss_modules">modules</a> table.
If you need any of those libraries which are not loaded automatically, you&#8217;ll have to bring them in with a
<code>jboss-deployment-structure.xml</code> file in the WEB-INF directory of your WAR file.
Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jboss-deployment-structure&gt;</span>
    <span class="tag">&lt;deployment&gt;</span>
        <span class="tag">&lt;dependencies&gt;</span>
            <span class="tag">&lt;module</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.resteasy-jackson2-provider</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">services</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">import</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/dependencies&gt;</span>
    <span class="tag">&lt;/deployment&gt;</span>
<span class="tag">&lt;/jboss-deployment-structure&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The 'services` attribute must be set to "import" for modules that have default providers in a
<code>META-INF/services/jakarta.ws.rs.ext.Providers</code> file.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Using the <code>META-INF/services/jakarta.ws.rs.ext.Providers</code> is RESTEasy specific and not considered portable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To get an idea of which RESTEasy modules are loaded by default when  services are deployed, please see the table below, which refers to a recent WildFly ditribution patched with the current RESTEasy distribution.
Clearly, future and unpatched WildFly distributions might differ a bit in terms of modules enabled by default, as the container actually controls this too.</p>
</div>
<table id="jboss_modules" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Modules</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module Name</th>
<th class="tableblock halign-left valign-top">Loaded by Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-atom-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy&#8217;s atom library</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-cdi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy CDI integration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-crypto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S/MIME, DKIM, and support for other security formats.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-jackson2-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integration with the JSON parser and object mapper Jackson 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-jaxb-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jakarta XML Binding integration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core RESTEasy libraries for server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core RESTEasy libraries for client.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.jose-jwt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON Web Token support.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-jsapi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy&#8217;s Javascript API</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-json-p-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON parsing API</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-json-binding-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON binding API</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jakarta.json.bind-api</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON binding API</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.eclipse.yasson</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RI implementation of JSON binding API</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-multipart-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for multipart formats</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-spring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes (if Spring is present in the deployment)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy.resteasy-validator-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy&#8217;s interface to Hibernate Bean Validation</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_other_resteasy_modules"><a class="anchor" href="#_other_resteasy_modules"></a>3.1.1. Other RESTEasy modules</h4>
<div class="paragraph">
<p>Not all RESTEasy modules are bundled with WildFly.
For example, <code>resteasy-fastinfoset-provider</code> and <code>resteasy-wadl</code> are not included among the modules listed in <a href="#_resteasy_modules_in_wildfly">RESTEasy modules in WildFly</a>.
If you want to use them in your application, you can include them in your WAR as you would if you were deploying outside of WildFly.
See <a href="#_standalone_resteasy">Deploying to other servlet containers</a> for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_upgrading_wildfly"><a class="anchor" href="#_upgrading_wildfly"></a>3.1.2. Upgrading RESTEasy within WildFly</h4>
<div class="paragraph">
<p>RESTEasy is bundled with WildFly. However, you may wish to upgrade to the latest version. With
<a href="https://docs.wildfly.org/32/Galleon_Guide.html">Galleon</a> this makes upgrading RESTEasy in WildFly quite easy.</p>
</div>
<div class="paragraph">
<p>Using Maven to provision WildFly you can simply use the RESTEasy Channel Manifest.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.wildfly.plugins<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>wildfly-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;executions&gt;</span>
        <span class="tag">&lt;execution&gt;</span>
            <span class="tag">&lt;id&gt;</span>server-provisioning<span class="tag">&lt;/id&gt;</span>
            <span class="tag">&lt;phase&gt;</span>generate-test-resources<span class="tag">&lt;/phase&gt;</span>
            <span class="tag">&lt;goals&gt;</span>
                <span class="tag">&lt;goal&gt;</span>provision<span class="tag">&lt;/goal&gt;</span>
            <span class="tag">&lt;/goals&gt;</span>
            <span class="tag">&lt;configuration&gt;</span>
                <span class="tag">&lt;feature-packs&gt;</span>
                    <span class="tag">&lt;feature-pack&gt;</span>
                        <span class="tag">&lt;groupId&gt;</span>org.wildfly<span class="tag">&lt;/groupId&gt;</span>
                        <span class="tag">&lt;artifactId&gt;</span>wildfly-ee-galleon-pack<span class="tag">&lt;/artifactId&gt;</span>
                    <span class="tag">&lt;/feature-pack&gt;</span>
                <span class="tag">&lt;/feature-packs&gt;</span>
                <span class="tag">&lt;channels&gt;</span>
                    <span class="tag">&lt;channel&gt;</span>
                        <span class="tag">&lt;manifest&gt;</span>
                            <span class="tag">&lt;groupId&gt;</span>org.wildfly.channels<span class="tag">&lt;/groupId&gt;</span>
                            <span class="tag">&lt;artifactId&gt;</span>wildfly-ee<span class="tag">&lt;/artifactId&gt;</span>
                        <span class="tag">&lt;/manifest&gt;</span>
                    <span class="tag">&lt;/channel&gt;</span>
                    <span class="tag">&lt;channel&gt;</span>
                        <span class="tag">&lt;manifest&gt;</span>
                            <span class="tag">&lt;groupId&gt;</span>dev.resteasy.channels<span class="tag">&lt;/groupId&gt;</span>
                            <span class="tag">&lt;artifactId&gt;</span>resteasy-6.2<span class="tag">&lt;/artifactId&gt;</span>
                        <span class="tag">&lt;/manifest&gt;</span>
                    <span class="tag">&lt;/channel&gt;</span>
                <span class="tag">&lt;/channels&gt;</span>
            <span class="tag">&lt;/configuration&gt;</span>
        <span class="tag">&lt;/execution&gt;</span>
    <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploying_a_resteasy_application_to_wildfly"><a class="anchor" href="#_deploying_a_resteasy_application_to_wildfly"></a>3.2. Deploying a RESTEasy application to WildFly</h3>
<div class="paragraph">
<p>RESTEasy is bundled with WildFly and completely integrated as per the requirements of Jakarta EE. A Jakarta RESTful Web Services
application can contain Jakarta Enterprise Beans and CDI. WildFly scans the WAR file for the Jakarta RESTful Web Services services and
provider classes packaged in the WAR either as POJOs, CDI beans, or Jakarta Enterprise Beans.</p>
</div>
<div class="paragraph">
<p>The web.xml can supply to RESTEasy init-params and context-params (see <a href="#_configuration_switches">Configuration switches</a>) if you want to tweak or turn on/off any specific RESTEasy feature.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;web-app</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When a servlet-mapping element is not declared in the web.xml, then a class must be provided that implements <code>jakarta.ws.rs.core.Application</code> class (see <a href="#_jakarta.ws.rs.core.application"><code>jakarta.ws.rs.core.Application</code></a>). This class must be annotated with the <code>jakarta.ws.rs.ApplicationPath</code> annotation.
If this implementation class returns an empty set for classes and singletons, the WAR will be scanned for resource and provider classes as indicated by the presence of Jakarta RESTful Web Services annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.ws.rs.ApplicationPath</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Application</span>;

<span class="annotation">@ApplicationPath</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/root-path</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyApplication</span> <span class="directive">extends</span> Application {
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the application WAR contains an <code>Application</code> class (or a subclass thereof) which is annotated with an
<code>ApplicationPath</code> annotation, a <code>web.xml</code> file is not required. If the application WAR contains an <code>Application</code> class but
the class doesn&#8217;t have a declared <code>@ApplicationPath</code> annotation, then the web.xml must at least declare a servlet-mapping element.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As mentioned in <a href="#_other_resteasy_modules">Other RESTEasy modules</a>, not all RESTEasy modules are bundled with WildFly.
For example, resteasy-fastinfoset-provider and resteasy-wadl are not included among the modules listed in <a href="#_resteasy_modules_in_wildfly">RESTEasy modules in WildFly</a>.
If they are required by the application, they can be included in the WAR as is done if you were deploying outside of WildFly.
See <a href="#_standalone_resteasy">Deploying to other servlet containers</a> for more information.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_standalone_resteasy"><a class="anchor" href="#_standalone_resteasy"></a>3.3. Deploying to other servlet containers</h3>
<div class="paragraph">
<p>If you are using RESTEasy outside of WildFly, in a standalone servlet container like Tomcat or Jetty, for example, you will need to include the appropriate RESTEasy jars in your WAR file.
You will need the core classes in the resteasy-core and resteasy-client modules, and you may need additional facilities like the resteasy-jaxb-provider module.
We strongly suggest that you use Maven to build your WAR files as RESTEasy is split into a bunch of different modules:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-core<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-client<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-jaxb-provider<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see sample Maven projects in <a href="https://github.com/resteasy/resteasy-examples" class="bare">https://github.com/resteasy/resteasy-examples</a>.</p>
</div>
<div class="paragraph">
<p>If not using Maven, include the necessary jars by hand.
If downloading RESTEasy (from <a href="https://resteasy.dev/downloads.html" class="bare">https://resteasy.dev/downloads.html</a>, for example) you will get a file, resteasy-6.2.11.Final-all.zip.
Unzip the file. The resulting directory will contain a lib/ directory that contains the libraries needed by RESTEasy.
Copy these, as needed, into your /WEB-INF/lib directory.
Place your Jakarta RESTful Web Services annotated class resources and providers within one or more jars within /WEB-INF/lib or your raw class files within /WEB-INF/classes.</p>
</div>
<div class="sect3">
<h4 id="_servlet_containers"><a class="anchor" href="#_servlet_containers"></a>3.3.1. Servlet Containers</h4>
<div class="paragraph">
<p>RESTEasy provides an implementation of the Servlet <code>ServletContainerInitializer</code> integration interface for
containers to use in initializing an application.
The container calls this interface during the application&#8217;s startup phase.
The RESTEasy implementation performs automatic scanning for resources and providers, and programmatic registration of a servlet.
RESTEasy&#8217;s implementation is provided in maven artifact, <code>resteasy-servlet-initializer</code>.
Add this artifact dependency to your project&#8217;s pom.xml file so the JAR file will be included in your WAR file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-servlet-initializer<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_defining_the_servlet_in_a_web_xml"><a class="anchor" href="#_defining_the_servlet_in_a_web_xml"></a>3.3.2. Defining the Servlet in a web.xml</h4>
<div class="paragraph">
<p>You can manually declare the RESTEasy servlet in the <code>WEB-INF/web.xml</code> file of your WAR project, and provide an
<code>Application</code> class (see <a href="#_jakarta.ws.rs.core.application"><code>jakarta.ws.rs.core.Application</code></a>).
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;display-name&gt;</span>Archetype Created Web Application<span class="tag">&lt;/display-name&gt;</span>

    <span class="tag">&lt;servlet&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>Resteasy<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;servlet-class&gt;</span>
            org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
        <span class="tag">&lt;/servlet-class&gt;</span>
        <span class="tag">&lt;init-param&gt;</span>
            <span class="tag">&lt;param-name&gt;</span>jakarta.ws.rs.Application<span class="tag">&lt;/param-name&gt;</span>
            <span class="tag">&lt;param-value&gt;</span>com.restfully.shop.services.ShoppingApplication<span class="tag">&lt;/param-value&gt;</span>
        <span class="tag">&lt;/init-param&gt;</span>
    <span class="tag">&lt;/servlet&gt;</span>

    <span class="tag">&lt;servlet-mapping&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>Resteasy<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;/servlet-mapping&gt;</span>

<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The RESTEasy servlet is responsible for initializing some basic components of RESTEasy.</p>
</div>
</div>
<div class="sect3">
<h4 id="_listener"><a class="anchor" href="#_listener"></a>3.3.3. RESTEasy as a ServletContextListener</h4>
<div class="paragraph">
<p>Initialization of RESTEasy can be performed within a 'servletContextListener` instead of within the Servlet.
You may need this if you are writing custom Listeners that need to interact with RESTEasy at boot time.
An example of this is the RESTEasy Spring integration that requires a Spring ServletContextListener.
The <code>org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap</code> class is a <code>ServletContextListener</code> that configures an
instance of an <code>ResteasyProviderFactory</code> and Registry. You can obtain instances of a <code>ResteasyProviderFactory</code> and
Registry from the 'servletContext` attributes <code>org.jboss.resteasy.spi.ResteasyProviderFactory</code> and
<code>org.jboss.resteasy.spi.Registry</code>. From these instances you can programmatically interact with RESTEasy registration
interfaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
   <span class="tag">&lt;listener&gt;</span>
      <span class="tag">&lt;listener-class&gt;</span>
         org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
      <span class="tag">&lt;/listener-class&gt;</span>
   <span class="tag">&lt;/listener&gt;</span>

  <span class="comment">&lt;!-- ** INSERT YOUR LISTENERS HERE!!!! --&gt;</span>

   <span class="tag">&lt;servlet&gt;</span>
      <span class="tag">&lt;servlet-name&gt;</span>Resteasy<span class="tag">&lt;/servlet-name&gt;</span>
      <span class="tag">&lt;servlet-class&gt;</span>
         org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
      <span class="tag">&lt;/servlet-class&gt;</span>
   <span class="tag">&lt;/servlet&gt;</span>

   <span class="tag">&lt;servlet-mapping&gt;</span>
      <span class="tag">&lt;servlet-name&gt;</span>Resteasy<span class="tag">&lt;/servlet-name&gt;</span>
      <span class="tag">&lt;url-pattern&gt;</span>/Resteasy/*<span class="tag">&lt;/url-pattern&gt;</span>
   <span class="tag">&lt;/servlet-mapping&gt;</span>

<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_filter"><a class="anchor" href="#_filter"></a>3.3.4. RESTEasy as a Servlet Filter</h4>
<div class="paragraph">
<p>A downside of running RESTEasy as a Servlet is that you cannot have static resources like .html and .jpeg files in the
same path as your Jakarta RESTful Web Services services. RESTEasy allows you to run as a <code>Filter</code> instead. If a Jakarta RESTful Web Services resource is
not found under the URL requested, RESTEasy will delegate back to the base servlet container to resolve URLs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;filter&gt;</span>
        <span class="tag">&lt;filter-name&gt;</span>Resteasy<span class="tag">&lt;/filter-name&gt;</span>
        <span class="tag">&lt;filter-class&gt;</span>
            org.jboss.resteasy.plugins.server.servlet.FilterDispatcher
        <span class="tag">&lt;/filter-class&gt;</span>
        <span class="tag">&lt;init-param&gt;</span>
            <span class="tag">&lt;param-name&gt;</span>jakarta.ws.rs.Application<span class="tag">&lt;/param-name&gt;</span>
            <span class="tag">&lt;param-value&gt;</span>com.restfully.shop.services.ShoppingApplication<span class="tag">&lt;/param-value&gt;</span>
        <span class="tag">&lt;/init-param&gt;</span>
    <span class="tag">&lt;/filter&gt;</span>

    <span class="tag">&lt;filter-mapping&gt;</span>
        <span class="tag">&lt;filter-name&gt;</span>Resteasy<span class="tag">&lt;/filter-name&gt;</span>
        <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;/filter-mapping&gt;</span>

<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_microprofile_config"><a class="anchor" href="#_microprofile_config"></a>3.4. Configuration</h3>
<div class="paragraph">
<p>RESTEasy has two mutually exclusive mechanisms for retrieving configuration parameters (see <a href="#_configuration_switches">Configuration switches</a>). The classic mechanism depends on context-params and init-params in a web.xml file.
Alternatively, the Eclipse MicroProfile Config project (<a href="https://github.com/eclipse/microprofile-config" class="bare">https://github.com/eclipse/microprofile-config</a>) provides a flexible parameter retrieval mechanism that RESTEasy will use if the necessary dependencies are available.
See <a href="#_configuring_mp_config">Configuring MicroProfile Config</a> for more about that.
If they are not available, it will fall back to an extended form of the classic mechanism.</p>
</div>
<div class="sect3">
<h4 id="_resteasy_microprofile_config"><a class="anchor" href="#_resteasy_microprofile_config"></a>3.4.1. RESTEasy with MicroProfile Config</h4>
<div class="paragraph">
<p>In the presence of the Eclipse MicroProfile Config API jar and an implementation of the API (see <a href="#_configuring_mp_config">Configuring MicroProfile Config</a>),
RESTEasy will use the facilities of MicroProfile Config for accessing configuration properties
(see <a href="#_configuration_switches">Configuration switches</a>). MicroProfile Config offers to both RESTEasy users and RESTEasy developers a great
deal of flexibility in controlling runtime configuration.</p>
</div>
<div class="paragraph">
<p>In MicroProfile Config, a <code>ConfigSource</code> represents a <code>Map&lt;String, String&gt;</code> of property names to values, and a <code>Config</code>
represents a sequence of ConfigSource&#8217;s, ordered by priority. The priority of a <code>ConfigSource</code> is given by an ordinal
(represented by an <code>int</code>), with a higher value indicating a higher priority. For a given property name, the
ConfigSource&#8217;s are searched in order until a value is found.</p>
</div>
<div class="paragraph">
<p>MicroProfile Config mandates the presence of the following `ConfigSource&#8217;s:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a <code>ConfigSource</code> based on 'system.getProperties()` (ordinal = 400)</p>
</li>
<li>
<p>a <code>ConfigSource</code> based on 'system.getenv()` (ordinal = 300)</p>
</li>
<li>
<p>a <code>ConfigSource</code> for each <code>META-INF/microprofile-config.properties</code> file on the class path, separately configurable
via a config_ordinal property inside each file (default ordinal = 100)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that a property which is found among the System properties and which is also in the System environment will be
assigned the System property value because of the relative priorities of the ConfigSource&#8217;s.</p>
</div>
<div class="paragraph">
<p>The set of config sources is extensible.
For example, smallrye-config (<a href="https://github.com/smallrye/smallrye-config" class="bare">https://github.com/smallrye/smallrye-config</a>), the implementation of the MicroProfile
Config specification currently used by RESTEasy, adds the following kinds of ConfigSource&#8217;s:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>PropertiesConfigSource</code> creates a <code>ConfigSource</code> from a Java <code>Properties</code> object or a <code>Map&lt;String, String&gt;</code> object or
a properties file (referenced by its URL) (default ordinal = 100).</p>
</li>
<li>
<p><code>DirConfigSource</code> creates a <code>ConfigSource</code> that will look into a directory where each file corresponds to a property
(the file name is the property key and its textual content is the property value). This <code>ConfigSource</code> can be used to
read configuration from Kubernetes ConfigMap (default ordinal = 100).</p>
</li>
<li>
<p><code>ZkMicroProfileConfig</code> creates a <code>ConfigSource</code> that is backed by Apache Zookeeper (ordinal = 150).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These can be registered programmatically by using an instance of <code>ConfigProviderResolver</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Config config = <span class="keyword">new</span> PropertiesConfigSource(<span class="string"><span class="delimiter">&quot;</span><span class="content">file:/// ...</span><span class="delimiter">&quot;</span></span>);
ConfigProviderResolver.instance().registerConfig(config, getClass().getClassLoader());</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>ConfigProviderResolver</code> is part of the Eclipse API.</p>
</div>
<div class="paragraph">
<p>If the application is running in Wildfly, then Wildfly provides another set of ConfigSource&#8217;s, as described in the
"MicroProfile Config Subsystem Configuration" section of the WildFly Admin guide (<a href="https://docs.wildfly.org/32/Admin_Guide.html#MicroProfile_Config_SmallRye" class="bare">https://docs.wildfly.org/32/Admin_Guide.html#MicroProfile_Config_SmallRye</a>).</p>
</div>
<div class="paragraph">
<p>Finally, RESTEasy MicroProfile automatically provides three more ConfigSource&#8217;s:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.jboss.resteasy.microprofile.config.ServletConfigSource</code> represents a servlet&#8217;s init-params from web.xml (ordinal = 60).</p>
</li>
<li>
<p><code>org.jboss.resteasy.microprofile.config.FilterConfigSource</code> represents a filter&#8217;s <code>&lt;init-param&gt;</code> from <code>web.xml</code> (ordinal = 50). (See <a href="#_filter">RESTEasy as a Servlet Filter</a> for more information.)</p>
</li>
<li>
<p><code>org.jboss.resteasy.microprofile.config.ServletContextConfigSource</code> represents context-params from web.xml (ordinal = 40).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As stated by the MicroProfile Config specification, a special property <code>config_ordinal</code> can be set within any
RESTEasy built-in ConfigSource&#8217;s. The default implementation of <code>getOrdinal()</code> will attempt to read this value. If
found and a valid integer, the value will be used. Otherwise, the respective default value will be used.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_using_pure_microprofile_config"><a class="anchor" href="#_using_pure_microprofile_config"></a>3.4.2. Using pure MicroProfile Config</h4>
<div class="paragraph">
<p>The MicroProfile Config API is very simple. A <code>Config</code> may be obtained either programmatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Config config = ConfigProvider.getConfig();</code></pre>
</div>
</div>
<div class="paragraph">
<p>or, in the presence of CDI, by way of injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Inject</span>
Config config;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once a <code>Config</code> has been obtained, a property can be queried.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> s = config.getValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">prop_name</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> s = config.getOptionalValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">prop_name</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class).orElse(<span class="string"><span class="delimiter">&quot;</span><span class="content">d'oh</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, consider a situation in which "prop_name" has been set by 'System.setProperty("prop_name", "system")` and also in
the application&#8217;s <code>web.xml</code> in element <code>context-param</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
  <span class="tag">&lt;param-name&gt;</span>prop_name<span class="tag">&lt;/param-name&gt;</span>
  <span class="tag">&lt;param-value&gt;</span>context<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the system parameter <code>ConfigSource</code> (ordinal = 400) has precedence over <code>servletContextConfigSource</code>
(ordinal = 40), <code>config.getValue("prop_name", String.class)</code> will return "system" rather than "context".</p>
</div>
</div>
<div class="sect3">
<h4 id="_using_resteasys_extension_of_microprofile_config"><a class="anchor" href="#_using_resteasys_extension_of_microprofile_config"></a>3.4.3. Using RESTEasy&#8217;s extension of MicroProfile Config</h4>
<div class="paragraph">
<p>RESTEasy offers a general purpose parameter retrieval mechanism which incorporates MicroProfile Config if the necessary
dependencies are available, and which falls back to an extended version of the classic RESTEasy mechanism
(see <a href="#_classic_config">RESTEasy&#8217;s classic configuration mechanism</a>) otherwise.</p>
</div>
<div class="paragraph">
<p>Calling:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">final</span> <span class="type">var</span> config = ConfigurationFactory.getInstance().getConfiguration();</code></pre>
</div>
</div>
<div class="paragraph">
<p>will return an instance of <code>org.jboss.resteasy.spi.config.Configuration</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Configuration</span> {

    <span class="comment">/**
     * Returns the resolved value for the specified type of the named property.
     *
     * @param name the name of the parameter
     * @param type the type to convert the value to
     * @param T  the property type
     *
     * @return the resolved optional value
     *
     * @throws IllegalArgumentException if the type is not supported
     */</span>
    &lt;T&gt; Optional&lt;T&gt; getOptionalValue(<span class="predefined-type">String</span> name, ClassT type);

    <span class="comment">/**
     * Returns the resolved value for the specified type of the named property.
     *
     * @param name the name of the parameter
     * @param type the type to convert the value to
     * @param T  the property type
     *
     * @return the resolved value
     *
     * @throws IllegalArgumentException         if the type is not supported
     * @throws java.util.NoSuchElementException if there is no property associated with the name
     */</span>
    &lt;T&gt; T getValue(<span class="predefined-type">String</span> name, ClassT type);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> value = ConfigurationFactory.getInstance().getConfiguration().getOptionalValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">prop_name</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class).orElse(<span class="string"><span class="delimiter">&quot;</span><span class="content">d'oh</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If MicroProfile Config is available, that would be equivalent to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> value = ConfigProvider.getConfig().getOptionalValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">prop_name</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class).orElse(<span class="string"><span class="delimiter">&quot;</span><span class="content">d'oh</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If MicroProfile Config is not available, then an attempt is made to retrieve the parameter from the following sources in this order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>system variables, followed by</p>
</li>
<li>
<p>environment variables, followed by</p>
</li>
<li>
<p>web.xml parameters, as described in <a href="#_classic_config">RESTEasy&#8217;s classic configuration mechanism</a></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_mp_config"><a class="anchor" href="#_configuring_mp_config"></a>3.4.4. Configuring MicroProfile Config</h4>
<div class="paragraph">
<p>If an application is running inside Wildfly, then all of the dependencies are automatically available.
Outside of Wildfly, an application will need the Eclipse MicroProfile API at compile time.</p>
</div>
<div class="paragraph">
<p>As of RESTEasy 5.0 you will first need to add the RESTEasy MicroProfile Config dependency to the project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy.microprofile<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>microprofile-config<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You will also need the MicroProfile Config API and an implementation, in our case SmallRye.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.eclipse.microprofile.config<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>microprofile-config-api<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.smallrye<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>smallrye-config<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_classic_config"><a class="anchor" href="#_classic_config"></a>3.4.5. RESTEasy&#8217;s classic configuration mechanism</h4>
<div class="paragraph">
<p>Prior to the incorporation of MicroProfile Config, nearly all of RESTEasy&#8217;s parameters were retrieved from servlet
<code>init-params</code> and <code>context-params</code>. Which ones are available depends on how a web application invokes RESTEasy.</p>
</div>
<div class="paragraph">
<p>If RESTEasy is invoked as a servlet, as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;web-app</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;context-param&gt;</span>
      <span class="tag">&lt;param-name&gt;</span>system<span class="tag">&lt;/param-name&gt;</span>
      <span class="tag">&lt;param-value&gt;</span>system-context<span class="tag">&lt;/param-value&gt;</span>
   <span class="tag">&lt;/context-param&gt;</span>

   <span class="tag">&lt;servlet&gt;</span>
      <span class="tag">&lt;servlet-name&gt;</span>Resteasy<span class="tag">&lt;/servlet-name&gt;</span>
      <span class="tag">&lt;servlet-class&gt;</span>org.jboss.resteasy.plugins.server.servlet.HttpServlet30Dispatcher<span class="tag">&lt;/servlet-class&gt;</span>

      <span class="tag">&lt;init-param&gt;</span>
         <span class="tag">&lt;param-name&gt;</span>system<span class="tag">&lt;/param-name&gt;</span>
         <span class="tag">&lt;param-value&gt;</span>system-init<span class="tag">&lt;/param-value&gt;</span>
      <span class="tag">&lt;/init-param&gt;</span>

   <span class="tag">&lt;/servlet&gt;</span>

   <span class="tag">&lt;servlet-mapping&gt;</span>
      <span class="tag">&lt;servlet-name&gt;</span>Resteasy<span class="tag">&lt;/servlet-name&gt;</span>
      <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
   <span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>then the servlet specific init-params and the general context-params are available, with the former taking precedence over the latter.
For example, the property "system" would have the value "system-init".</p>
</div>
<div class="paragraph">
<p>If RESTEasy is invoked by way of a filter (see <a href="#_filter">RESTEasy as a Servlet Filter</a>), as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;web-app</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

   <span class="tag">&lt;context-param&gt;</span>
      <span class="tag">&lt;param-name&gt;</span>system<span class="tag">&lt;/param-name&gt;</span>
      <span class="tag">&lt;param-value&gt;</span>system-context<span class="tag">&lt;/param-value&gt;</span>
   <span class="tag">&lt;/context-param&gt;</span>

   <span class="tag">&lt;filter&gt;</span>
      <span class="tag">&lt;filter-name&gt;</span>Resteasy<span class="tag">&lt;/filter-name&gt;</span>
      <span class="tag">&lt;filter-class&gt;</span>org.jboss.resteasy.plugins.server.servlet.FilterDispatcher<span class="tag">&lt;/filter-class&gt;</span>

      <span class="tag">&lt;init-param&gt;</span>
         <span class="tag">&lt;param-name&gt;</span>system<span class="tag">&lt;/param-name&gt;</span>
         <span class="tag">&lt;param-value&gt;</span>system-filter<span class="tag">&lt;/param-value&gt;</span>
      <span class="tag">&lt;/init-param&gt;</span>

    <span class="tag">&lt;/filter&gt;</span>

    <span class="tag">&lt;filter-mapping&gt;</span>
        <span class="tag">&lt;filter-name&gt;</span>Resteasy<span class="tag">&lt;/filter-name&gt;</span>
        <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;/filter-mapping&gt;</span>

<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>then the filter specific init-params and the general context-params are available, with the former taking precedence over the latter.
For example, the property "system" would have the value "system-filter".</p>
</div>
<div class="paragraph">
<p>Finally, if RESTEasy is invoked by way of a <code>ServletContextListener</code> (see <a href="#_listener">RESTEasy as a ServletContextListener</a>), as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;web-app</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

   <span class="tag">&lt;listener&gt;</span>
      <span class="tag">&lt;listener-class&gt;</span>
         org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
      <span class="tag">&lt;/listener-class&gt;</span>
   <span class="tag">&lt;/listener&gt;</span>

   <span class="tag">&lt;context-param&gt;</span>
      <span class="tag">&lt;param-name&gt;</span>system<span class="tag">&lt;/param-name&gt;</span>
      <span class="tag">&lt;param-value&gt;</span>system-context<span class="tag">&lt;/param-value&gt;</span>
   <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>ResteasyBootstrap</code> is a <code>servletContextListener</code>, then the context-params are available.</p>
</div>
</div>
<div class="sect3">
<h4 id="_overriding_config"><a class="anchor" href="#_overriding_config"></a>3.4.6. Overriding RESTEasy&#8217;s configuration mechanism</h4>
<div class="paragraph">
<p>Before adopting the default behavior, with or without MicroProfile Config, as described in  previous sections, RESTEasy
will use service loading to look for one or more implementations of the interface
<code>org.jboss.resteasy.spi.config.ConfigurationFactory</code>, selecting one with the highest priority as determined by the
value returned by <code>ConfigurationFactory.priority()</code>. Smaller numbers indicate higher priority. The default
<code>ConfigurationFactory</code> is <code>org.jboss.resteasy.core.config.DefaultConfigurationFactory</code> with a priority of 500.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_switches"><a class="anchor" href="#_configuration_switches"></a>3.5. Configuration switches</h3>
<div class="paragraph">
<p>RESTEasy can receive the following configuration options from any ConfigSource&#8217;s that are available at runtime:</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option Name</th>
<th class="tableblock halign-left valign-top">Default Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.servlet.mapping.prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the url-pattern for the RESTEasy servlet-mapping is not /*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.providers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma delimited list of fully qualified @Provider class names to be register</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.disable.providers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma delimited list of fully qualified Jakarta RESTful Web Services <code>@Provider</code> class names that will be disabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.use.builtin.providers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether or not to register default, built-in @Provider classes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.resources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma delimited list of fully qualified Jakarta RESTful Web Services resource class names to be register</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.jndi.resources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma delimited list of JNDI names which reference objects to be registered as Jakarta RESTful Web Services resources</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jakarta.ws.rs.Application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fully qualified name of Application class to bootstrap in a spec portable way</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.media.type.mappings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaces the need for an Accept header by mapping file name extensions (like .xml or .txt) to a media type. Used when
  the client is unable to use an Accept header to choose a representation (i.e. a browser).
  See <a href="#_jakarta_rest_content_negotiation">Jakarta RESTful Web Services Content Negotiation</a> for more details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.language.mappings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaces the need for an Accept-Language header by mapping file name extensions (like .en or .fr) to a language.
  Used when the client is unable to use an Accept-Language header to choose a language (i.e. a browser).
  See <a href="#_jakarta_rest_content_negotiation">Jakarta RESTful Web Services Content Negotiation</a> for more details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.media.type.param.mapping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Names a query parameter that can be set to an acceptable media type, enabling content negotiation without an Accept
  header. See <a href="#_jakarta_rest_content_negotiation">Jakarta RESTful Web Services Content Negotiation</a> for more details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.role.based.security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables role based security. See <a href="#_securing_jakarta_rest_and_resteasy">Securing Jakarta RESTful Web Services and RESTEasy</a> for more details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.document.expand.entity.references</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expand external entities in org.w3c.dom.Document documents and Jakarta XML Binding object representations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.document.secure.processing.feature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Impose security constraints in processing org.w3c.dom.Document documents and Jakarta XML Binding object representations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.document.secure.disableDTDs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prohibit DTDs in org.w3c.dom.Document documents and Jakarta XML Binding object representations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.wider.request.matching</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Turns off the Jakarta RESTful Web Services spec defined class-level expression filtering and instead tries to match every method&#8217;s full path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.use.container.form.params</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Obtain form parameters by using <code>HttpServletRequest.getParameterMap()</code>. Use this switch if you are calling this method
  within a servlet filter or consuming the input stream within the filter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.rfc7232preconditions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables <a href="#_http_precondition">RFC7232 compliant HTTP preconditions handling</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.gzip.max.input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Imposes maximum size on decompressed gzipped .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.secure.random.max.use</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of times a SecureRandom can be used before reseeding.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.buffer.exception.entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upon receiving an exception, the client side buffers any response entity before closing the connection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.add.charset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If a resource method returns a text/* or application/xml* media type without an explicit charset, RESTEasy adds
  "charset=UTF-8" to the returned Content-Type header.  To disable this behavior set this switch to false.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.disable.html.sanitizer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Normally, a response with media type "text/html" and a status of 400 will be processed so that the characters "/",
  "/", "&lt;", "&gt;", "&amp;", """ (double quote), and "'" (single quote) are escaped to prevent an XSS attack. Setting this parameter
  to "true", escaping will not occur.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.patchfilter.disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy provides class PatchMethodFilter to handle JSON patch and JSON Merge Patch requests. It is active by default.
  This filter can be disabled by setting this switch to "true" and a customized patch method filter can be provided to
  serve the JSON patch and JSON merge patch request instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.patchfilter.legacy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setting this value to false, the jsonp provider will be activated to provide PatchFilter for Json patch or Json Merge
  patch functionalities. The default is true; the Jackson provider will be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.original.webapplicationexception.behavior</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "true", this parameter will restore the original behavior in which a Client running in a resource method will
  throw a Jakarta RESTful Web Services WebApplicationException instead of a Resteasy version with a sanitized <code>Response</code>. For more information,
  see section <a href="#_resteasywebapplicationexception">Resteasy WebApplicationExceptions</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dev.resteasy.throw.options.exception</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setting this value to true will throw a <code>org.jboss.resteasy.spi.DefaultOptionsMethodException</code> if the HTTP method
  "OPTIONS" is sent and the matching method is not annotated with <code>@OPTIONS</code>. This is the original behavior of RESTEasy.
  However, this has been changed to return the response so that its processed with an <code>ExceptionMapper</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dev.resteasy.provider.jackson.disable.default.object.mapper</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setting this value to true will disable RESTEasy creating a <code>com.fasterxml.jackson.databind.ObjectMapper</code> if the
  Jackson Provider is being used and there is no <code>jakarta.ws.rs.ext.ContextResolver</code> for an <code>ObjectMapper</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dev.resteasy.entity.memory.threshold</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold to use for the amount of data to store in memory for entities.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dev.resteasy.entity.file.threshold</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold to use for the amount of data that can be stored in a file for entities. If the threshold is reached an
<code>IllegalStateException</code> will be thrown. A value of -1 means no limit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dev.resteasy.entity.tmpdir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of the <code>java.io.tmpdir</code> system property.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The temporary directory to use when the <code>dev.resteasy.entity.memory.threshold</code> was reached and the entity must be
written to a file. Note that the directory must already exist.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The resteasy.servlet.mapping.prefix context param variable must be set if the servlet-mapping for the RESTEasy
servlet has a url-pattern other than <code>/*</code>. For example, if the url-pattern is
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resteasy<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/restful-services/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then the value of resteasy.servlet.mapping.prefix must be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>resteasy.servlet.mapping.prefix<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>/restful-services<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Resteasy internally uses a cache to find the resource invoker for the request url.
The cache size and enablement can be controlled with these system properties.</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">System Property Name</th>
<th class="tableblock halign-left valign-top">Default Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.match.cache.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the match cache is enabled or not</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.match.cache.size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2048</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The size of this match cache</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_jakarta.ws.rs.core.application"><a class="anchor" href="#_jakarta.ws.rs.core.application"></a>3.6. <code>jakarta.ws.rs.core.Application</code></h3>
<div class="paragraph">
<p>The <code>jakarta.ws.rs.core.Application</code> class is a standard Jakarta RESTful Web Services class that may be implemented to provide information about
your deployment. It is simply a class the lists all Jakarta RESTful Web Services root resources and providers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the application&#8217;s web.xml file does not have a servlet-mapping element, you must provide an <code>Application</code> class
annotated with <code>@ApplicationPath</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_client_side"><a class="anchor" href="#_client_side"></a>3.7. Client side</h3>
<div class="paragraph">
<p>Jakarta RESTful Web Services conforming implementations, such as RESTEasy, support a client side framework which simplifies communicating
with restful applications. In RESTEasy, the minimal set of modules needed for the client framework consists of
resteasy-core and resteasy-client. You can access them by way of maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-client<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Other modules, such as resteasy-jaxb-provider, may be brought in as needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_providers"><a class="anchor" href="#_configuring_providers"></a>3.8. Configuring Providers</h3>
<div class="paragraph">
<p>There are a number of ways in which Providers can be supplied to RESTEasy.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Jakarta RESTful Web Services specification mandates a number of built-in providers.</p>
</li>
<li>
<p><code>Application.getClasses()</code> may supply provider classes.</p>
</li>
<li>
<p>The configuration parameter "resteasy.providers" may supply a comma delimited
list of fully qualified provider class names.</p>
</li>
<li>
<p>If an <code>Application</code> returns empty sets from <code>getClasses()</code> and <code>getSingletons()</code>, classes annotated with <code>@Provider</code> are discovered automatically.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>RESTEasy also implements the configuration parameter "resteasy.disable.providers", which can be set to a comma delimited list of fully qualified class names of providers that <strong>are not</strong> meant to be made available.
That list may include any providers supplied by any of the means listed above, and it will override them.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_path"><a class="anchor" href="#_using_path"></a>4. Using <code>@Path</code> and <code>@GET</code>, <code>@POST</code>, etc.</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/library</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Library</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/books</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="predefined-type">String</span> getBooks() {}

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/{isbn}</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="predefined-type">String</span> getBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id) {
      <span class="comment">// search my database and get a string representation and return it</span>
   }

   <span class="annotation">@PUT</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/{isbn}</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="type">void</span> addBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id, <span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> name) {}

   <span class="annotation">@DELETE</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/{id}</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="type">void</span> removeBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id) {}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the class above, the RESTEasy servlet is configured and reachable at a root path of <a href="http://localhost/services" class="bare">http://localhost/services</a>.
The requests handled by class, Library, are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GET <a href="http://localhost/services/library/books" class="bare">http://localhost/services/library/books</a></p>
</li>
<li>
<p>GET <a href="http://localhost/services/library/book/333" class="bare">http://localhost/services/library/book/333</a></p>
</li>
<li>
<p>PUT <a href="http://localhost/services/library/book/333" class="bare">http://localhost/services/library/book/333</a></p>
</li>
<li>
<p>DELETE <a href="http://localhost/services/library/book/333" class="bare">http://localhost/services/library/book/333</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>@jakarta.ws.rs.Path</code> annotation must exist on either the class and/or a resource method.
If it exists on both the class and method, the relative path to the resource method is a concatenation of the class and method.</p>
</div>
<div class="paragraph">
<p>In the <code>jakarta.ws.rs</code> package there are annotations for each HTTP method.
<code>@GET</code>, <code>@POST</code>, <code>@PUT</code>, <code>@DELETE</code>, and <code>@HEAD</code>.
Place these on public methods that you want to map to that certain kind of HTTP method.
As long as there is a @Path annotation on the class, a @Path annotation is not required on the method you are mapping.
There can be more than one HTTP method as long as they can be distinguished from other methods.</p>
</div>
<div class="paragraph">
<p>When a <code>@Path</code> annotation is on a method without an HTTP method, these are called <code>JAXRSResourceLocators</code>.</p>
</div>
<div class="sect2">
<h3 id="_path_and_regular_expression_mappings"><a class="anchor" href="#_path_and_regular_expression_mappings"></a>4.1. <code>@Path</code> and regular expression mappings</h3>
<div class="paragraph">
<p>The @Path annotation is not limited to simple path expressions.
Regular expressions can be inserted into a <code>@Path</code> value attribute.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/resources)
public class MyResource {

   @GET
   @Path(</span><span class="delimiter">&quot;</span></span>{<span class="type">var</span>:.*}/stuff<span class="string"><span class="delimiter">&quot;</span><span class="content">)
   public String get() {}
}</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following GETs will route to the <code>getResource()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>GET /resources/stuff
GET /resources/foo/stuff
GET /resources/on/and/on/stuff</code></pre>
</div>
</div>
<div class="paragraph">
<p>The format of the expression is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&quot;{&quot; variable-name [ &quot;:&quot; regular-expression ] &quot;}&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The regular-expression part is optional.
When the expression is not provided, it defaults to a wildcard matching of one particular segment.
In regular-expression terms, the expression defaults to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&quot;([]*)&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/resources/{var}/stuff</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>will match these:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>GET /resources/foo/stuff
GET /resources/bar/stuff</code></pre>
</div>
</div>
<div class="paragraph">
<p>but will not match:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>GET /resources/a/bunch/of/stuff</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pathparam"><a class="anchor" href="#_pathparam"></a>5. @PathParam</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_newparam">supports <code>@PathParam</code> annotations with no parameter name.</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>@PathParam</code> is a parameter annotation which allows you to map variable URI path fragments into your method call.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/library</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Library</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/{isbn}</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="predefined-type">String</span> getBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id) {
      <span class="comment">// search my database and get a string representation and return it</span>
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>What this allows you to do is embed variable identification within the URIs of your resources. In the above example,
an isbn URI parameter is used to pass information about the book we want to access. The parameter type you inject into
can be any primitive type, a String, or any Java object that has a constructor that takes a String parameter, ozr a
static valueOf method that takes a String asa parameter. For example, lets say we wanted isbn to be a real object.
We could do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/{isbn}</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> getBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span>) ISBN id) {}

<span class="directive">public</span> <span class="type">class</span> <span class="class">ISBN</span> {
   <span class="directive">public</span> ISBN(<span class="predefined-type">String</span> str) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or instead of a public String constructors, have a valueOf method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ISBN</span> {
    <span class="directive">public</span> <span class="directive">static</span> ISBN valueOf(<span class="predefined-type">String</span> isbn) {}
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_advanced__pathparam_and_regular_expressions"><a class="anchor" href="#_advanced__pathparam_and_regular_expressions"></a>5.1. Advanced @PathParam and Regular Expressions</h3>
<div class="paragraph">
<p>There are a few more complicated uses of @PathParams not discussed in the previous section.</p>
</div>
<div class="paragraph">
<p>It is allowed to specify one or more path params embedded in one URI segment.
Here are some examples:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>@Path("/aaa{param}bbb")</code></p>
</li>
<li>
<p><code>@Path("/{name}-{zip}")</code></p>
</li>
<li>
<p><code>@Path("/foo{name}-{zip}bar")</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>So, a URI of "/aaa111bbb" would match #1.
"/bill-02115" would match #2.
"foobill-02115bar" would match #3.</p>
</div>
<div class="paragraph">
<p>It was discussed before how to use regular expression patterns within @Path values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/aaa{param:b+}/{many:.*}/stuff</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> getIt(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">param</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bs, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">many</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> many) {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the following requests, lets see what the values of the "param" and "many" <code>@PathParams</code> would be:</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Request</th>
<th class="tableblock halign-left valign-top">Param</th>
<th class="tableblock halign-left valign-top">Many</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /aaabb/some/stuff</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">some</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET /aaab/a/lot/of/stuff</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a/lot/of</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_pathparam_and_pathsegment"><a class="anchor" href="#_pathparam_and_pathsegment"></a>5.2. @PathParam and PathSegment</h3>
<div class="paragraph">
<p>The specification has a very simple abstraction for examining a fragment of the URI path being invoked on
<a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/core/pathsegment">jakarta.ws.rs.core.PathSegment</a>.</p>
</div>
<div class="paragraph">
<p>RESTEasy can inject a <code>PathSegment</code> instead of a value with the <code>@PathParam</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/{id}</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> getBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) PathSegment id) {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is very useful if you have a bunch of <code>@PathParams</code> that use matrix parameters.
The idea of matrix parameters is that they are an arbitrary set of name-value pairs embedded in a uri path segment.
The PathSegment object gives you access to these parameters.
See also <a href="#_matrixparam"><code>MatrixParam</code></a>.</p>
</div>
<div class="paragraph">
<p>A matrix parameter example is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://localhost/library/book;name=EJB 3.0;author=Bill Burke</pre>
</div>
</div>
<div class="paragraph">
<p>The idea of matrix parameters is that it represents resources that are addressable by their attributes as well as their raw id.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_queryparam"><a class="anchor" href="#_queryparam"></a>6. @QueryParam</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_newparam">supports <code>@QueryParam</code> annotations with no parameter name</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>@QueryParam</code> annotation allows mapping a URI query string parameter or url form encoded parameter to a method invocation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /books?num=5</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> getBooks(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">num</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> num) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since RESTEasy is built on top of a Servlet, it does not distinguish between URI query strings or url form encoded parameters.
Like <code>PathParam</code>, the parameter type can be a String, primitive, or class that has a String constructor or static valueOf() method.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_headerparam"><a class="anchor" href="#_headerparam"></a>7. @HeaderParam</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_newparam">supports <code>@HeaderParam</code> annotations with no parameter name.</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>@HeaderParam</code> annotation allows you to map a request HTTP header to a method invocation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /books?num=5</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> getBooks(<span class="annotation">@HeaderParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">From</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> from) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Like <code>PathParam</code>, a parameter type can be a String, primitive, or class that has a String constructor or static valueOf() method.
For example, MediaType has a valueOf() method and you could do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PUT</span>
<span class="directive">public</span> <span class="type">void</span> put(<span class="annotation">@HeaderParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>) MediaType contentType);</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_header_delegates"><a class="anchor" href="#_header_delegates"></a>7.1. Header Delegates</h3>
<div class="paragraph">
<p>In addition to the usual methods for translating parameters to and from strings, parameters annotated with
<code>@HeaderParam</code> have another option: implementations of <a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/ext/runtimedelegate.headerdelegate"><code>RuntimeDelegate$HeaderDelegate</code></a>.</p>
</div>
<div class="paragraph">
<p><code>HeaderDelegate</code> is similar to <a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/ext/paramconverter"><code>ParamConverter</code></a>,
but it is not very convenient to register a <code>HeaderDelegate</code> since, unlike, for example, <code>ParamConverterProvider</code>, it
is not treated by the  specification as a provider. The class <code>jakarta.ws.rs.core.Configurable</code>, which is subclassed by,
for example, <code>org.jboss.resteasy.spi.ResteasyProviderFactory</code> has methods like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="comment">/**
     * Register a class of a custom  component (such as an extension provider or
     * a {@link jakarta.ws.rs.core.Feature feature} meta-provider) to be instantiated
     * and used in the scope of this configurable context.
     *
     * ...
     *
     * @param componentClass  component class to be configured in the scope of this
     *                       configurable context.
     * @return the updated configurable context.
     */</span>
    <span class="directive">public</span> C register(<span class="predefined-type">Class</span>&lt;?&gt; componentClass);</code></pre>
</div>
</div>
<div class="paragraph">
<p>but it is not clear that they are applicable to `HeaderDelegate`s.</p>
</div>
<div class="paragraph">
<p>RESTEasy approaches this problem by allowing <code>HeaderDelegate</code> to be annotated with <code>@Provider</code>.
Not only will <code>ResteasyProviderFactory.register()</code> process a <code>HeaderDelegate</code>, but another useful consequence is that
a <code>HeaderDelegate</code> can be discovered automatically at runtime.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_linkheader"><a class="anchor" href="#_linkheader"></a>8. Linking resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are two mechanisms available in RESTEasy to link a resource to another, and to link resources to operations:
the Link HTTP header, and Atom links inside the resource representations.</p>
</div>
<div class="sect2">
<h3 id="_link_headers"><a class="anchor" href="#_link_headers"></a>8.1. Link Headers</h3>
<div class="paragraph">
<p>RESTEasy has both client and server side support for the <a href="http://tools.ietf.org/html/draft-nottingham-http-link-header-06">Link header specification</a>.
See the javadocs for <code>org.jboss.resteasy.spi.LinkHeader</code>, <code>org.jboss.resteasy.specimpl.LinkImpl</code>, and
<code>org.jboss.resteasy.client.ClientResponse</code>.</p>
</div>
<div class="paragraph">
<p>The main advantage of Link headers over Atom links in the resource is that those links are available without parsing the entity body.</p>
</div>
</div>
<div class="sect2">
<h3 id="_atom_links_in_the_resource_representations"><a class="anchor" href="#_atom_links_in_the_resource_representations"></a>8.2. Atom links in the resource representations</h3>
<div class="paragraph">
<p>RESTEasy allows the injection of <a href="http://tools.ietf.org/html/rfc4287#section-4.2.7">Atom links</a> directly inside the entity
objects that are sending to the client, via auto-discovery.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is only available when using the Jackson2 or Jakarta XML Binding providers (for JSON and XML).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main advantage over Link headers is that there can be any number of Atom links directly over the concerned resources, for any number of resources in the response.
For example, you can have Atom links for the root response entity, and also for each of its children entities.</p>
</div>
<div class="sect3">
<h4 id="_configuration"><a class="anchor" href="#_configuration"></a>8.2.1. Configuration</h4>
<div class="paragraph">
<p>There is no configuration required to be able to inject Atom links into a resource representation, you just have to have this maven artifact in the application&#8217;s path:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Group</th>
<th class="tableblock halign-left valign-top">Artifact</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.resteasy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-links</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.2.11.Final</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_your_first_links_injected"><a class="anchor" href="#_your_first_links_injected"></a>8.2.2. Your first links injected</h4>
<div class="paragraph">
<p>Three things are needed in order to tell RESTEasy to inject Atom links into an entity:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Annotate the Jakarta RESTful Web Services method with <code>@AddLinks</code> to indicate that Atom links are to be injected into the response entity.</p>
</li>
<li>
<p>Add <code>RESTServiceDiscovery</code> fields to the resource classes where Atom links are to be injected.</p>
</li>
<li>
<p>Annotate the Jakarta RESTful Web Services methods you want Atom links for with <code>@LinkResource</code>, so that RESTEasy knows which links to create for which resources.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example illustrates how to declare everything in order to get the Atom links injected in the book store example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
<span class="annotation">@Produces</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BookStore</span> {

    <span class="annotation">@AddLinks</span>
    <span class="annotation">@LinkResource</span>(value = <span class="predefined-type">Book</span>.class)
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">books</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;<span class="predefined-type">Book</span>&gt; getBooks();

    <span class="annotation">@LinkResource</span>
    <span class="annotation">@POST</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">books</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> addBook(<span class="predefined-type">Book</span> book);

    <span class="annotation">@AddLinks</span>
    <span class="annotation">@LinkResource</span>
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Book</span> getBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id);

    <span class="annotation">@LinkResource</span>
    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> updateBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id, <span class="predefined-type">Book</span> book);

    <span class="annotation">@LinkResource</span>(value = <span class="predefined-type">Book</span>.class)
    <span class="annotation">@DELETE</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> deleteBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And this is the definition of the Book resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Mapped</span>(namespaceMap = <span class="annotation">@XmlNsMap</span>(jsonName = <span class="string"><span class="delimiter">&quot;</span><span class="content">atom</span><span class="delimiter">&quot;</span></span>, namespace = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2005/Atom</span><span class="delimiter">&quot;</span></span>))
<span class="annotation">@XmlRootElement</span>
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.NONE)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Book</span> {
    <span class="annotation">@XmlAttribute</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> author;

    <span class="annotation">@XmlID</span>
    <span class="annotation">@XmlAttribute</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> title;

    <span class="annotation">@XmlElementRef</span>
    <span class="directive">private</span> RESTServiceDiscovery rest;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do a GET /order/foo, this XML representation will be returned:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span>
<span class="tag">&lt;book</span> <span class="attribute-name">xmlns:atom</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2005/Atom</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">title</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">author</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
 <span class="tag">&lt;atom:link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/books</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;atom:link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/books</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">add</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;atom:link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;atom:link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;atom:link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">remove</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/book&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And in JSON format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
 <span class="key"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>:
 {
  <span class="key"><span class="delimiter">&quot;</span><span class="content">@title</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">@author</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">atom.link</span><span class="delimiter">&quot;</span></span>:
   [
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">@href</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/books</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">@rel</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span>},
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">@href</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/books</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">@rel</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">add</span><span class="delimiter">&quot;</span></span>},
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">@href</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">@rel</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>},
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">@href</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">@rel</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span>},
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">@href</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">@rel</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">remove</span><span class="delimiter">&quot;</span></span>}
   ]
 }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_customising_atom_link_serialization"><a class="anchor" href="#_customising_atom_link_serialization"></a>8.2.3. Customising Atom link serialization</h4>
<div class="paragraph">
<p>The <code>RESTServiceDiscovery</code> is a Jakarta XML Binding type which inherits from <code>List</code>.
You are free to annotate it in order to customise the Jakarta XML Binding serialisation, or just rely on the default with <code>@XmlElementRef</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specifying_which_jakarta_restful_web_services_methods_are_tied_to_which_resources"><a class="anchor" href="#_specifying_which_jakarta_restful_web_services_methods_are_tied_to_which_resources"></a>8.2.4. Specifying which Jakarta RESTful Web Services methods are tied to which resources</h4>
<div class="paragraph">
<p>This is done by annotating the methods with the <code>@LinkResource</code> annotation.
It supports the following optional parameters:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Class</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares an Atom link for the given type of resources.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defaults to the entity body type (non-annotated parameter), or the method&#8217;s return type. This default does not work
with <code>Response</code> or <code>Collection</code> types, they need to be explicitly specified.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Atom link relation</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>list</code>: For <code>GET</code> methods returning a <code>Collection</code></p>
</li>
<li>
<p><code>self</code>: For <code>GET</code> methods returning a non-<code>Collection</code></p>
</li>
<li>
<p><code>remove</code>: For <code>DELETE</code> methods</p>
</li>
<li>
<p><code>update</code>: For <code>PUT</code> methods</p>
</li>
<li>
<p><code>add</code>: For <code>POST</code> methods</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Several <code>@LinkResource</code> annotations can be added on a single method by enclosing them in a <code>@LinkResources</code> annotation.
This allows the adding of links to the same method on several resource types.
For example the <code>/order/foo/comments</code> operation can belong on the <code>Order</code> resource with the <code>comments</code> relation, and on t
he <code>Comment</code> resource with the <code>list</code>  relation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specifying_path_parameter_values_for_uri_templates"><a class="anchor" href="#_specifying_path_parameter_values_for_uri_templates"></a>8.2.5. Specifying path parameter values for URI templates</h4>
<div class="paragraph">
<p>When RESTEasy adds links to your resources it needs to insert the right values in the URI template.
This is done either automatically by guessing the list of values from the entity, or by specifying the values in the <code>@LinkResource(pathParameters)</code> parameter.</p>
</div>
<div class="sect4">
<h5 id="_loading_uri_template_values_from_the_entity"><a class="anchor" href="#_loading_uri_template_values_from_the_entity"></a>Loading URI template values from the entity</h5>
<div class="paragraph">
<p>URI template values are extracted from the entity from fields or Java Bean properties annotated with <code>@ResourceID</code>, Jakarta XML Binding&#8217;s <code>@XmlID</code> or Jakarta Persistence&#8217;s <code>@Id</code>.
If there is more than one URI template value to find in a given entity, the entity can be annotated with <code>@ResourceIDs</code> to list the names of fields or properties that make up this entity&#8217;s Id.
If there are other URI template values required from a parent entity, RESTEasy tries to find the parent on a field or Java Bean property annotated with <code>@ParentResource</code>.
The list of URI template values extracted up every <code>@ParentResource</code> is then reversed and used as the list of values for the URI template.</p>
</div>
<div class="paragraph">
<p>For example, consider the previous Book example, and a list of comments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.NONE)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Comment</span> {
    <span class="annotation">@ParentResource</span>
    <span class="directive">private</span> <span class="predefined-type">Book</span> book;

    <span class="annotation">@XmlElement</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> author;

    <span class="annotation">@XmlID</span>
    <span class="annotation">@XmlAttribute</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> id;

    <span class="annotation">@XmlElementRef</span>
    <span class="directive">private</span> RESTServiceDiscovery rest;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Given the previous book store service augmented with comments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
<span class="annotation">@Produces</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BookStore</span> {

    <span class="annotation">@AddLinks</span>
    <span class="annotation">@LinkResources</span>({
        <span class="annotation">@LinkResource</span>(value = <span class="predefined-type">Book</span>.class, rel = <span class="string"><span class="delimiter">&quot;</span><span class="content">comments</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@LinkResource</span>(value = Comment.class)
    })
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comments</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Comment&gt; getComments(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId);

    <span class="annotation">@AddLinks</span>
    <span class="annotation">@LinkResource</span>
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    Comment getComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId);

    <span class="annotation">@LinkResource</span>
    <span class="annotation">@POST</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comments</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> addComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, Comment comment);

    <span class="annotation">@LinkResource</span>
    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> updateComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId, Comment comment);

    <span class="annotation">@LinkResource</span>(Comment.class)
    <span class="annotation">@DELETE</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> deleteComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Whenever we need to make links for a <code>Book</code> entity, we look up the ID in the <code>Book</code> <code>@XmlID</code> property.
Whenever we make links for <code>Comment</code> entities, we have a list of values taken from the <code>Comment</code> <code>@XmlID</code> and its <code>@ParentResource</code>: the <code>Book</code> and its <code>@XmlID</code>.</p>
</div>
<div class="paragraph">
<p>For a <code>Comment</code> with <code>id "1"</code> on a <code>Book</code> with <code>title "foo"</code> we will therefore get a list of URI template values of
<code>{"foo", "1"}</code>, to be replaced in the URI template, thus obtaining either <code>"/book/foo/comments"</code> or <code>"/book/foo/comment/1"</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_path_parameters_manually"><a class="anchor" href="#_specifying_path_parameters_manually"></a>Specifying path parameters manually</h5>
<div class="paragraph">
<p>An alternative to annotating  entities with resource ID annotations (<code>@ResourceID</code>, <code>@ResourceIDs</code>, <code>@XmlID</code> or <code>@Id</code>) and <code>@ParentResource</code>, you can specify the URI template values inside the <code>@LinkResource</code> annotation, using Unified Expression Language expressions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pathParameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declares a list of UEL expressions to obtain the URI template values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defaults to using <code>@ResourceID</code>, <code>@ResourceIDs</code>,<code>@XmlID</code> or <code>@Id</code> and <code>@ParentResource</code> annotations to extract the values from the model.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The UEL expressions are evaluated in the context of the entity, which means that any unqualified variable will be taken as a property for the entity itself, with the special variable <code>this</code> bound to the entity for which links are being generated.</p>
</div>
<div class="paragraph">
<p>The previous example of <code>Comment</code> service could be declared as such:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
<span class="annotation">@Produces</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BookStore</span> {

    <span class="annotation">@AddLinks</span>
    <span class="annotation">@LinkResources</span>({
        <span class="annotation">@LinkResource</span>(value = <span class="predefined-type">Book</span>.class, rel = <span class="string"><span class="delimiter">&quot;</span><span class="content">comments</span><span class="delimiter">&quot;</span></span>, pathParameters = <span class="string"><span class="delimiter">&quot;</span><span class="content">${title}</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@LinkResource</span>(value = Comment.class, pathParameters = {<span class="string"><span class="delimiter">&quot;</span><span class="content">${book.title}</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">${id}</span><span class="delimiter">&quot;</span></span>})
    })
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comments</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Comment&gt; getComments(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId);

    <span class="annotation">@AddLinks</span>
    <span class="annotation">@LinkResource</span>(pathParameters = {<span class="string"><span class="delimiter">&quot;</span><span class="content">${book.title}</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">${id}</span><span class="delimiter">&quot;</span></span>})
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    Comment getComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId);

    <span class="annotation">@LinkResource</span>(pathParameters = {<span class="string"><span class="delimiter">&quot;</span><span class="content">${book.title}</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">${id}</span><span class="delimiter">&quot;</span></span>})
    <span class="annotation">@POST</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comments</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> addComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, Comment comment);

    <span class="annotation">@LinkResource</span>(pathParameters = {<span class="string"><span class="delimiter">&quot;</span><span class="content">${book.title}</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">${id}</span><span class="delimiter">&quot;</span></span>})
    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> updateComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId, Comment comment);

    <span class="annotation">@LinkResource</span>(value = Comment.class, pathParameters = {<span class="string"><span class="delimiter">&quot;</span><span class="content">${book.title}</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">${id}</span><span class="delimiter">&quot;</span></span>})
    <span class="annotation">@DELETE</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> deleteComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_securing_entities"><a class="anchor" href="#_securing_entities"></a>8.2.6. Securing entities</h4>
<div class="paragraph">
<p>The user can restrict which links are injected in the resource based on security restrictions for the client, so that if the current client doesn&#8217;t have permission to delete a resource he will not be presented with the <code>"delete"</code> link relation.</p>
</div>
<div class="paragraph">
<p>Security restrictions can either be specified on the <code>@LinkResource</code> annotation, or using RESTEasy and Jakarta Enterprise Beans security annotation <code>@RolesAllowed</code> on the Jakarta RESTful Web Services method.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">constraint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A UEL expression which must evaluate to true to inject this method&#8217;s link in the response entity.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defaults to using <code>@RolesAllowed</code> from the Jakarta RESTful Web Services method.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_extending_the_uel_context"><a class="anchor" href="#_extending_the_uel_context"></a>8.2.7. Extending the UEL context</h4>
<div class="paragraph">
<p>It has been shown that both the URI template values and the security constraints of <code>@LinkResource</code> use UEL to evaluate expressions.
RESTEasy provides a basic UEL context with access only to the entity we are injecting links in, and nothing more.</p>
</div>
<div class="paragraph">
<p>More variables or functions can be added in this context, by adding a <code>@LinkELProvider</code> annotation on the Jakarta RESTful Web Services method, its class, or its package.
This annotation&#8217;s value should point to a class that implements the <code>ELProvider</code> interface, which wraps the default <code>ELContext</code> in order to add any missing functions.</p>
</div>
<div class="paragraph">
<p>For example, to support the Seam annotation <code>s:hasPermission(target, permission)</code> in your security constraints, add a <code>package-info.java</code> file like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@LinkELProvider</span>(SeamELProvider.class)
<span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.links.test</span>;

<span class="keyword">import</span> <span class="include">org.jboss.resteasy.links</span>.*;</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the following provider implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.links.test</span>;

<span class="keyword">import</span> <span class="include">jakarta.el.ELContext</span>;
<span class="keyword">import</span> <span class="include">jakarta.el.ELResolver</span>;
<span class="keyword">import</span> <span class="include">jakarta.el.FunctionMapper</span>;
<span class="keyword">import</span> <span class="include">jakarta.el.VariableMapper</span>;

<span class="keyword">import</span> <span class="include">org.jboss.seam.el.SeamFunctionMapper</span>;

<span class="keyword">import</span> <span class="include">org.jboss.resteasy.links.ELProvider</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">SeamELProvider</span> <span class="directive">implements</span> ELProvider {

    <span class="directive">public</span> ELContext getContext(<span class="directive">final</span> ELContext ctx) {
        <span class="keyword">return</span> <span class="keyword">new</span> ELContext() {

            <span class="directive">private</span> SeamFunctionMapper functionMapper;

            <span class="annotation">@Override</span>
            <span class="directive">public</span> ELResolver getELResolver() {
                <span class="keyword">return</span> ctx.getELResolver();
            }

            <span class="annotation">@Override</span>
            <span class="directive">public</span> FunctionMapper getFunctionMapper() {
                <span class="keyword">if</span> (functionMapper == <span class="predefined-constant">null</span>)
                    functionMapper = <span class="keyword">new</span> SeamFunctionMapper(ctx
                            .getFunctionMapper());
                <span class="keyword">return</span> functionMapper;
            }

            <span class="annotation">@Override</span>
            <span class="directive">public</span> VariableMapper getVariableMapper() {
                <span class="keyword">return</span> ctx.getVariableMapper();
            }
        };
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then use it as such:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
<span class="annotation">@Produces</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>})
<span class="directive">public</span> <span class="type">interface</span> <span class="class">BookStore</span> {

    <span class="annotation">@AddLinks</span>
    <span class="annotation">@LinkResources</span>({
        <span class="annotation">@LinkResource</span>(value = <span class="predefined-type">Book</span>.class, rel = <span class="string"><span class="delimiter">&quot;</span><span class="content">comments</span><span class="delimiter">&quot;</span></span>, constraint = <span class="string"><span class="delimiter">&quot;</span><span class="content">${s:hasPermission(this, 'add-comment')}</span><span class="delimiter">&quot;</span></span>),
        <span class="annotation">@LinkResource</span>(value = Comment.class, constraint = <span class="string"><span class="delimiter">&quot;</span><span class="content">${s:hasPermission(this, 'insert')}</span><span class="delimiter">&quot;</span></span>)
    })
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comments</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">Collection</span>&lt;Comment&gt; getComments(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId);

    <span class="annotation">@AddLinks</span>
    <span class="annotation">@LinkResource</span>(constraint = <span class="string"><span class="delimiter">&quot;</span><span class="content">${s:hasPermission(this, 'read')}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    Comment getComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId);

    <span class="annotation">@LinkResource</span>(constraint = <span class="string"><span class="delimiter">&quot;</span><span class="content">${s:hasPermission(this, 'insert')}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@POST</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comments</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> addComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, Comment comment);

    <span class="annotation">@LinkResource</span>(constraint = <span class="string"><span class="delimiter">&quot;</span><span class="content">${s:hasPermission(this, 'update')}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> updateComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId, Comment comment);

    <span class="annotation">@LinkResource</span>(value = Comment.class, constraint = <span class="string"><span class="delimiter">&quot;</span><span class="content">${s:hasPermission(this, 'delete')}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@DELETE</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">book/{id}/comment/{cid}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> deleteComment(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> bookId, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cid</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> commentId);

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_resource_facades"><a class="anchor" href="#_resource_facades"></a>8.2.8. Resource facades</h4>
<div class="paragraph">
<p>Sometimes it is useful to add resources which are just containers or layers on other resources, for example to represent a collection of <code>Comment</code> with a start index and a certain number of entries, in order to implement paging.
Such a collection is not really an entity in the model, but it should obtain the <code>"add"</code> and <code>"list"</code> link relations for the <code>Comment</code> entity.</p>
</div>
<div class="paragraph">
<p>This is possibly using resource facades.
A resource facade is a resource which implements the <code>ResourceFacade&lt;T&gt;</code> interface for the type <code>T</code>, and as such, should receive all links for that type.</p>
</div>
<div class="paragraph">
<p>Since in most cases the instance of the <code>T</code> type is not directly available in the resource facade, another way is needed to extract its URI template values.
This is done by calling the resource facade&#8217;s <code>pathParameters()</code> method to obtain a map of URI template values by name.
This map will be used to fill in the URI template values for any link generated for <code>T</code>, if there are enough values in the map.</p>
</div>
<div class="paragraph">
<p>Here is an example of such a resource facade for a collection of `Comment`s:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.NONE)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ScrollableCollection</span> <span class="directive">implements</span> ResourceFacade&lt;Comment&gt; {

    <span class="directive">private</span> <span class="predefined-type">String</span> bookId;
    <span class="annotation">@XmlAttribute</span>
    <span class="directive">private</span> <span class="type">int</span> start;
    <span class="annotation">@XmlAttribute</span>
    <span class="directive">private</span> <span class="type">int</span> totalRecords;
    <span class="annotation">@XmlElement</span>
    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;Comment&gt; comments = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;Comment&gt;();
    <span class="annotation">@XmlElementRef</span>
    <span class="directive">private</span> RESTServiceDiscovery rest;

    <span class="directive">public</span> <span class="predefined-type">Class</span>&lt;Comment&gt; facadeFor() {
        <span class="keyword">return</span> Comment.class;
    }

    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; pathParameters() {
        <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; map = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
        map.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, bookId);
        <span class="keyword">return</span> map;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will produce such an XML collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span>
<span class="tag">&lt;collection</span> <span class="attribute-name">xmlns:atom</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2005/Atom</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">totalRecords</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">start</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
 <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comments</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">add</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comments</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;comment</span> <span class="attribute-name">xmlid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;text&gt;</span>great book<span class="tag">&lt;/text&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comment/0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comment/0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comment/0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">remove</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comments</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">add</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comments</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;/comment&gt;</span>
 <span class="tag">&lt;comment</span> <span class="attribute-name">xmlid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;text&gt;</span>terrible book<span class="tag">&lt;/text&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comment/1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comment/1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comment/1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">remove</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comments</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">add</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;atom.link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/book/foo/comments</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;/comment&gt;</span>
<span class="tag">&lt;/collection&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_matrixparam"><a class="anchor" href="#_matrixparam"></a>9. @MatrixParam</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_newparam">supports <code>@MatrixParam</code> annotations with no parameter name.</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The idea of matrix parameters is that they are an arbitrary set of name-value pairs embedded in a uri path segment.
A matrix parameter example is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET http://host.com/library/book;name=EJB 3.0;author=Bill Burke</pre>
</div>
</div>
<div class="paragraph">
<p>The idea of matrix parameters is that it represents resources that are addressable by their attributes as well as their raw id.
The <code>@MatrixParam</code> annotation allows URI matrix parameters to be injected into a method invocation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> getBook(<span class="annotation">@MatrixParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> name, <span class="annotation">@MatrixParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">author</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> author) {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is one big problem with <code>@MatrixParam</code> that the current version of the specification does not resolve.
What if the same <code>MatrixParam</code> exists twice in different path segments?  In this case, it is better to use <code>PathParam</code>
combined with <code>PathSegment</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cookieparam"><a class="anchor" href="#_cookieparam"></a>10. @CookieParam</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_newparam">supports <code>@CookieParam</code> annotations with no parameter name.</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>@CookieParam</code> annotation allows the injection of the value of a cookie or an object representation of an HTTP
request cookie into a method invocation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET /books?num=5</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> getBooks(<span class="annotation">@CookieParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">sessionid</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> id) {
}

<span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> getBooks(<span class="annotation">@CookieParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">sessionid</span><span class="delimiter">&quot;</span></span>) jakarta.ws.rs.core.Cookie id) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Like <code>PathParam</code>, the parameter type can be a String, primitive, or class that has a String constructor or static valueOf() method.
It can also get an object representation of the cookie via the <code>jakarta.ws.rs.core.Cookie</code> class.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_formparam"><a class="anchor" href="#_formparam"></a>11. @FormParam</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_newparam">supports <code>@FormParam</code> annotations with no parameter name.</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the input request body is of the type "application/x-www-form-urlencoded", a.k.a.
an HTML Form, individual form parameters can be injected from the request body into method parameter values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;form</span> <span class="attribute-name">method</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">POST</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/resources/service</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
First name:
<span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">firstname</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;br&gt;</span>
Last name:
<span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">lastname</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;/form&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If posted through that form, this is what the service might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">NameRegistry</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/resources/service</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@POST</span>
   <span class="directive">public</span> <span class="type">void</span> addName(<span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">firstname</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> first, <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">lastname</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> last) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>@FormParam</code> cannot be combined with the default "application/x-www-form-urlencoded" that unmarshalls to a
<code>MultivaluedMap&lt;String, String&gt;</code>.  i.e. This is illegal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">NameRegistry</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/resources/service</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@POST</span>
   <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/x-www-form-urlencoded</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="type">void</span> addName(<span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">firstname</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> first, MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; form) {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_form"><a class="anchor" href="#_form"></a>12. @Form</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>@Form</code> is a RESTEasy specific annotation that allows the re-use of any <code>@*Param</code> annotation within an injected class.
RESTEasy will instantiate the class and inject values into any annotated <code>@*Param</code> or <code>@Context</code> property.
This is useful when there are a lot of parameters on a method and it is wanted to condense them into a value object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MyForm</span> {

    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">stuff</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="type">int</span> stuff;

    <span class="annotation">@HeaderParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">myHeader</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> header;

    <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> setFoo(<span class="predefined-type">String</span> foo) {}
}


<span class="annotation">@POST</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/myservice</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">void</span> post(<span class="annotation">@Form</span> MyForm form) {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When somebody posts to /myservice, RESTEasy will instantiate an instance of MyForm and inject the form parameter
"stuff" into the "stuff" field, the header "myheader" into the header field, and call the setFoo method with the path
param variable of "foo".</p>
</div>
<div class="paragraph">
<p><code>@Form</code> has some expanded <code>@FormParam</code> features. If a prefix is specified within the Form param, this will prepend a
prefix to any form parameter lookup. For example, say you have one Address class, but want to reference invoice and
shipping addresses from the same set of form parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="annotation">@Form</span>(prefix = <span class="string"><span class="delimiter">&quot;</span><span class="content">invoice</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> Address invoice;

    <span class="annotation">@Form</span>(prefix = <span class="string"><span class="delimiter">&quot;</span><span class="content">shipping</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> Address shipping;
}

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">street</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> street;
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MyResource</span> {
    <span class="annotation">@POST</span>
    <span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
    <span class="annotation">@Consumes</span>(MediaType.APPLICATION_FORM_URLENCODED)
    <span class="directive">public</span> <span class="predefined-type">String</span> post(<span class="annotation">@Form</span> Person p) {
        <span class="keyword">return</span> p.toString();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the client could send the following form parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>name=bill
invoice.street=xxx
shipping.street=yyy</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Person.invoice</code> and <code>Person.shipping</code> fields would be populated appropriately. Note, prefix mappings also support
lists and maps:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Form</span>(prefix=<span class="string"><span class="delimiter">&quot;</span><span class="content">telephoneNumbers</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">List</span>&lt;TelephoneNumber&gt; telephoneNumbers;
    <span class="annotation">@Form</span>(prefix=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Address&gt; addresses;
}

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TelephoneNumber</span> {
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">countryCode</span><span class="delimiter">&quot;</span></span>) <span class="directive">private</span> <span class="predefined-type">String</span> countryCode;
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">number</span><span class="delimiter">&quot;</span></span>) <span class="directive">private</span> <span class="predefined-type">String</span> number;
}

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">street</span><span class="delimiter">&quot;</span></span>) <span class="directive">private</span> <span class="predefined-type">String</span> street;
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">houseNumber</span><span class="delimiter">&quot;</span></span>) <span class="directive">private</span> <span class="predefined-type">String</span> houseNumber;
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MyResource</span> {

    <span class="annotation">@POST</span>
    <span class="annotation">@Consumes</span>(MediaType.APPLICATION_FORM_URLENCODED)
    <span class="directive">public</span> <span class="type">void</span> post (<span class="annotation">@Form</span> Person p) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following form params could be submitted and the <code>Person.telephoneNumbers</code> and <code>Person.addresses</code> fields would be
populated appropriately</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>request.addFormHeader(&quot;telephoneNumbers[0].countryCode&quot;, &quot;31&quot;);
request.addFormHeader(&quot;telephoneNumbers[0].number&quot;, &quot;0612345678&quot;);
request.addFormHeader(&quot;telephoneNumbers[1].countryCode&quot;, &quot;91&quot;);
request.addFormHeader(&quot;telephoneNumbers[1].number&quot;, &quot;9717738723&quot;);
request.addFormHeader(&quot;address[INVOICE].street&quot;, &quot;Main Street&quot;);
request.addFormHeader(&quot;address[INVOICE].houseNumber&quot;, &quot;2&quot;);
request.addFormHeader(&quot;address[SHIPPING].street&quot;, &quot;Square One&quot;);
request.addFormHeader(&quot;address[SHIPPING].houseNumber&quot;, &quot;13&quot;);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_newparam"><a class="anchor" href="#_newparam"></a>13. Improved <code>@&#8230;&#8203;Param</code> annotations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Jakarta RESTful Web Services specification defines annotations <code>@PathParam</code>, <code>@QueryParam</code>, <code>@FormParam</code>, <code>@CookieParam</code>, <code>@HeaderParam</code> and <code>@MatrixParam</code>.
Each annotation requires a parameter name.
RESTEasy provides a parallel set of annotations, <a href="#_pathparam"><code>@PathParam</code></a>, <a href="#_queryparam"><code>@QueryParam</code></a>, <a href="#_formparam"><code>@FormParam</code></a>, <a href="#_cookieparam"><code>@CookieParam</code></a>, <a href="#_headerparam"><code>@HeaderParam</code></a> and <a href="#_matrixparam"><code>@MatrixParam</code></a> which do not require a parameter name.
To use this RESTEasy feature, replace the annotation&#8217;s package name, <code>jakarta.ws.rs</code> with, <code>org.jboss.resteasy.annotations.jaxrs</code>.</p>
</div>
<div class="paragraph">
<p>Note that you can omit the annotation name for annotated method parameters as well as annotated fields or JavaBean properties.</p>
</div>
<div class="paragraph">
<p>Usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.annotations.jaxrs</span>.*;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/library</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Library</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/{isbn}</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="predefined-type">String</span> getBook(<span class="annotation">@PathParam</span> <span class="predefined-type">String</span> isbn) {
      <span class="comment">// search my database and get a string representation and return it</span>
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If an annotated variable does not have the same name as the path parameter, the name can still be specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.annotations.jaxrs</span>.*;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/library</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Library</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/{isbn}</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="predefined-type">String</span> getBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id) {
      <span class="comment">// search my database and get a string representation and return it</span>
   }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optionalparam"><a class="anchor" href="#_optionalparam"></a>14. Optional parameter types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy offers a mechanism to support a series of <code>java.util.Optional</code> types as a wrapper object types.
This will give users the ability to use optional typed parameters, and eliminate all null checks by using methods like
<code>Optional.orElse()</code>.</p>
</div>
<div class="paragraph">
<p>Here is the sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/double</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> optDouble(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>) OptionalDouble value) {
    <span class="keyword">return</span> <span class="predefined-type">Double</span>.toString(value.orElse(<span class="float">4242.0</span>));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>From the above sample code we can see that the <code>OptionalDouble</code> can be used as parameter type, and when users don&#8217;t
provide a value in <code>@QueryParam</code>, then the default value will be returned.</p>
</div>
<div class="paragraph">
<p>Here is the list of supported optional parameter types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@QueryParam</code></p>
</li>
<li>
<p><code>@FormParam</code></p>
</li>
<li>
<p><code>@MatrixParam</code></p>
</li>
<li>
<p><code>@HeaderParam</code></p>
</li>
<li>
<p><code>@CookieParam</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As the list shown above, those parameter types support the Java-provided <code>Optional</code> types.
Please note that the <code>@PathParam</code> is an exception for which <code>Optional</code> is not available.
The reason is that <code>Optional</code> for the <code>@PathParam</code> use case would just be a NO-OP, since an element of the path cannot be omitted.</p>
</div>
<div class="paragraph">
<p>The <code>Optional</code> types can also be used as type of the fields of a `@BeanParam&#8217;s class.</p>
</div>
<div class="paragraph">
<p>Here is an example of endpoint with a <code>@BeanParam</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/double</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> optDouble(<span class="annotation">@BeanParam</span> Bean bean) {
    <span class="keyword">return</span> <span class="predefined-type">Double</span>.toString(bean.value.orElse(<span class="float">4242.0</span>));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The corresponding class <code>Bean</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Bean</span> {
    <span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>)
    OptionalDouble value;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, the <code>Optional</code> types can be used directly as type of the fields of a Jakarta RESTful Web Services resource class.</p>
</div>
<div class="paragraph">
<p>Here is an example of a Jakarta RESTful Web Services resource class with an <code>Optional</code> type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RequestScoped</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">OptionalResource</span> {
    <span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>)
    Optional&lt;<span class="predefined-type">String</span>&gt; value;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defaultvalue"><a class="anchor" href="#_defaultvalue"></a>15. @DefaultValue</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>@DefaultValue</code> is a parameter annotation that can be combined with any of the other @*Param annotations to define a
default value when the HTTP request item does not exist.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> getBooks(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">num</span><span class="delimiter">&quot;</span></span>) <span class="annotation">@DefaultValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">10</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> num) {}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_encoded_and_encoding"><a class="anchor" href="#_encoded_and_encoding"></a>16. @Encoded and encoding</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jakarta RESTful Web Services allows encoded or decoded <code>@*Params</code>, the specification of path definitions and parameter names using encoded or decoded strings.</p>
</div>
<div class="paragraph">
<p>The <code>@jakarta.ws.rs.Encoded</code> annotation can be used on a class, method, or param.
By default, inject <code>@PathParam</code> and <code>@QueryParams</code> are decoded. Additionally adding the <code>@Encoded</code> annotation, the value
of these params will be provided in encoded form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyResource</span> {

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{param}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">param</span><span class="delimiter">&quot;</span></span>) <span class="annotation">@Encoded</span> <span class="predefined-type">String</span> param) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the value of the <code>@PathParam</code> injected into the param of the <code>get()</code> method will be URL encoded.
Adding the <code>@Encoded</code> annotation as a parameter annotation triggers this affect.</p>
</div>
<div class="paragraph">
<p>The <code>@Encoded</code> annotation may also be used on the entire method and any combination of <code>@QueryParam</code> or `@PathParam&#8217;s
values will be encoded.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyResource</span> {

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{param}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@GET</span>
    <span class="annotation">@Encoded</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> foo, <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">param</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> param) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the values of the foo query param and param path param will be injected as encoded values.</p>
</div>
<div class="paragraph">
<p>The default can also be encoded for the entire class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Encoded</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ClassEncoded</span> {

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> foo) {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_context"><a class="anchor" href="#_context"></a>17. @Context</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Support for <code>@Context</code> inject has been
<a href="https://jakarta.ee/specifications/restful-ws/3.1/jakarta-restful-ws-spec-3.1.html#context-injection" target="_blank" rel="noopener">deprecated</a>.
RESTEasy supports using the <code>@Inject</code> annotation on instance variables. Support for method and constructor injection
will be available in a future release.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>@Context</code> annotation allows the injection of instances of the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jakarta.ws.rs.core.HttpHeaders</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.core.UriInfo</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.core.Request</code></p>
</li>
<li>
<p><code>jakarta.servlet.http.HttpServletRequest</code></p>
</li>
<li>
<p><code>jakarta.servlet.http.HttpServletResponse</code></p>
</li>
<li>
<p><code>jakarta.servlet.ServletConfig</code></p>
</li>
<li>
<p><code>jakarta.servlet.ServletContext</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.core.SecurityContext</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jakarta_rest_resource_locators_and_sub_resources"><a class="anchor" href="#_jakarta_rest_resource_locators_and_sub_resources"></a>18. Jakarta RESTful Web Services Resource Locators and Sub Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Resource classes are able to partially process a request and provide another sub resource object that can process the remainder of the request.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingStore</span> {

    <span class="annotation">@Inject</span>
    CustomerRegistry customerRegistry;

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/customers/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Customer getCustomer(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> id) {
        <span class="keyword">return</span> customerRegistry.find(id);
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get() {}

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/address</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getAddress() {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resource methods that have a <code>@Path</code> annotation, but no HTTP method are considered sub-resource locators.
Their job is to provide an object that can process the request.
In the above example <code>ShoppingStore</code> is a root resource because its class is annotated with <code>@Path</code>.
The <code>getCustomer()</code> method is a sub-resource locator method.</p>
</div>
<div class="paragraph">
<p>If the client invoked:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>GET /customer/123</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>ShoppingStore.getCustomer()</code> method would be invoked first.
This method provides a Customer object that can service the request.
The http request will be dispatched to the <code>Customer.get()</code> method.
Another example is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>GET /customer/123/address</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this request, again, first the <code>ShoppingStore.getCustomer()</code> method is invoked.
A customer object is returned, and the rest of the request is dispatched to the <code>Customer.getAddress()</code> method.</p>
</div>
<div class="paragraph">
<p>Another interesting feature of Sub-resource locators is that the locator method result is dynamically processed at runtime to figure out how to dispatch the request.
So, the <code>ShoppingStore.getCustomer()</code> method does not have to declare any specific type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingStore</span> {

    <span class="annotation">@Inject</span>
    CustomerRegistry customerRegistry;

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/customers/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> java.lang.Object getCustomer(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> id) {
        <span class="keyword">return</span> customerRegistry.find(id);
    }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get() {}

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/address</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getAddress() {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, <code>getCustomer()</code> returns a <code>java.lang.Object</code>.
Per request, at runtime, the Jakarta RESTful Web Services server will determine how to dispatch the request based on the object returned by
<code>getCustomer()</code>.  Possible uses of this are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There maybe a class hierarchy for your customers. Customer is the abstract base class,
<code>CorporateCustomer</code> and <code>IndividualCustomer</code> are subclasses.</p>
</li>
<li>
<p>The <code>getCustomer()</code> method might be doing a Hibernate polymorphic query and doesn&#8217;t know, or
care, what concrete class is it querying for, or what it returns.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShoppingStore</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/customers/{id}</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> java.lang.Object getCustomer(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> id) {
      <span class="keyword">return</span> entityManager.find(Customer.class, id);
   }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get() {}

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/address</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getAddress() {}
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">CorporateCustomer</span> <span class="directive">extends</span> Customer {

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/businessAddress</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getAddress() {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources_metadata"><a class="anchor" href="#_resources_metadata"></a>19. Resources metadata configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When processing Jakarta RESTful Web Services deployments, RESTEasy relies on <code>ResourceBuilder</code> to create metadata for each  resource.
Such metadata is defined using the metadata SPI in package <code>org.jboss.resteasy.spi.metadata</code>, in particular the <code>ResourceClass</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.spi.metadata</span>;

<span class="directive">public</span> <span class="type">interface</span> <span class="class">ResourceClass</span> {
  <span class="predefined-type">String</span> getPath();

  <span class="predefined-type">Class</span>&lt;?&gt; getClazz();

  ResourceConstructor getConstructor();

  FieldParameter<span class="type">[]</span> getFields();

  SetterParameter<span class="type">[]</span> getSetters();

  ResourceMethod<span class="type">[]</span> getResourceMethods();

  ResourceLocator<span class="type">[]</span> getResourceLocators();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Among the other classes and interfaces defining metadata SPI, the following interfaces are worth a mention here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ResourceConstructor</span> {
  ResourceClass getResourceClass();

  <span class="predefined-type">Constructor</span> getConstructor();

  ConstructorParameter<span class="type">[]</span> getParams();
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">ResourceMethod</span> <span class="directive">extends</span> ResourceLocator {
  SetString getHttpMethods();

  MediaType<span class="type">[]</span> getProduces();

  MediaType<span class="type">[]</span> getConsumes();

  <span class="type">boolean</span> isAsynchronous();

  <span class="type">void</span> markAsynchronous();
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">ResourceLocator</span> {
  ResourceClass getResourceClass();

  <span class="predefined-type">Class</span>&lt;?&gt; getReturnType();

  <span class="predefined-type">Type</span> getGenericReturnType();

  <span class="predefined-type">Method</span> getMethod();

  <span class="predefined-type">Method</span> getAnnotatedMethod();

  MethodParameter<span class="type">[]</span> getParams();

  <span class="predefined-type">String</span> getFullpath();

  <span class="predefined-type">String</span> getPath();

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The interesting point is that RESTEasy allows tuning the metadata generation by providing implementations of the <code>ResourceClassProcessor</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.spi.metadata</span>;

<span class="directive">public</span> <span class="type">interface</span> <span class="class">ResourceClassProcessor</span> {

  <span class="comment">/**
   * Allows the implementation of this method to modify the resource metadata represented by
   * the supplied {@link ResourceClass} instance. Implementation will typically create
   * wrappers which modify only certain aspects of the metadata.
   *
   * @param clazz The original metadata
   * @return the (potentially modified) metadata (never null)
   */</span>
  ResourceClass process(ResourceClass clazz);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The processors are meant to be, and are resolved as, regular Jakarta RESTful Web Services annotated providers.
They allow for wrapping resource metadata classes with custom versions that can be used for various advanced scenarios like</p>
</div>
<div class="ulist">
<ul>
<li>
<p>adding additional resource method/locators to the resource</p>
</li>
<li>
<p>altering the http methods</p>
</li>
<li>
<p>altering the @Produces / @Consumes media types</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jakarta_rest_content_negotiation"><a class="anchor" href="#_jakarta_rest_content_negotiation"></a>20. Jakarta RESTful Web Services Content Negotiation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The HTTP protocol has built in content negotiation headers that allow the client and server to specify what content they are transferring and what content they would prefer to get.
The server declares content preferences via the <code>@Produces</code> and <code>@Consumes</code> headers.</p>
</div>
<div class="paragraph">
<p><code>@Consumes</code> is an array of media types that a particular resource or resource method consumes.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/*</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/library</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Library</span> {

    <span class="annotation">@POST</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> stringBook(<span class="predefined-type">String</span> book) {}

    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@POST</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> jaxbBook(<span class="predefined-type">Book</span> book) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a client makes a request, Jakarta RESTful Web Services first finds all methods that match the path, then, it those matches based on the content-type header sent by the client.
So, if a client sent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>POST /library
Content-Type: text/plain

This is a nice book</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>stringBook()</code> method would be invoked because it matches to the default <code>text/*</code> media type.
Now, if the client instead sends XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>POST /library
Content-Type: text/xml

book name=&quot;EJB 3.0&quot; author=&quot;Bill Burke&quot;/</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>jaxbBook()</code> method would be invoked.</p>
</div>
<div class="paragraph">
<p>The <code>@Produces</code> is used to map a client request and match it up to the client&#8217;s Accept header.
The Accept HTTP header is sent by the client and defines the media types the client prefers to receive from the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/*</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/library</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Library</span> {

<span class="annotation">@GET</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> getJSON() {}

<span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> get() {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>So, if the client sends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>GET /library
Accept: application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>getJSON()</code> method would be invoked.</p>
</div>
<div class="paragraph">
<p><code>@Consumes</code> and <code>@Produces</code> can list multiple media types that they support.
The client&#8217;s Accept header can also send multiple types it might like to receive.
More specific media types are chosen first.
The client Accept header or @Produces @Consumes can also specify weighted preferences that are used to match requests with resource methods.
This is best explained by RFC 2616 section 14.1. RESTEasy supports this complex way of doing content negotiation.</p>
</div>
<div class="paragraph">
<p>A variant in Jakarta RESTful Web Services is a combination of media type, content-language, and content encoding as well as etags, last modified headers, and other preconditions.
This is a more complex form of content negotiation that is done programmatically by the application developer using the
<code>jakarta.ws.rs.core.Variant</code>, <code>VariantListBuilder</code>, and <code>Request</code> objects.
Request is injected via <code>@Context</code>.
Read the javadoc for more info on these.</p>
</div>
<div class="sect2">
<h3 id="_media_mappings"><a class="anchor" href="#_media_mappings"></a>20.1. URL-based negotiation</h3>
<div class="paragraph">
<p>Some clients, like browsers, cannot use the Accept and Accept-Language headers to negotiation the representation&#8217;s media type or language.
RESTEasy allows the mapping of file name suffixes like (.xml, .txt, .en, .fr) to media types and languages.
These file name suffixes take the place and override any Accept header sent by the client.
They are configured using the <code>resteasy.media.type.mappings</code> and <code>resteasy.language.mappings</code> parameters.
If configured within the application&#8217;s web.xml, it would look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;display-name&gt;</span>Archetype Created Web Application<span class="tag">&lt;/display-name&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.media.type.mappings<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>html : text/html, json : application/json, xml : application/xml<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>

   <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.language.mappings<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>en : en-US, es : es, fr : fr<span class="tag">&lt;/param-value&gt;</span>
   <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.</p>
</div>
<div class="paragraph">
<p>Mappings are a comma delimited list of suffix/mediatype or suffix/language mappings.
Each mapping is delimited by a ':'.  If GET /foo/bar.xml.en is invoked , this would be equivalent to invoking the following request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>GET /foo/bar
Accept: application/xml
Accept-Language: en-US</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mapped file suffixes are stripped from the target URL path before the request is dispatched to a corresponding Jakarta RESTful Web Services resource.</p>
</div>
</div>
<div class="sect2">
<h3 id="_param_media_mappings"><a class="anchor" href="#_param_media_mappings"></a>20.2. Query String Parameter-based negotiation</h3>
<div class="paragraph">
<p>RESTEasy can do content negotiation based in a parameter in the query string.
To enable this, the parameter <code>resteasy.media.type.param.mapping</code> should be configured in the web.xml file.
It would look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;display-name&gt;</span>Archetype Created Web Application<span class="tag">&lt;/display-name&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.media.type.param.mapping<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>someName<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.</p>
</div>
<div class="paragraph">
<p>The param-value is the name of the query string parameter that RESTEasy will use in the place of the Accept header.</p>
</div>
<div class="paragraph">
<p>Invoking <a href="http://localhost/resouce?someName=application/xml" class="bare">http://localhost/resouce?someName=application/xml</a>, will give the application/xml media type the highest priority in the content negotiation.</p>
</div>
<div class="paragraph">
<p>In cases where the request contains both the parameter and the Accept header, the parameter will be more relevant.</p>
</div>
<div class="paragraph">
<p>It is possible to leave the param-value empty, that will cause the processor to look for a parameter named 'accept'.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_content_marshallingproviders"><a class="anchor" href="#_content_marshallingproviders"></a>21. Content Marshalling/Providers</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_default_providers_and_default_jakarta_restful_web_services_content_marshalling"><a class="anchor" href="#_default_providers_and_default_jakarta_restful_web_services_content_marshalling"></a>21.1. Default Providers and default Jakarta RESTful Web Services Content Marshalling</h3>
<div class="paragraph">
<p>RESTEasy can automatically marshal and unmarshal a few different message bodies.</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Media Types</th>
<th class="tableblock halign-left valign-top">Java Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/*+xml</code>, <code>text/\*\+xml</code>, <code>application/*\+json</code>, <code>application/\*\+fastinfoset</code>, <code>application/atom\+\*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jakarta XML Binding annotated classes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/*+xml</code>, <code>text/\*+xml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.w3c.dom.Document</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.io.InputStream</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>text/plain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">primitives, <code>java.lang.String</code>, or any type that has a String constructor, or static <code>valueOf(String)</code> method for input,
toString() for output</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.activation.DataSource</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.io.File</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application/x-www-form-urlencoded</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jakarta.ws.rs.core.MultivaluedMap</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When a <code>java.io.File</code> is created, as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/test</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TempFileDeletionResource</span> {
   <span class="annotation">@POST</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response post(<span class="predefined-type">File</span> file)  {
      <span class="keyword">return</span> Response.ok(file.getPath()).build();
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>a temporary file is created in the file system.
On the server side, that temporary file will be deleted at the end of the invocation.
On the client side, however, it is the responsibility of the user to  delete the temporary file.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_content_marshalling_with__provider_classes"><a class="anchor" href="#_content_marshalling_with__provider_classes"></a>21.2. Content Marshalling with @Provider classes</h3>
<div class="paragraph">
<p>The Jakarta RESTful Web Services specification allows the user to plug in their own request/response body reader and writers.
To do this, the user annotates a class with <code>@Provider</code> and specify the <code>@Produces</code> types for a writer and <code>@Consumes</code> types for a reader.
The user must also implement a MessageBodyReader/Writer interface respectively.
Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Provider</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">DefaultTextPlain</span> <span class="directive">implements</span> MessageBodyReader, MessageBodyWriter {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">boolean</span> isReadable(<span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations, MediaType mediaType) {
       <span class="comment">// StringTextStar should pick up strings</span>
       <span class="keyword">return</span> !<span class="predefined-type">String</span>.class.equals(type)  TypeConverter.isConvertable(type);
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> readFrom(<span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations, MediaType mediaType, MultivaluedMap httpHeaders, <span class="predefined-type">InputStream</span> entityStream) <span class="directive">throws</span> <span class="exception">IOException</span>, WebApplicationException {
       <span class="predefined-type">InputStream</span> delegate = NoContent.noContentCheck(httpHeaders, entityStream);
       <span class="predefined-type">String</span> value = ProviderHelper.readString(delegate, mediaType);
       <span class="keyword">return</span> TypeConverter.getType(type, value);
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">boolean</span> isWriteable(<span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations, MediaType mediaType) {
       <span class="comment">// StringTextStar should pick up strings</span>
       <span class="keyword">return</span> !<span class="predefined-type">String</span>.class.equals(type) &amp;&amp; !type.isArray();
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">long</span> getSize(<span class="predefined-type">Object</span> o, <span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations, MediaType mediaType) {
       <span class="predefined-type">String</span> charset = mediaType.getParameters().get(<span class="string"><span class="delimiter">&quot;</span><span class="content">charset</span><span class="delimiter">&quot;</span></span>);
       <span class="keyword">if</span> (charset != <span class="predefined-constant">null</span>)
          <span class="keyword">try</span> {
             <span class="keyword">return</span> o.toString().getBytes(charset).length;
          } <span class="keyword">catch</span> (<span class="exception">UnsupportedEncodingException</span> e) {
             <span class="comment">// Use default encoding.</span>
          }
       <span class="keyword">return</span> o.toString().getBytes(StandardCharsets.UTF_8).length;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> writeTo(<span class="predefined-type">Object</span> o, Clas&lt;?&gt; type, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations, MediaType mediaType, MultivaluedMap httpHeaders, <span class="predefined-type">OutputStream</span> entityStream) <span class="directive">throws</span> <span class="exception">IOException</span>, WebApplicationException {
       <span class="predefined-type">String</span> charset = mediaType.getParameters().get(<span class="string"><span class="delimiter">&quot;</span><span class="content">charset</span><span class="delimiter">&quot;</span></span>);
       <span class="keyword">if</span> (charset == <span class="predefined-constant">null</span>) entityStream.write(o.toString().getBytes(StandardCharsets.UTF_8));
       <span class="keyword">else</span> entityStream.write(o.toString().getBytes(charset));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in order to support <a href="#_asynchronous_io">Async IO</a>, the user must implement the <code>AsyncMessageBodyWriter</code> interface, which requires the implementation of this extra method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="annotation">@Provider</span>
 <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
 <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
 <span class="directive">public</span> <span class="type">class</span> <span class="class">DefaultTextPlain</span> <span class="directive">implements</span> MessageBodyReader, AsyncMessageBodyWriter {
    <span class="comment">// ...</span>
    <span class="directive">public</span> CompletionStage&lt;<span class="predefined-type">Void</span>&gt; asyncWriteTo(<span class="predefined-type">Object</span> o, <span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations, MediaType mediaType, MultivaluedMap httpHeaders, AsyncOutputStream entityStream) {
       <span class="predefined-type">String</span> charset = mediaType.getParameters().get(<span class="string"><span class="delimiter">&quot;</span><span class="content">charset</span><span class="delimiter">&quot;</span></span>);
       <span class="keyword">if</span> (charset == <span class="predefined-constant">null</span>)
          <span class="keyword">return</span> entityStream.asyncWrite(o.toString().getBytes(StandardCharsets.UTF_8));
       <span class="keyword">else</span>
          <span class="keyword">return</span> entityStream.asyncWrite(o.toString().getBytes(charset));
    }
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The RESTEasy ServletContextLoader will automatically scan the application&#8217;s <code>WEB-INF/lib</code> and classes directories for classes annotated with <code>@Provider</code> or the user can manually configure them in web.xml.
See <a href="#installation_configuration">Installation/Configuration</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_messagebodyworkers"><a class="anchor" href="#_messagebodyworkers"></a>21.3. Providers Utility Class</h3>
<div class="paragraph">
<p><a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/ext/providers"><code>jakarta.ws.rs.ext.Providers</code></a> is a simple injectable interface that allows you to look up <code>MessageBodyReaders</code>, Writers, ContextResolvers, and ExceptionMappers.
It is very useful, for instance, for implementing multipart providers.
Content types that embed other random content types.</p>
</div>
<div class="paragraph">
<p>A Providers instance is injectable into MessageBodyReader or Writers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Provider</span>
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/fixed</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MultipartProvider</span> <span class="directive">implements</span> MessageBodyReader {

    <span class="annotation">@Context</span>
    <span class="directive">private</span> Providers providers;

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_document_marshalling"><a class="anchor" href="#_configuring_document_marshalling"></a>21.4. Configuring Document Marshalling</h3>
<div class="paragraph">
<p>XML document parsers are subject to a form of attack known as the XXE (Xml eXternal Entity) Attack (<a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing" class="bare">https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing</a>), in which expanding an external entity causes an unsafe file to be loaded.
For example, the document</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="doctype">&lt;!DOCTYPE foo
[&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><span class="doctype">]&gt;</span>
<span class="tag">&lt;search&gt;</span>
    <span class="tag">&lt;user&gt;</span>bill<span class="tag">&lt;/user&gt;</span>
    <span class="tag">&lt;file&gt;</span><span class="entity">&amp;xxe;</span><span class="tag">&lt;file&gt;</span>
<span class="tag">&lt;/search&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>could cause the passwd file to be loaded.</p>
</div>
<div class="paragraph">
<p>By default, RESTEasy&#8217;s built-in unmarshaller for <code>org.w3c.dom.Document</code> documents will not expand external entities, replacing them by the empty string instead.
It can be configured to replace external entities by values defined in the DTD by setting the parameter
<code>resteasy.document.expand.entity.references</code> to "true". If configured in the <code>web.xml</code> file, it would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>resteasy.document.expand.entity.references<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.</p>
</div>
<div class="paragraph">
<p>Another way of dealing with the problem is by prohibiting DTDs, which RESTEasy does by default.
This behavior can be changed by setting the parameter <code>resteasy.document.secure.disableDTDs</code> to "false".</p>
</div>
<div class="paragraph">
<p>Documents are also subject to Denial of Service Attacks when buffers are overrun by large entities or too many attributes.
For example, if a DTD defined the following entities</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>!ENTITY foo 'foo'
!ENTITY foo1 'foo;foo;foo;foo;foo;foo;foo;foo;foo;foo;'
!ENTITY foo2 'foo1;foo1;foo1;foo1;foo1;foo1;foo1;foo1;foo1;foo1;'
!ENTITY foo3 'foo2;foo2;foo2;foo2;foo2;foo2;foo2;foo2;foo2;foo2;'
!ENTITY foo4 'foo3;foo3;foo3;foo3;foo3;foo3;foo3;foo3;foo3;foo3;'
!ENTITY foo5 'foo4;foo4;foo4;foo4;foo4;foo4;foo4;foo4;foo4;foo4;'
!ENTITY foo6 'foo5;foo5;foo5;foo5;foo5;foo5;foo5;foo5;foo5;foo5;'</code></pre>
</div>
</div>
<div class="paragraph">
<p>then the expansion of foo6;  would result in 1,000,000 foos.
By default, RESTEasy will limit the number of expansions and the number of attributes per entity.
The exact behavior depends on the underlying parser.
The limits can be turned off by setting the parameter <code>resteasy.document.secure.processing.feature</code> to "false".</p>
</div>
</div>
<div class="sect2">
<h3 id="_text_media_types"><a class="anchor" href="#_text_media_types"></a>21.5. Text media types and character sets</h3>
<div class="paragraph">
<p>The Jakarta RESTful Web Services specification says</p>
</div>
<div class="quoteblock">
<blockquote>
When writing responses, implementations SHOULD respect application-supplied character
set metadata and SHOULD use UTF-8 if a character set is not specified by the application
or if the application specifies a character set that is unsupported.
</blockquote>
</div>
<div class="paragraph">
<p>On the other hand, the HTTP specification says</p>
</div>
<div class="quoteblock">
<blockquote>
When no explicit charset parameter is provided by the sender, media subtypes of the
"text" type are defined to have a default charset value of "ISO-8859-1" when received
via HTTP. Data in character sets other than "ISO-8859-1" or its subsets MUST be labeled
with an appropriate charset value.
</blockquote>
</div>
<div class="paragraph">
<p>It follows that, in the absence of a character set specified by a resource or resource method, RESTEasy SHOULD use UTF-8 as the character set for text media types, and, if it does, it MUST add an explicit  charset parameter to the Content-Type response header.
RESTEasy started adding the explicit charset parameter in releases 3.1.2.Final and 3.0.22.Final, and that new behavior could cause some compatibility problems.
To specify the previous behavior, in which UTF-8 was used for text media types, but the explicit charset was not appended, the parameter "resteasy.add.charset" may be set to "false". It defaults to "true".</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By "text" media types, we mean
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>a media type with type "text" and any subtype;</p>
</li>
<li>
<p>a media type with type ""application" and subtype beginning with "xml".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The latter set includes "application/xml-external-parsed-entity" and "application/xml-dtd".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_built_in_xml_bind_providers"><a class="anchor" href="#_built_in_xml_bind_providers"></a>22. Jakarta XML Binding providers</h2>
<div class="sectionbody">
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
In Jakarta RESTful Web Services 4.0 the Jakarta XML Binding support was removed from specification. RESTEasy still plans on supporting
Jakarta XML Binding for the time being. This may not be supported in a future release. Please plan on migrating to
<a href="#_json_p">JSON</a> or some other supported data type.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As required by the specification, RESTEasy includes support for (un)marshalling Jakarta XML Binding annotated classes.
RESTEasy provides multiple providers to address some subtle differences between classes generated by XJC and classes which are simply annotated with @XmlRootElement, or working with JAXBElement classes directly.</p>
</div>
<div class="paragraph">
<p>For the most part, developers using the Jakarta RESTful Web Services API, the selection of which provider is invoked will be completely transparent.
For developers wishing to access the providers directly (which most folks won&#8217;t need to do), this document describes which provider is best suited for different configurations.</p>
</div>
<div class="paragraph">
<p>A Jakarta XML Binding Provider is selected by RESTEasy when a parameter or return type is an object that is annotated with annotations Jakarta XML Binding (such as <code>@XmlRootEntity</code> or <code>@XmlType</code>) or if the type is a JAXBElement.
Additionally, the resource class or resource method will be annotated with either a <code>@Consumes</code> or <code>@Produces</code> annotation and contain one or more of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>text/*+xml</p>
</li>
<li>
<p>application/*+xml</p>
</li>
<li>
<p>application/*+fastinfoset</p>
</li>
<li>
<p>application/*+json</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>RESTEasy will select a different provider based on the return type or parameter type used in the resource.
This section describes how the selection process works.</p>
</div>
<div class="paragraph">
<p><code>@XmlRootEntity</code> When a class is annotated with a <code>@XmlRootElement</code> annotation, RESTEasy will select the
<code>JAXBXmlRootElementProvider</code>.
This provider handles basic marshaling and unmarshalling of custom Jakarta XML Binding entities.</p>
</div>
<div class="paragraph">
<p><code>@XmlType</code> Classes which have been generated by XJC will most likely not contain an <code>@XmlRootEntity</code> annotation.
In order for these classes to marshalled, they must be wrapped within a <code>JAXBElement</code> instance.
This is typically accomplished by invoking a method on the class which serves as the <code>XmlRegistry</code> and is named <code>ObjectFactory</code>.</p>
</div>
<div class="paragraph">
<p>The <code>JAXBXmlTypeProvider</code> provider is selected when the class is annotated with an <code>XmlType</code> annotation and not an
<code>XmlRootElement</code> annotation.</p>
</div>
<div class="paragraph">
<p>This provider simplifies this task by attempting to locate the <code>XmlRegistry</code> for the target class.
By default, a Jakarta XML Binding implementation will create a class called <code>ObjectFactory</code> and is located in the same package as the target class.
When this class is located, it will contain a create method that takes the object instance as a parameter.
For example, if the target type is called <code>Contact</code>, then the <code>ObjectFactory</code> class will have a method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> JAXBElement&lt;?&gt; createContact(Contact value);</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>JAXBElement&lt;?&gt;</code> If your resource works with the JAXBElement class directly, the RESTEasy runtime will select the
<code>JAXBElementProvider</code>.
This provider examines the <code>ParameterizedType</code> value of the <code>JAXBElement</code> in order to select the appropriate <code>JAXBContext</code>.</p>
</div>
<div class="sect2">
<h3 id="_decorators"><a class="anchor" href="#_decorators"></a>22.1. Jakarta XML Binding Decorators</h3>
<div class="paragraph">
<p>Resteasy&#8217;s Jakarta XML Binding providers have a pluggable way to decorate Marshaller and Unmarshaller instances.
The way it works is that you can write an annotation that can trigger the decoration of a Marshaller or Unmarshaller.
Your decorators can do things like set Marshaller or Unmarshaller properties, set up validation, and the like.
Here&#8217;s an example.
Say we want to have an annotation that will trigger pretty-printing, nice formatting, of an XML document.
If we were using raw Jakarta XML Binding, we would set a property on the Marshaller of Marshaller.JAXB_FORMATTED_OUTPUT.
Let&#8217;s write a Marshaller decorator.</p>
</div>
<div class="paragraph">
<p>First define an annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.annotations.Decorator</span>;

<span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD, <span class="predefined-type">ElementType</span>.PARAMETER, <span class="predefined-type">ElementType</span>.FIELD})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@Decorator</span>(processor = PrettyProcessor.class, target = Marshaller.class)
<span class="directive">public</span> <span class="annotation">@interface</span> Pretty {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this to work, we must annotate the <code>@Pretty</code> annotation with a meta-annotation called @Decorator.
The <code>target()</code> attribute must be the Jakarta XML Binding Marshaller class.
The <code>processor()</code> attribute is a class we will write next.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.core.interception.DecoratorProcessor</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.annotations.DecorateTypes</span>;

<span class="keyword">import</span> <span class="include">jakarta.xml.bind.Marshaller</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.PropertyException</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Produces</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Annotation</span>;

<span class="comment">/**
 * @author &lt;a href=&quot;mailto:bill@burkecentral.com&quot;&gt;Bill Burke&lt;/a&gt;
 * @version $Revision: 1 $
 */</span>
<span class="annotation">@DecorateTypes</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">text/*+xml</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/*+xml</span><span class="delimiter">&quot;</span></span>})
<span class="directive">public</span> <span class="type">class</span> <span class="class">PrettyProcessor</span> <span class="directive">implements</span> DecoratorProcessor&lt;Marshaller, Pretty&gt; {
    <span class="directive">public</span> Marshaller decorate(Marshaller target, Pretty annotation,
                  <span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations, MediaType mediaType) {
       target.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, <span class="predefined-type">Boolean</span>.TRUE);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The processor implementation must implement the <code>DecoratorProcessor</code> interface and should also be annotated with <code>@DecorateTypes</code>.
This annotation specifies what media types the processor can be used with.
Now that we&#8217;ve defined our annotation and our Processor, we can use it on our Jakarta RESTful Web Services resource methods or Jakarta XML Binding types as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Pretty</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> SomeJAXBObject get() {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the RESTEasy source code for the implementation of @XmlHeader for more detailed information</p>
</div>
</div>
<div class="sect2">
<h3 id="_pluggable_xml_bind_context_s_with_contextresolvers"><a class="anchor" href="#_pluggable_xml_bind_context_s_with_contextresolvers"></a>22.2. Pluggable JAXBContext&#8217;s with ContextResolvers</h3>
<div class="paragraph">
<p>Do not use this feature unless you are knowledgeable about using it.</p>
</div>
<div class="paragraph">
<p>Based on the class being marshalling/unmarshalling, RESTEasy will, by default create and cache JAXBContext instances per class type.
If you do not want RESTEasy to create JAXBContexts, plug in your own by implementing an instance of <code>jakarta.ws.rs.ext.ContextResolver</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ContextResolver</span>&lt;T&gt; {
    T getContext(<span class="predefined-type">Class</span>&lt;?&gt; type);
}

<span class="annotation">@Provider</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyJAXBContextResolver</span> <span class="directive">implements</span> ContextResolver&lt;JAXBContext&gt; {
    JAXBContext getContext(<span class="predefined-type">Class</span>&lt;?&gt; type) {
        <span class="keyword">if</span> (type.equals(WhateverClassIsOverridedFor.class)) <span class="keyword">return</span> JAXBContext.newInstance();
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>@Produces</code> annotation must be provided to specify the media type the context is meant for.
An implementation of <code>ContextResolver&lt;JAXBContext&gt;</code> must be provided and that class must have the <code>@Provider</code> annotation.
This helps the runtime match to the correct context resolver.</p>
</div>
<div class="paragraph">
<p>There are multiple ways to make this ContextResolver available.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Return it as a class or instance from a jakarta.ws.rs.core.Application implementation</p>
</li>
<li>
<p>List it as a provider with resteasy.providers</p>
</li>
<li>
<p>Let RESTEasy automatically scan for it within the WAR file. See Configuration Guide</p>
</li>
<li>
<p>Manually add it via <code>ResteasyProviderFactory.getInstance().registerProvider(Class)</code> or <code>registerProviderInstance(Object)</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_jakarta_xml_binding_xml_provider"><a class="anchor" href="#_jakarta_xml_binding_xml_provider"></a>22.3. Jakarta XML Binding + XML provider</h3>
<div class="paragraph">
<p>RESTEasy is required to provide Jakarta XML Binding provider support for XML.
It has a few extra annotations that can help code the application.</p>
</div>
<div class="sect3">
<h4 id="_xmlheader"><a class="anchor" href="#_xmlheader"></a>22.3.1. @XmlHeader and @Stylesheet</h4>
<div class="paragraph">
<p>Sometimes when outputting XML documents you may want to set an XML header.
RESTEasy provides the <code>@org.jboss.resteasy.annotations.providers.jaxb.XmlHeader</code> annotation for this.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Thing</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/test</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestService</span> {
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/header</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@XmlHeader</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;?xml-stylesheet type='text/xsl' href='${baseuri}foo.xsl' ?&gt;</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Thing get() {
        Thing thing = <span class="keyword">new</span> Thing();
        thing.setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> thing;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@XmlHeader</code> forces the XML output to have a xml-stylesheet header.
This header could also have been put on the Thing class to get the same result.
See the javadocs for more details on how to use substitution values provided by resteasy.</p>
</div>
<div class="paragraph">
<p>RESTEasy also has a convenience annotation for stylesheet headers.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Thing</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }

    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/test</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestService</span> {
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/stylesheet</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Stylesheet</span>(type=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/css</span><span class="delimiter">&quot;</span></span>, href=<span class="string"><span class="delimiter">&quot;</span><span class="content">${basepath}foo.xsl</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Junk</span>
    <span class="directive">public</span> Thing getStyle() {
        Thing thing = <span class="keyword">new</span> Thing();
        thing.setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> thing;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jakarta_xml_binding_json_provider"><a class="anchor" href="#_jakarta_xml_binding_json_provider"></a>22.4. Jakarta XML Binding + JSON provider</h3>
<div class="paragraph">
<p>RESTEasy supports the marshalling of Jakarta XML Binding annotated POJOs to and from JSON.
This provider wraps the Jackson2 library to accomplish this.</p>
</div>
<div class="paragraph">
<p>To use this integration with Jackson import the resteasy-jackson2-provider Maven module.</p>
</div>
<div class="paragraph">
<p>For example, consider this Jakarta XML Binding class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Book</span> {
    <span class="directive">private</span> <span class="predefined-type">String</span> author;
    <span class="directive">private</span> <span class="predefined-type">String</span> ISBN;
    <span class="directive">private</span> <span class="predefined-type">String</span> title;

    <span class="directive">public</span> <span class="predefined-type">Book</span>() {
    }

    <span class="directive">public</span> <span class="predefined-type">Book</span>(<span class="predefined-type">String</span> author, <span class="predefined-type">String</span> ISBN, <span class="predefined-type">String</span> title) {
        <span class="local-variable">this</span>.author = author;
        <span class="local-variable">this</span>.ISBN = ISBN;
        <span class="local-variable">this</span>.title = title;
    }

    <span class="annotation">@XmlElement</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getAuthor() {
        <span class="keyword">return</span> author;
    }

    <span class="directive">public</span> <span class="type">void</span> setAuthor(<span class="predefined-type">String</span> author) {
    <span class="local-variable">this</span>.author = author;
    }

    <span class="annotation">@XmlElement</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getISBN() {
        <span class="keyword">return</span> ISBN;
    }

    <span class="directive">public</span> <span class="type">void</span> setISBN(<span class="predefined-type">String</span> ISBN) {
        <span class="local-variable">this</span>.ISBN = ISBN;
    }

    <span class="annotation">@XmlAttribute</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getTitle() {
        <span class="keyword">return</span> title;
    }

    <span class="directive">public</span> <span class="type">void</span> setTitle(<span class="predefined-type">String</span> title) {
        <span class="local-variable">this</span>.title = title;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And we can write a method to use the above entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/test_json</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@GET</span>
<span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="directive">public</span> <span class="predefined-type">Book</span> test_json() {
    <span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>();
    book.setTitle(<span class="string"><span class="delimiter">&quot;</span><span class="content">EJB 3.0</span><span class="delimiter">&quot;</span></span>);
    book.setAuthor(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill Burke</span><span class="delimiter">&quot;</span></span>);
    book.setISBN(<span class="string"><span class="delimiter">&quot;</span><span class="content">596529260</span><span class="delimiter">&quot;</span></span>);
    <span class="keyword">return</span> book;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When making a requesting of the above method, the default Jackson2 marshaller would return JSON output that looked like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ http localhost:8080/dummy/test_json
HTTP/1.1 200
...
Content-Type: application/json

{
&quot;ISBN&quot;: &quot;596529260&quot;,
&quot;author&quot;: &quot;Bill Burke&quot;,
&quot;title&quot;: &quot;EJB 3.0&quot;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jakarta_xml_binding_fastinfoset_provider"><a class="anchor" href="#_jakarta_xml_binding_fastinfoset_provider"></a>22.5. Jakarta XML Binding + FastinfoSet provider</h3>
<div class="paragraph">
<p>RESTEasy supports the FastinfoSet mime type with Jakarta XML Binding annotated classes.
Fast infoset documents are faster to serialize and parse, and smaller in size, than logically equivalent XML documents.
Thus, fast infoset documents may be used whenever the size and processing time of XML documents is an issue.
It is configured the same way the provider is.</p>
</div>
<div class="paragraph">
<p>To use this integration with Fastinfoset import the resteasy-fastinfoset-provider Maven module.</p>
</div>
</div>
<div class="sect2">
<h3 id="_xml_bind_api_collections"><a class="anchor" href="#_xml_bind_api_collections"></a>22.6. Arrays and Collections of Jakarta XML Binding Objects</h3>
<div class="paragraph">
<p>RESTEasy will automatically marshal arrays, java.util.Set&#8217;s, and java.util.List&#8217;s of Jakarta XML Binding objects to and from XML, JSON, Fastinfoset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    <span class="annotation">@XmlElement</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="directive">public</span> Customer() {
    }

    <span class="directive">public</span> Customer(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyResource</span> {
    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">array</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> putCustomers(Customer<span class="type">[]</span> customers) {
        Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>, customers[<span class="integer">0</span>].getName());
        Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span>, customers[<span class="integer">1</span>].getName());
    }

    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">set</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Customer&gt; getCustomerSet() {
        <span class="keyword">return</span> <span class="predefined-type">Set</span>.of(<span class="keyword">new</span> Customer(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>), <span class="keyword">new</span> Customer(<span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span>));
    }

    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> putCustomers(<span class="predefined-type">List</span>&lt;Customer&gt; customers) {
        Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>, customers.get(<span class="integer">0</span>).getName());
        Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span>, customers.get(<span class="integer">1</span>).getName());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above resource can publish and receive Jakarta XML Binding objects.
It is assumed they are wrapped in a collection element</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;collection&gt;</span>
    <span class="tag">&lt;customer&gt;</span><span class="tag">&lt;name&gt;</span>bill<span class="tag">&lt;/name&gt;</span><span class="tag">&lt;/customer&gt;</span>
    <span class="tag">&lt;customer&gt;</span><span class="tag">&lt;name&gt;</span>monica<span class="tag">&lt;/name&gt;</span><span class="tag">&lt;/customer&gt;</span>
<span class="tag">&lt;collection&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The namespace URI, namespace tag, and collection element name can be changed by using the
<code>@org.jboss.resteasy.annotations.providers.jaxb.Wrapped</code> annotation on a parameter or method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.PARAMETER, <span class="predefined-type">ElementType</span>.METHOD})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Wrapped {
    <span class="predefined-type">String</span> element() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">collection</span><span class="delimiter">&quot;</span></span>;

    <span class="predefined-type">String</span> namespace() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">http://jboss.org/resteasy</span><span class="delimiter">&quot;</span></span>;

    <span class="predefined-type">String</span> prefix() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">resteasy</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To output this XML</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;foo:list</span> <span class="attribute-name">xmlns:foo</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jboss.org</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;customer&gt;</span><span class="tag">&lt;name&gt;</span>bill<span class="tag">&lt;/name&gt;</span><span class="tag">&lt;/customer&gt;</span>
    <span class="tag">&lt;customer&gt;</span><span class="tag">&lt;name&gt;</span>monica<span class="tag">&lt;/name&gt;</span><span class="tag">&lt;/customer&gt;</span>
<span class="tag">&lt;/foo:list&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Wrapped</code> annotation would be used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Wrapped</span>(element=<span class="string"><span class="delimiter">&quot;</span><span class="content">list</span><span class="delimiter">&quot;</span></span>, namespace=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jboss.org</span><span class="delimiter">&quot;</span></span>, prefix=<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">List</span>&lt;Customer&gt; getCustomerSet() {
    <span class="keyword">return</span> <span class="predefined-type">List</span>.of(<span class="keyword">new</span> Customer(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>), <span class="keyword">new</span> Customer(<span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span>));
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_collections_on_client"><a class="anchor" href="#_collections_on_client"></a>22.6.1. Retrieving Collections on the client side</h4>
<div class="paragraph">
<p>To retrieve a <code>List</code> or <code>Set</code> of Jakarta XML Binding objects on the client side, the element type returned in the List or Set must be identified.
Below the call to <code>readEntity()</code> will fail because the class type, Customer has not been properly identified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response response = request.get();
<span class="predefined-type">List</span>&lt;Customer&gt; list = response.readEntity(<span class="predefined-type">List</span>.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>jakarta.ws.rs.core.GenericType</code> to declare the data type,<code>Customer</code>, returned within the List.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response response = request.get();
GenericType&lt;<span class="predefined-type">List</span>&lt;Customer&gt;&gt; genericType = <span class="keyword">new</span> GenericType&lt;&gt;() {};
<span class="predefined-type">List</span>&lt;Customer&gt; list = response.readEntity(genericType);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about <code>GenericType</code>, please see its javadoc.</p>
</div>
<div class="paragraph">
<p>The same strategy applies to retrieving a <code>Set</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response response = request.get();
GenericType&lt;<span class="predefined-type">Set</span>&lt;Customer&gt;&gt; genericType = <span class="keyword">new</span> GenericType&lt;&gt;() {};
<span class="predefined-type">Set</span>&lt;Customer&gt; set = response.readEntity(genericType);</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>GenericType</code> is not necessary to retrieve an array of Jakarta XML Binding objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response response = request.get();
Customer<span class="type">[]</span> array = response.readEntity(Customer<span class="type">[]</span>.class);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_json_list"><a class="anchor" href="#_json_list"></a>22.6.2. JSON and Jakarta XML Binding Collections/arrays</h4>
<div class="paragraph">
<p>RESTEasy supports using collections with JSON.
It encloses List, Set, or arrays of returned XML objects within a simple JSON array.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Foo</span> {
    <span class="annotation">@XmlAttribute</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> test;

    <span class="directive">public</span> Foo() {
    }

    <span class="directive">public</span> Foo(<span class="predefined-type">String</span> test) {
        <span class="local-variable">this</span>.test = test;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getTest() {
        <span class="keyword">return</span> test;
    }

    <span class="directive">public</span> <span class="type">void</span> setTest(<span class="predefined-type">String</span> test) {
        <span class="local-variable">this</span>.test = test;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A List or array of Foo class would be represented in JSON like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[{<span class="key"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">@test</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>}},{<span class="key"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">@test</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">monica}</span><span class="delimiter">&quot;</span></span>}}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>It also expects this format for input</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xml_map"><a class="anchor" href="#_xml_map"></a>22.7. Maps of XML Objects</h3>
<div class="paragraph">
<p>RESTEasy automatically marshals maps of Jakarta XML Binding objects to and from XML, JSON, Fastinfoset (or any other new Jakarta XML Binding mapper).
The parameter or method return type must be a generic with a String as the key and the Jakarta XML Binding object&#8217;s type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(namespace = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://foo.com</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Foo</span> {
    <span class="annotation">@XmlAttribute</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="directive">public</span> Foo() {
    }

    <span class="directive">public</span> Foo(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/map</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MyResource</span> {
    <span class="annotation">@POST</span>
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Foo&gt; post(<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Foo&gt; map) {
        Assertions.assertEquals(<span class="integer">2</span>, map.size());
        Assertions.assertNotNull(map.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>));
        Assertions.assertNotNull(map.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span>));
        Assertions.assertEquals(map.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>).getName(), <span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>);
        Assertions.assertEquals(map.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span>).getName(), <span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> map;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above resource can publish and receive XML objects within a map.
By default, they are wrapped in a "map" element in the default namespace.
Also, each "map" element has zero or more "entry" elements with a "key" attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;map&gt;</span>
    <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://foo.com</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;foo</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/entry&gt;</span>
    <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://foo.com</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;foo</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">monica</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/entry&gt;</span>
<span class="tag">&lt;/map&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The namespace URI, namespace prefix and map, entry, and key element and attribute names can be changed by using the
<code>@org.jboss.resteasy.annotations.providers.jaxb.WrappedMap</code> annotation on a parameter or method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.PARAMETER, <span class="predefined-type">ElementType</span>.METHOD})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> WrappedMap {
    <span class="comment">/**
     * map element name
     */</span>
    <span class="predefined-type">String</span> map() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">map</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * entry element name *
     */</span>
    <span class="predefined-type">String</span> entry() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">entry</span><span class="delimiter">&quot;</span></span>;

    <span class="comment">/**
     * entry's key attribute name
     */</span>
    <span class="predefined-type">String</span> key() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>;

    <span class="predefined-type">String</span> namespace() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;

    <span class="predefined-type">String</span> prefix() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To output this XML</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;hashmap&gt;</span>
    <span class="tag">&lt;hashentry</span> <span class="attribute-name">hashkey</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:foo</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://foo.com</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;foo:foo</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/hashentry&gt;</span>
<span class="tag">&lt;/map&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the <code>@WrappedMap</code> annotation as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/map</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MyResource</span> {
    <span class="annotation">@GET</span>
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@WrappedMap</span>(map=<span class="string"><span class="delimiter">&quot;</span><span class="content">hashmap</span><span class="delimiter">&quot;</span></span>, entry=<span class="string"><span class="delimiter">&quot;</span><span class="content">hashentry</span><span class="delimiter">&quot;</span></span>, key=<span class="string"><span class="delimiter">&quot;</span><span class="content">hashkey</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Foo&gt; get() {
        <span class="keyword">return</span> <span class="predefined-type">Map</span>.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> Foo(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>));
    }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_maps_client_side"><a class="anchor" href="#_maps_client_side"></a>22.7.1. Retrieving Maps on the client side</h4>
<div class="paragraph">
<p>To retrieve a <code>Map</code> of XML objects on the client side, the element types returned in the Map must be identified.
Below the call to <code>readEntity()</code> will fail because the class types, String and Customer have not been properly identified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response response = request.get();
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Customer&gt; map = response.readEntity(<span class="predefined-type">Map</span>.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>jakarta.ws.rs.core.GenericType</code> to declare the data types, <code>String</code> and <code>Customer</code>, returned within the Map.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response response = request.get();
GenericType&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Customer&gt; genericType = <span class="keyword">new</span> GenericType&lt;&gt;() {};
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Customer&gt; map = response.readEntity(genericType);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about <code>GenericType</code>, please see its javadoc.</p>
</div>
</div>
<div class="sect3">
<h4 id="_json_map"><a class="anchor" href="#_json_map"></a>22.7.2. JSON and XML maps</h4>
<div class="paragraph">
<p>RESTEasy supports using maps with JSON.
It encloses maps returned XML objects within a simple JSON map.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Foo</span> {
    <span class="annotation">@XmlAttribute</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> test;

    <span class="directive">public</span> Foo() {
    }

    <span class="directive">public</span> Foo(<span class="predefined-type">String</span> test) {
        <span class="local-variable">this</span>.test = test;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getTest() {
        <span class="keyword">return</span> test;
    }

    <span class="directive">public</span> <span class="type">void</span> setTest(<span class="predefined-type">String</span> test) {
        <span class="local-variable">this</span>.test = test;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A List or array of this Foo class would be represented in JSON like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{ <span class="key"><span class="delimiter">&quot;</span><span class="content">entry1</span><span class="delimiter">&quot;</span></span> : {<span class="key"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">@test</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>}}, <span class="key"><span class="delimiter">&quot;</span><span class="content">entry2</span><span class="delimiter">&quot;</span></span> : {<span class="key"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">@test</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">monica}</span><span class="delimiter">&quot;</span></span>}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It also expects this format for input</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xml_bind_interfaces"><a class="anchor" href="#_xml_bind_interfaces"></a>22.8. Interfaces, Abstract Classes, and Jakarta XML Binding</h3>
<div class="paragraph">
<p>Some objects models use abstract classes and interfaces heavily.
Unfortunately, Jakarta XML Binding doesn&#8217;t work with interfaces that are root elements and RESTEasy can&#8217;t unmarshal parameters that are interfaces or raw abstract classes because it doesn&#8217;t have enough information to create a JAXBContext.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">IFoo</span> {}

<span class="annotation">@XmlRootElement</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RealFoo</span> <span class="directive">implements</span> IFoo {}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/xml</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyResource</span> {

    <span class="annotation">@PUT</span>
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> put(IFoo foo) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, RESTEasy will report error, "Cannot find a MessageBodyReader for&#8230;&#8203;".
This is because RESTEasy does not know that implementations of IFoo are  Jakarta XML Binding classes and doesn&#8217;t know how to create a JAXBContext for it.
As a workaround, RESTEasy allows the use of Jakarta XML Binding annotation @XmlSeeAlso on the interface to correct the problem.
(NOTE, this will not work with manual, hand-coded ).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlSeeAlso</span>(RealFoo.class)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">IFoo</span> {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The extra @XmlSeeAlso on IFoo allows RESTEasy to create a JAXBContext that knows how to unmarshal RealFoo instances.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_jakarta_xml_binding_marshalling"><a class="anchor" href="#_configuring_jakarta_xml_binding_marshalling"></a>22.9. Configuring Jakarta XML Binding Marshalling</h3>
<div class="paragraph">
<p>As a consumer of XML datasets, Jakarta XML Binding is subject to a form of attack known as the XXE (Xml eXternal Entity) Attack (<a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing" class="bare">https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing</a>), in which expanding an external entity causes an unsafe file to be loaded.
Preventing the expansion of external entities is discussed in <a href="#_configuring_document_marshalling">Configuring Document Marshalling</a>.
The same parameter, <code>resteasy.document.expand.entity.references</code></p>
</div>
<div class="paragraph">
<p>applies to Jakarta XML Binding unmarshallers.</p>
</div>
<div class="paragraph">
<p><a href="#_configuring_document_marshalling">Configuring Document Marshalling</a> also discusses the prohibition of DTDs and the imposition of limits on entity expansion and the number of attributes per element.
The parameters <code>resteasy.document.secure.disableDTDs</code> and <code>resteasy.document.secure.processing.feature</code> discussed there,
and their default values, also apply to the representation of Jakarta XML Binding objects.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_atom"><a class="anchor" href="#_atom"></a>23. RESTEasy Atom Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From W3.org (<a href="http://tools.ietf.org/html/rfc4287" class="bare">http://tools.ietf.org/html/rfc4287</a>):</p>
</div>
<div class="paragraph">
<p>"Atom is an XML-based document format that describes lists of related information known as "feeds". Feeds are composed of a number of items, known as "entries", each with an extensible set of attached metadata.
For example, each entry has a title.
The primary use case that Atom addresses is the syndication of Web content such as weblogs and news headlines to Websites as well as directly to user agents."</p>
</div>
<div class="sect2">
<h3 id="_resteasy_atom"><a class="anchor" href="#_resteasy_atom"></a>23.1. RESTEasy Atom API and Provider</h3>
<div class="paragraph">
<p>RESTEasy has defined a simple object model in Java to represent Atom and uses Jakarta XML Binding to marshal and unmarshal it.
The main classes are in the <code>org.jboss.resteasy.plugins.providers.atom</code> package and are <code>Feed</code>, <code>Entry</code>, <code>Content</code>, and <code>Link</code>.
If you look at the source, you will see that these are annotated with Jakarta XML Binding annotations.
The distribution contains the javadocs for this project and are a must to learn the model.
Here is a simple example of sending an atom feed using the RESTEasy API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.plugins.providers.atom.Content</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.plugins.providers.atom.Entry</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.plugins.providers.atom.Feed</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.plugins.providers.atom.Link</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.plugins.providers.atom.Person</span>;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">atom</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyAtomService</span> {
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">feed</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/atom+xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Feed getFeed() {
        Feed feed = <span class="keyword">new</span> Feed();
        feed.setId(<span class="keyword">new</span> <span class="predefined-type">URI</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://example.com/42</span><span class="delimiter">&quot;</span></span>));
        feed.setTitle(<span class="string"><span class="delimiter">&quot;</span><span class="content">My Feed</span><span class="delimiter">&quot;</span></span>);
        feed.setUpdated(<span class="keyword">new</span> <span class="predefined-type">Date</span>());
        Link link = <span class="keyword">new</span> Link();
        link.setHref(<span class="keyword">new</span> <span class="predefined-type">URI</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost</span><span class="delimiter">&quot;</span></span>));
        link.setRel(<span class="string"><span class="delimiter">&quot;</span><span class="content">edit</span><span class="delimiter">&quot;</span></span>);
        feed.getLinks().add(link);
        feed.getAuthors().add(<span class="keyword">new</span> Person(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill Burke</span><span class="delimiter">&quot;</span></span>));
        Entry entry = <span class="keyword">new</span> Entry();
        entry.setTitle(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>);
        Content content = <span class="keyword">new</span> Content();
        content.setType(MediaType.TEXT_HTML_TYPE);
        content.setText(<span class="string"><span class="delimiter">&quot;</span><span class="content">Nothing much</span><span class="delimiter">&quot;</span></span>);
        entry.setContent(content);
        feed.getEntries().add(entry);
        <span class="keyword">return</span> feed;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>RESTEasy&#8217;s atom provider is Jakarta XML Binding based, there are no limits to sending atom objects using XML.
All the other Jakarta XML Binding providers that RESTEasy has like JSON and fastinfoset can automatically be re-use.
Just add "atom+" in front of the main subtype.
i.e.
s</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/atom+json</span><span class="delimiter">&quot;</span></span>) or <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/atom+fastinfoset</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xml_bind_api_atom"><a class="anchor" href="#_xml_bind_api_atom"></a>23.2. Using Jakarta XML Binding with the Atom Provider</h3>
<div class="paragraph">
<p>The <code>org.jboss.resteasy.plugins.providers.atom.Content</code> class is used to unmarshal and marshal Jakarta XML Binding
annotated objects that are the body of the content. Here&#8217;s an example of sending an <code>Entry</code> with a Customer object
attached as the body of the entry&#8217;s content.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(namespace = <span class="string"><span class="delimiter">&quot;</span><span class="content">https://jboss.org/Customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    <span class="annotation">@XmlElement</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> name;

    <span class="directive">public</span> Customer() {
    }

    <span class="directive">public</span> Customer(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">atom</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">AtomServer</span> {
    <span class="annotation">@GET</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">entry</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/atom+xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Entry getEntry() {
        Entry entry = <span class="keyword">new</span> Entry();
        entry.setTitle(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>);
        Content content = <span class="keyword">new</span> Content();
        content.setJAXBObject(<span class="keyword">new</span> Customer(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>));
        entry.setContent(content);
        <span class="keyword">return</span> entry;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Content.setJAXBObject()</code> method is used to tell the content object, an object is being sent back and it is to be marshalled appropriately.
If using a different base format than XML, i.e.
"application/atom+json", this attached object will be marshalled into that same format.</p>
</div>
<div class="paragraph">
<p>If the input is an atom document, Jakarta XML Binding objects can be extracted from Content using the <code>Content.getJAXBObject(Class&lt;?&gt; clazz)</code> method.
Here is an example of an input atom document and extracting a Customer object from the content.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">atom</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">AtomServer</span> {
    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">entry</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/atom+xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> putCustomer(Entry entry) {
        Content content = entry.getContent();
        Customer cust = content.getJAXBObject(Customer.class);
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_json"><a class="anchor" href="#_json"></a>24. JSON Support via Jackson</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy supports integration with the Jackson project.
For more on Jackson 2, see <a href="https://github.com/FasterXML/jackson-databind/wiki" class="bare">https://github.com/FasterXML/jackson-databind/wiki</a>.
Besides having Jakarta XML Binding like APIs, it has a JavaBean based model, described at
<a href="https://github.com/FasterXML/jackson-databind/wiki/Databind-annotations" class="bare">https://github.com/FasterXML/jackson-databind/wiki/Databind-annotations</a>, which allows the marshalling of Java objects to
and from JSON. RESTEasy integrates with the JavaBean model. While Jackson does come with its own Jakarta RESTful Web Services
integration, RESTEasy expanded it a little, as described below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As of RESTEasy 6.2.11.Final a default <code>com.fasterxml.jackson.databind.ObjectMapper</code> is created if there is <strong>not</strong>
a <code>jakarta.ws.rs.ext.ContextResolver</code> for the <code>ObjectMapper</code>. This can be disabled with the configuration parameter
<code>dev.resteasy.provider.jackson.disable.default.object.mapper</code> set to <code>true</code>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_using_jackson_2_outside_of_wildfly"><a class="anchor" href="#_using_jackson_2_outside_of_wildfly"></a>24.1. Using Jackson 2 Outside of WildFly</h3>
<div class="paragraph">
<p>If deploying RESTEasy outside WildFly, add the RESTEasy Jackson provider to the pom.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
   <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
   <span class="tag">&lt;artifactId&gt;</span>resteasy-jackson2-provider<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jakarta_xml_binding_annotations"><a class="anchor" href="#_jakarta_xml_binding_annotations"></a>24.2. Jakarta XML Binding Annotations</h3>
<div class="paragraph">
<p>In Jackson 2.13+ <code>com.fasterxml.jackson.module.jakarta.xmlbind.JakartaXmlBindAnnotationModule</code> must be registered in
order to use XML binding annotations for Jackson to marshall/unmarshall them in JSON. To do this,
<code>com.fasterxml.jackson.databind.ObjectMapper</code> must be provided via an implementation of <code>jakarta.ws.rs.ext.ContextResolver</code>.</p>
</div>
<div class="paragraph">
<p>An example <code>jakarta.ws.rs.ext.ContextResolver</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Provider</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ObjectMapperProvider</span> <span class="directive">implements</span> ContextResolver&lt;ObjectMapper&gt; {
    <span class="directive">static</span> <span class="directive">final</span> JsonMapper MAPPER = JsonMapper.builder()
            .addModule(<span class="keyword">new</span> JakartaXmlBindAnnotationModule())
            .build();

    <span class="annotation">@Override</span>
    <span class="directive">public</span> ObjectMapper getContext(<span class="directive">final</span> <span class="predefined-type">Class</span>&lt;?&gt; type) {
        <span class="keyword">return</span> MAPPER;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_additional_resteasy_specifics"><a class="anchor" href="#_additional_resteasy_specifics"></a>24.3. Additional RESTEasy Specifics</h3>
<div class="paragraph">
<p>RESTEasy added support for "application/*+json". Jackson supports "application/json" and "text/json" as valid media types.
This allows the creation of json-based media types and still lets Jackson perform the marshalling.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/customers</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyService</span> {

    <span class="annotation">@GET</span>
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.customer+json</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Customer<span class="type">[]</span> getCustomers() {}
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jsonp_support"><a class="anchor" href="#_jsonp_support"></a>24.4. JSONP Support</h3>
<div class="paragraph">
<p>RESTEasy supports <a href="http://en.wikipedia.org/wiki/JSONP">JSONP</a>.
It can be enabled by adding provider <code>org.jboss.resteasy.plugins.providers.jackson.Jackson2JsonpInterceptor</code> to the deployment.
Jackson and JSONP can be used together.
If the media type of the response is json and a callback query parameter is given, the response will be a JavaScript snippet with a method call of the method defined by the callback parameter.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>GET /resources/stuff?callback=processStuffResponse</code></pre>
</div>
</div>
<div class="paragraph">
<p>will produce this response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>processStuffResponse(nomal JSON body)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This supports the default behavior of <a href="http://api.jquery.com/jQuery.ajax/">jQuery</a>.
To enable Jackson2JsonpInterceptor in WildFly, annotations must be imported from the <code>org.jboss.resteasy.resteasy-jackson2-provider</code> module.
To do that a <code>jboss-deployment-structure.xml</code> file must be added to the application&#8217;s WAR:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jboss-deployment-structure&gt;</span>
  <span class="tag">&lt;deployment&gt;</span>
    <span class="tag">&lt;dependencies&gt;</span>
      <span class="tag">&lt;module</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.resteasy-jackson2-provider</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">annotations</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/dependencies&gt;</span>
  <span class="tag">&lt;/deployment&gt;</span>
<span class="tag">&lt;/jboss-deployment-structure&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the callback parameter can be changed by setting the <code>callbackQueryParameter</code> property.</p>
</div>
<div class="paragraph">
<p><code>Jackson2JsonpInterceptor</code> can wrap the response into a try-catch block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>try{processStuffResponse(normal JSON body)}catch(e){}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This feature can be enabled by setting the resteasy.jsonp.silent property to true</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because JSONP can be used in <strong>Cross Site Scripting Inclusion (XSSI) attacks</strong>, <code>Jackson2JsonpInterceptor</code> is disabled by default.
Two steps are necessary to enable it:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>As noted above, <code>Jackson2JsonpInterceptor</code> must be included in the deployment. For example, a service file
<code>META-INF/services/jakarta.ws.rs.ext.Providers</code> with the line</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>org.jboss.resteasy.plugins.providers.jackson.Jackson2JsonpInterceptor</code></pre>
</div>
</div>
<div class="paragraph">
<p>may be included on the classpath</p>
</div>
</li>
<li>
<p>Parameter "resteasy.jsonp.enable" must be set to "true". [See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.]</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_jackson_json_decorator"><a class="anchor" href="#_jackson_json_decorator"></a>24.5. Jackson JSON Decorator</h3>
<div class="paragraph">
<p>If using the Jackson 2 provider, RESTEasy has provided a pretty-printing annotation similar with the one in Jakarta XML Binding provider:
<code>org.jboss.resteasy.annotations.providers.jackson.Formatted</code></p>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/formatted/{id}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Formatted</span>
<span class="directive">public</span> Product getFormattedProduct() {
    <span class="keyword">return</span> <span class="keyword">new</span> Product(<span class="integer">333</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">robot</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the example shown above, the @Formatted annotation will enable the underlying Jackson option <code>SerializationFeature.INDENT_OUTPUT</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_json_filter_support"><a class="anchor" href="#_json_filter_support"></a>24.6. JSON Filter Support</h3>
<div class="paragraph">
<p>Jackson2 provides annotation, <a href="http://fasterxml.github.io/jackson-annotations/javadoc/2.13/com/fasterxml/jackson/annotation/JsonFilter.html">JsonFilter</a>.
<code>@JsonFilter</code> is used to apply filtering during serialization/de-serialization for example which properties are to be used or not.
Here is an example which defines mapping from "nameFilter" to filter instances and filter bean properties when serialized to json format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@JsonFilter</span>(value=<span class="string"><span class="delimiter">&quot;</span><span class="content">nameFilter</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Jackson2Product</span> {
    <span class="directive">protected</span> <span class="predefined-type">String</span> name;
    <span class="directive">protected</span> <span class="type">int</span> id;
    <span class="directive">public</span> Jackson2Product() {
    }
    <span class="directive">public</span> Jackson2Product(<span class="directive">final</span> <span class="type">int</span> id, <span class="directive">final</span> <span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.id = id;
        <span class="local-variable">this</span>.name = name;
    }
    <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
        <span class="keyword">return</span> name;
    }
    <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) {
        <span class="local-variable">this</span>.name = name;
    }
    <span class="directive">public</span> <span class="type">int</span> getId() {
        <span class="keyword">return</span> id;
    }
    <span class="directive">public</span> <span class="type">void</span> setId(<span class="type">int</span> id) {
        <span class="local-variable">this</span>.id = id;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@JsonFilter</code> annotates a resource class to filter out some property not to be serialized in the json response.
To map the filter id and instance we need to create another Jackson class to add the id and filter instance map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ObjectFilterModifier</span> <span class="directive">extends</span> ObjectWriterModifier {
    <span class="directive">public</span> ObjectFilterModifier() {
    }
    <span class="annotation">@Override</span>
    <span class="directive">public</span> ObjectWriter modify(EndpointConfigBase&lt;?&gt; endpoint,
            MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; httpHeaders, <span class="predefined-type">Object</span> valueToWrite,
            ObjectWriter w, JsonGenerator jg) <span class="directive">throws</span> <span class="exception">IOException</span> {

        FilterProvider filterProvider = <span class="keyword">new</span> SimpleFilterProvider().addFilter(
                <span class="string"><span class="delimiter">&quot;</span><span class="content">nameFilter</span><span class="delimiter">&quot;</span></span>,
                SimpleBeanPropertyFilter.filterOutAllExcept(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>));
        <span class="keyword">return</span> w.with(filterProvider);

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the method <code>modify()</code> takes care of filtering all properties except "name" property before a write.
To make this work, the mapping information must be accessible to RESTEasy.
This can be made available through a WriterInterceptor that uses Jackson&#8217;s <code>ObjectWriterInjector</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Provider</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">JsonFilterWriteInterceptor</span> <span class="directive">implements</span> WriterInterceptor{

    <span class="directive">private</span> ObjectFilterModifier modifier = <span class="keyword">new</span> ObjectFilterModifier();
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> aroundWriteTo(WriterInterceptorContext context)
            <span class="directive">throws</span> <span class="exception">IOException</span>, WebApplicationException {
        <span class="comment">//set a threadlocal modifier</span>
        ObjectWriterInjector.set(modifier);
        context.proceed();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, Jackson&#8217;s documentation suggest doing the same in a servlet filter; that however potentially leads to issues in RESTEasy.
The ObjectFilterModifier is stored using a ThreadLocal object and there&#8217;s no guarantee the same thread serving the servlet filter will be running the resource endpoint execution.
For the servlet filter scenario, RESTEasy offers its own injector that relies on the current thread context classloader for carrying the specified modifier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ObjectWriterModifierFilter</span> <span class="directive">implements</span> <span class="predefined-type">Filter</span> {
    <span class="directive">private</span> <span class="directive">static</span> ObjectFilterModifier modifier = <span class="keyword">new</span> ObjectFilterModifier();

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> init(FilterConfig filterConfig) <span class="directive">throws</span> ServletException {
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) <span class="directive">throws</span> <span class="exception">IOException</span>, ServletException {
        ResteasyObjectWriterInjector.set(<span class="predefined-type">Thread</span>.currentThread().getContextClassLoader(), modifier);
        chain.doFilter(request, response);
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> destroy() {
    }

}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_polymorphic_typing_deserialization"><a class="anchor" href="#_polymorphic_typing_deserialization"></a>25. Polymorphic Typing deserialization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Due to numerous CVEs for a specific kind of Polymorphic Deserialization (see details in FasterXML Jackson documentation), starting from Jackson 2.10 users have a means to allow only specified classes to be deserialized.
RESTEasy enables this feature by default.
It allows controlling the content of the whitelist of allowed classes/packages.</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">resteasy.jackson.deserialization.whitelist.allowIfBaseType.prefix</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method for appending a matcher that will allow all subtypes in cases where nominal base type&#8217;s class name starts with specific prefix. "*" can be used for allowing any class.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy.jackson.deserialization.whitelist.allowIfSubType.prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method for appending a matcher that will allow specific subtype (regardless of declared base type) in cases where subclass name starts with specified prefix. "*" can be used for allowing any class.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_json_p"><a class="anchor" href="#_json_p"></a>26. JSON Support via Jakarta EE JSON-P API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JSON-P is a Jakarta EE parsing API. RESTEasy provides an archive for it. It has support for <code>JsonObject</code>, <code>JsonArray</code>,
and <code>JsonStructure</code> as request or response entities. It should not conflict with Jackson if it is on the classpath too.
RESTEasy&#8217;s provider is provided by default in WildFly. If using another server, use this maven dependency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
   <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
   <span class="tag">&lt;artifactId&gt;</span>resteasy-json-p-provider<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multipart"><a class="anchor" href="#_multipart"></a>27. Multipart Providers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy has rich support for the "multipart/*" and "multipart/form-data" mime types.
The multipart mime format is used to pass lists of content bodies.
Multiple content bodies are embedded in one message.
"multipart/form-data" is often found in web application HTML Form documents and is generally used to upload files.
The form-data format is the same as other multipart formats, except that each inlined piece of content has a name associated with it.</p>
</div>
<div class="paragraph">
<p>RESTEasy provides a custom API for reading and writing multipart types as well as marshalling arbitrary List (for any multipart type) and Map (multipart/form-data only) objects</p>
</div>
<div class="paragraph">
<p>Classes <code>MultipartInput</code> and <code>MultipartOutput</code> provide read and write support for mime type "multipart/mixed" messages respectively.
They provide for multiple part messages, in which one or more different sets of data are combined in a single body.</p>
</div>
<div class="paragraph">
<p><code>MultipartRelatedInput</code> and <code>MultipartRelatedOutput</code> classes provide read and write support for mime type "multipart/related" messages.
These are messages that contain multiple body parts that are inter-related.</p>
</div>
<div class="paragraph">
<p><code>MultipartFormDataInput</code> and <code>MultipartFormDataOutput</code> classes provide read and write support for mine type "multipart/form-data".  This type is used when returning a set of values as the the result of a user filling out a form or for uploading files.</p>
</div>
<div class="sect2">
<h3 id="_multipart_mixed_group"><a class="anchor" href="#_multipart_mixed_group"></a>27.1. Multipart/mixed</h3>
<div class="sect3">
<h4 id="_multipart_output"><a class="anchor" href="#_multipart_output"></a>27.1.1. Writing multipart/mixed messages</h4>
<div class="paragraph">
<p><code>MultipartOutput</code> provides a set of addPart methods for registering message content and specifying special marshalling requirements.
In all cases the addPart methods require an input parameter, Object and a MediaType that declares the mime type of the object.
Sometimes there may be an object in which marshalling is sensitive to generic type metadata.
In such cases, use an addPart method in which you declare the GenericType of the entity Object.
Perhaps a file will be passed as content and it will require UTF-8 encoding.
Setting input parameter, utf8Encode to <code>true</code> will indicate to RESTEasy to process the filename according to the character set and language encoding rules of <code>rfc5987</code>.
This flag is only processed when mime type "multipart/form-data" is specified.</p>
</div>
<div class="paragraph">
<p><code>MultipartOutput</code> automatically generates a unique message boundary identifier when it is created.
Method setBoundary is provided to declare a different identifier.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MultipartOutput</span> {
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, MediaType mediaType);
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, MediaType mediaType,
        <span class="predefined-type">String</span> filename);
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, MediaType mediaType,
        <span class="predefined-type">String</span> filename, <span class="type">boolean</span> utf8Encode);
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, GenericType&lt;?&gt; type,
        MediaType mediaType);
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, GenericType&lt;?&gt; type,
        MediaType mediaType, <span class="predefined-type">String</span> filename);
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, GenericType&lt;?&gt; type,
        MediaType mediaType, <span class="predefined-type">String</span> filename, <span class="type">boolean</span> utf8Encode);
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, <span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Type</span> genericType,
        MediaType mediaType);
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, <span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Type</span> genericType,
        MediaType mediaType, <span class="predefined-type">String</span> filename);
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, <span class="predefined-type">Class</span>&lt;?&gt; type, <span class="predefined-type">Type</span> genericType,
        MediaType mediaType, <span class="predefined-type">String</span> filename, <span class="type">boolean</span> utf8Encode);
   <span class="directive">public</span> <span class="predefined-type">List</span>&lt;OutputPart&gt; getParts();
   <span class="directive">public</span> <span class="predefined-type">String</span> getBoundary();
   <span class="directive">public</span> <span class="type">void</span> setBoundary(<span class="predefined-type">String</span> boundary);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each message part registered with <code>MultipartOutput</code> is represented by an <code>OutputPart</code> object.
Class <code>MultipartOutput</code> generates an <code>OutputPart</code> object for each addPart method call.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">OutputPart</span> {
   <span class="directive">public</span> OutputPart(<span class="directive">final</span> <span class="predefined-type">Object</span> entity, <span class="directive">final</span> <span class="predefined-type">Class</span>&lt;?&gt; type,
        <span class="directive">final</span> <span class="predefined-type">Type</span> genericType, <span class="directive">final</span> MediaType mediaType);
   <span class="directive">public</span> OutputPart(<span class="directive">final</span> <span class="predefined-type">Object</span> entity, <span class="directive">final</span> <span class="predefined-type">Class</span>&lt;?&gt; type,
        <span class="directive">final</span> <span class="predefined-type">Type</span> genericType, <span class="directive">final</span> MediaType mediaType,
        <span class="directive">final</span> <span class="predefined-type">String</span> filename);
   <span class="directive">public</span> OutputPart(<span class="directive">final</span> <span class="predefined-type">Object</span> entity, <span class="directive">final</span> <span class="predefined-type">Class</span>&lt;?&gt; type,
        <span class="directive">final</span> <span class="predefined-type">Type</span> genericType, <span class="directive">final</span> MediaType mediaType,
        <span class="directive">final</span> <span class="predefined-type">String</span> filename, <span class="directive">final</span> <span class="type">boolean</span> utf8Encode);
   <span class="directive">public</span> MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; getHeaders();
   <span class="directive">public</span> <span class="predefined-type">Object</span> getEntity();
   <span class="directive">public</span> <span class="predefined-type">Class</span>&lt;?&gt; getType();
   <span class="directive">public</span> <span class="predefined-type">Type</span> getGenericType();
   <span class="directive">public</span> MediaType getMediaType();
   <span class="directive">public</span> <span class="predefined-type">String</span> getFilename();
   <span class="directive">public</span> <span class="type">boolean</span> isUtf8Encode();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multipartinput"><a class="anchor" href="#_multipartinput"></a>27.1.2. Reading multipart/mixed messages</h4>
<div class="paragraph">
<p><code>MultipartInput</code> and <code>InputPart</code> are interface classes that provide access to multipart/mixed message data.
RESTEasy provides an implementation of these classes.
They perform the work to retrieve message data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.plugins.providers.multipart</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="directive">public</span> <span class="type">interface</span> <span class="class">MultipartInput</span> {
   <span class="predefined-type">List</span>&lt;InputPart&gt; getParts();
   <span class="predefined-type">String</span> getPreamble();
   <span class="comment">/**
    * Call this method to delete any temporary files created from unmarshalling
    * this multipart message
    * Otherwise they will be deleted on Garbage Collection or JVM exit.
    */</span>
   <span class="type">void</span> close();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.plugins.providers.multipart</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.GenericType</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MultivaluedMap</span>;
<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.lang.reflect.Type</span>;

<span class="comment">/**
 * Represents one part of a multipart message.
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">InputPart</span> {
   <span class="comment">/**
    * If no content-type header is sent in a multipart message part
    * &quot;text/plain; charset=ISO-8859-1&quot; is assumed.
    *
    * This can be overwritten by setting a different String value in
    * {@link org.jboss.resteasy.spi.HttpRequest#setAttribute(String, Object)}
    * with this (&quot;resteasy.provider.multipart.inputpart.defaultContentType&quot;)
    * String as key. It should be done in a
    * {@link jakarta.ws.rs.container.ContainerRequestFilter}.
    */</span>
   <span class="predefined-type">String</span> DEFAULT_CONTENT_TYPE_PROPERTY =
    <span class="string"><span class="delimiter">&quot;</span><span class="content">resteasy.provider.multipart.inputpart.defaultContentType</span><span class="delimiter">&quot;</span></span>;

   <span class="comment">/**
    * If there is a content-type header without a charset parameter,
    * charset=US-ASCII is assumed.
    *
    * This can be overwritten by setting a different String value in
    * {@link org.jboss.resteasy.spi.HttpRequest#setAttribute(String, Object)}
    * with this (&quot;resteasy.provider.multipart.inputpart.defaultCharset&quot;)
    * String as key. It should be done in a
    * {@link jakarta.ws.rs.container.ContainerRequestFilter}.
    */</span>
   <span class="predefined-type">String</span> DEFAULT_CHARSET_PROPERTY =
    <span class="string"><span class="delimiter">&quot;</span><span class="content">resteasy.provider.multipart.inputpart.defaultCharset</span><span class="delimiter">&quot;</span></span>;

   <span class="comment">/**
    * @return headers of this part
    */</span>
   MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getHeaders();
   <span class="predefined-type">String</span> getBodyAsString() <span class="directive">throws</span> <span class="exception">IOException</span>;
   &lt;T&gt; T getBody(<span class="predefined-type">Class</span>&lt;T&gt; type, <span class="predefined-type">Type</span> genericType) <span class="directive">throws</span> <span class="exception">IOException</span>;
   &lt;T&gt; T getBody(GenericType&lt;T&gt; type) <span class="directive">throws</span> <span class="exception">IOException</span>;

   <span class="comment">/**
    * @return &quot;Content-Type&quot; of this part
    */</span>
   MediaType getMediaType();

   <span class="comment">/**
    * @return true if the Content-Type was resolved from the message, false if
    *         it was resolved from the server default
    */</span>
   <span class="type">boolean</span> isContentTypeFromMessage();

   <span class="comment">/**
    * Change the media type of the body part before you extract it.
    * Useful for specifying a charset.
    * @param mediaType media type
    */</span>
   <span class="type">void</span> setMediaType(MediaType mediaType);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_simple_mulitpart_message_example"><a class="anchor" href="#_simple_mulitpart_message_example"></a>27.1.3. Simple multipart/mixed message example</h4>
<div class="paragraph">
<p>The following example shows how to read and write a simple multipart/mixed message.</p>
</div>
<div class="paragraph">
<p>The data to be transferred is a very simple class, Soup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.test.providers.multipart.resource</span>;

<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlAccessType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlAccessorType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlRootElement</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlElement</span>;

<span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">soup</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Soup</span> {
    <span class="annotation">@XmlElement</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> id;

    <span class="directive">public</span> Soup(){}
    <span class="directive">public</span> Soup(<span class="directive">final</span> <span class="predefined-type">String</span> id){<span class="local-variable">this</span>.id = id;}
    <span class="directive">public</span> <span class="predefined-type">String</span> getId(){<span class="keyword">return</span> id;}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code fragment creates a multipart/mixed message passing Soup information using class, <code>MultipartOutput</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">MultipartOutput multipartOutput = <span class="keyword">new</span> MultipartOutput();
multipartOutput.addPart(<span class="keyword">new</span> Soup(<span class="string"><span class="delimiter">&quot;</span><span class="content">Chicken Noodle</span><span class="delimiter">&quot;</span></span>),
    MediaType.APPLICATION_XML_TYPE);
multipartOutput.addPart(<span class="keyword">new</span> Soup(<span class="string"><span class="delimiter">&quot;</span><span class="content">Vegetable</span><span class="delimiter">&quot;</span></span>),
    MediaType.APPLICATION_XML_TYPE);
multipartOutput.addPart(<span class="string"><span class="delimiter">&quot;</span><span class="content">Granny's Soups</span><span class="delimiter">&quot;</span></span>, MediaType.TEXT_PLAIN_TYPE);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code fragment uses class <code>MultipartInput</code> to extract the Soup information provided by multipartOutput above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    <span class="comment">// MultipartInput, the entity returned in the client in a</span>
    <span class="comment">// Response object or the input value of an endpoint method parameter.</span>
    <span class="keyword">for</span> (InputPart inputPart : multipartInput.getParts()) {
        <span class="keyword">if</span> (MediaType.APPLICATION_XML_TYPE.equals(inputPart.getMediaType())) {
          Soup c = inputPart.getBody(Soup.class, <span class="predefined-constant">null</span>);
          <span class="predefined-type">String</span> name = c.getId();
        } <span class="keyword">else</span> {
          <span class="predefined-type">String</span> s = inputPart.getBody(<span class="predefined-type">String</span>.class, <span class="predefined-constant">null</span>);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returning a multipart/mixed message from an endpoint can be done in two ways. <code>MultipartOutput</code> can be returned as the method&#8217;s return object or as an entity in a <code>Response</code> object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">soups/obj</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/mixed</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> MultipartOutput soupsObj() {
    <span class="keyword">return</span> multipartOutput;
}

<span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">soups/resp</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/mixed</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> Response soupsResp() {
  <span class="keyword">return</span> Response.ok(multipartOutput, MediaType.valueOf(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/mixed</span><span class="delimiter">&quot;</span></span>))
                 .build();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no difference in the way a client retrieves the message from the endpoint.
It is done as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        WebTarget target = client.target(THE_URL);
        <span class="keyword">try</span> (Response response = target.request().get()) {
            MultipartInput multipartInput = response.readEntity(MultipartInput.class);
            <span class="keyword">for</span> (InputPart inputPart : multipartInput.getParts()) {
                <span class="keyword">if</span> (MediaType.APPLICATION_XML_TYPE.equals(inputPart.getMediaType())) {
                  Soup c = inputPart.getBody(Soup.class, <span class="predefined-constant">null</span>);
                  <span class="predefined-type">String</span> name = c.getId();
                } <span class="keyword">else</span> {
                  <span class="predefined-type">String</span> s = inputPart.getBody(<span class="predefined-type">String</span>.class, <span class="predefined-constant">null</span>);
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A client sends the message, multipartOutput, to an endpoint as an entity object in an HTTP method call in this code fragment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newClient();
WebTarget target = client.target(SOME_URL + <span class="string"><span class="delimiter">&quot;</span><span class="content">/register/soups</span><span class="delimiter">&quot;</span></span>);
<span class="predefined-type">Entity</span>&lt;MultipartOutput&gt; entity = <span class="predefined-type">Entity</span>.entity(multipartOutput,
        <span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">mixed</span><span class="delimiter">&quot;</span></span>));
Response response = target.request().post(entity);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the endpoint receiving the message and extracting the contents.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="annotation">@POST</span>
 <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/mixed</span><span class="delimiter">&quot;</span></span>)
 <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">register/soups</span><span class="delimiter">&quot;</span></span>)
  <span class="directive">public</span> <span class="type">void</span> registerSoups(MultipartInput multipartInput) <span class="directive">throws</span> <span class="exception">IOException</span> {

      <span class="keyword">for</span> (InputPart inputPart : multipartInput.getParts()) {
         <span class="keyword">if</span> (MediaType.APPLICATION_XML_TYPE.equals(inputPart.getMediaType())) {
                Soup c = inputPart.getBody(Soup.class, <span class="predefined-constant">null</span>);
                <span class="predefined-type">String</span> name = c.getId();
         } <span class="keyword">else</span> {
                <span class="predefined-type">String</span> s = inputPart.getBody(<span class="predefined-type">String</span>.class, <span class="predefined-constant">null</span>);
         }
      }
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_message_with_generictype_example"><a class="anchor" href="#_message_with_generictype_example"></a>27.1.4. Multipart/mixed message with GenericType example</h4>
<div class="paragraph">
<p>This example shows how to read and write a multipart/mixed message whose content consists of a generic type, in this case a List&lt;Soup&gt;. The <code>MultipartOutput</code> and <code>MultipartIntput</code> methods that use <code>GenericType</code> parameters are used.</p>
</div>
<div class="paragraph">
<p>The multipart/mixed message is created using <code>MultipartOutput</code> as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    MultipartOutput multipartOutput = <span class="keyword">new</span> MultipartOutput();
    <span class="predefined-type">List</span>&lt;Soup&gt; soupList = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;Soup&gt;();
    soupList.add(<span class="keyword">new</span> Soup(<span class="string"><span class="delimiter">&quot;</span><span class="content">Chicken Noodle</span><span class="delimiter">&quot;</span></span>));
    soupList.add(<span class="keyword">new</span> Soup(<span class="string"><span class="delimiter">&quot;</span><span class="content">Vegetable</span><span class="delimiter">&quot;</span></span>));
    multipartOutput.addPart(soupList, <span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;Soup&gt;&gt;(){},
           MediaType.APPLICATION_XML_TYPE );
    multipartOutput.addPart(<span class="string"><span class="delimiter">&quot;</span><span class="content">Granny's Soups</span><span class="delimiter">&quot;</span></span>, MediaType.TEXT_PLAIN_TYPE);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The message data is extracted with <code>MultipartInput</code>.
Note there are two <code>MultipartInput</code> getBody methods that can be used to retrieve data specifying <code>GenericType</code>.
This code fragment uses the second one but shows the first one in comments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;T&gt; T getBody(<span class="predefined-type">Class</span>&lt;T&gt; type, <span class="predefined-type">Type</span> genericType) <span class="directive">throws</span> <span class="exception">IOException</span>;
&lt;T&gt; T getBody(GenericType&lt;T&gt; type) <span class="directive">throws</span> <span class="exception">IOException</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {

   <span class="comment">// MultipartInput multipartInput, the entity returned in the client in a</span>
   <span class="comment">// Response object or the input value of an endpoint method parameter.</span>
   GenericType&lt;<span class="predefined-type">List</span>&lt;Soup&gt;&gt; gType = <span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;Soup&gt;&gt;(){};

   <span class="keyword">for</span> (InputPart inputPart : multipartInput.getParts()) {
      <span class="keyword">if</span> (MediaType.APPLICATION_XML_TYPE.equals(inputPart.getMediaType())) {
         <span class="predefined-type">List</span>&lt;Soup&gt; c = inputPart.getBody(gType);
      } <span class="keyword">else</span> {
         <span class="predefined-type">String</span> s = inputPart.getBody(<span class="predefined-type">String</span>.class, <span class="predefined-constant">null</span>);;
      }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multipart_list_example"><a class="anchor" href="#_multipart_list_example"></a>27.1.5. java.util.List with multipart/mixed data example</h4>
<div class="paragraph">
<p>When a set of message parts are uniform they do not need to be written using <code>MultipartOutput</code> or read with <code>MultipartInput</code>.
They can be sent and received as a <code>List</code>.
RESTEasy performs the necessary work to read and write the message data.</p>
</div>
<div class="paragraph">
<p>For this example the data to be transmitted is class, <code>ContextProvidersCustomer</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.test.providers.multipart.resource</span>;

<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlAccessType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlAccessorType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlElement</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlRootElement</span>;

<span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContextProvidersCustomer</span> {
   <span class="annotation">@XmlElement</span>
   <span class="directive">private</span> <span class="predefined-type">String</span> name;

   <span class="directive">public</span> ContextProvidersCustomer() { }
   <span class="directive">public</span> ContextProvidersCustomer(<span class="directive">final</span> <span class="predefined-type">String</span> name) {
      <span class="local-variable">this</span>.name = name;
  }
   <span class="directive">public</span> <span class="predefined-type">String</span> getName() { <span class="keyword">return</span> name;}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this code fragment the client creates and sends a list of <code>ContextProvidersCustomers</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;ContextProvidersCustomer&gt; customers =
    <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;ContextProvidersCustomer&gt;();
customers.add(<span class="keyword">new</span> ContextProvidersCustomer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>));
customers.add(<span class="keyword">new</span> ContextProvidersCustomer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>));

<span class="predefined-type">Entity</span>&lt;ContextProvidersCustomer&gt; entity = <span class="predefined-type">Entity</span>.entity(customers,
<span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">mixed</span><span class="delimiter">&quot;</span></span>));

Client client = ClientBuilder.newClient();
WebTarget target = client.target(SOME_URL);
Response response = target.request().post(entity);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The endpoint receives the list, alters the contents and returns a new list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/mixed</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_XML)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post/list</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">List</span>&lt;ContextProvidersName&gt; postList(
     <span class="predefined-type">List</span>&lt;ContextProvidersCustomer&gt; customers) <span class="directive">throws</span> <span class="exception">IOException</span> {

  <span class="predefined-type">List</span>&lt;ContextProvidersName&gt; names = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;ContextProvidersName&gt;();

  <span class="keyword">for</span> (ContextProvidersCustomer customer : customers) {
     names.add(<span class="keyword">new</span> ContextProvidersName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="delimiter">&quot;</span></span> + customer.getName()));
  }
  <span class="keyword">return</span> names;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client receives the altered message data and processes it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response response = target.request().post(entity);
<span class="predefined-type">List</span>&lt;ContextProvidersCustomer&gt; rtnList =
  response.readEntity(<span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;ContextProvidersCustomer&gt;&gt;(){});</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multipart_related_group"><a class="anchor" href="#_multipart_related_group"></a>27.2. Multipart/related</h3>
<div class="paragraph">
<p>The Multipart/Related mime type is intended for compound objects consisting of several inter-related body parts, (RFC2387).  There is a root or start part.
All other parts are referenced from the root part.
Each part has a unique id.
The type and the id of the start part is presented in parameters in the message content-type header.</p>
</div>
<div class="sect3">
<h4 id="_writing_multipart_related"><a class="anchor" href="#_writing_multipart_related"></a>27.2.1. Writing multipart/related messages</h4>
<div class="paragraph">
<p>RESTEasy provides class <code>MultipartRelatedOutput</code> to assist the user in specifying the required information and generating a properly formatted message. <code>MultipartRelatedOutput</code> is a subclass of <code>MultipartOutput</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.plugins.providers.multipart</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MultipartRelatedOutput</span> <span class="directive">extends</span> MultipartOutput {
   <span class="directive">private</span> <span class="predefined-type">String</span> startInfo;

   <span class="comment">/**
    * The part used as the root.
    */</span>
   <span class="directive">public</span> OutputPart getRootPart();

   <span class="comment">/**
    * entity  object representing the part's body
    * mediaType Content-Type of the part
    * contentId  Content-ID to be used as identification for the current
    *            part, optional, if null one will be generated
    * contentTransferEncoding
    *            value used for the Content-Transfer-Encoding header
    *            field of the part. It's optional, if you don't want to set
    *            this pass null. Example values are: &quot;7bit&quot;,
    *            &quot;quoted-printable&quot;, &quot;base64&quot;, &quot;8bit&quot;, &quot;binary&quot;
    */</span>
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, MediaType mediaType,
         <span class="predefined-type">String</span> contentId, <span class="predefined-type">String</span> contentTransferEncoding);

   <span class="comment">/**
    * start-info parameter of the Content-Type.  An optional parameter.
    * As described in RFC2387, section 3.3. The Start-Info Parameter
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getStartInfo();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_reading_multipart_related"><a class="anchor" href="#_reading_multipart_related"></a>27.2.2. Reading multipart/related messages</h4>
<div class="paragraph">
<p><code>MultipartRelatedInput</code> is an interface class that provides access to multipart/related message data.
It is a subclass of <code>MultipartInput</code>.
RESTEasy provides an implementation of this class.
It performs the work to retrieve message data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.plugins.providers.multipart</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MultipartRelatedOutput</span> <span class="directive">extends</span> MultipartOutput {
   <span class="directive">private</span> <span class="predefined-type">String</span> startInfo;

   <span class="comment">/**
    * The part used as the root.
    */</span>
   <span class="directive">public</span> OutputPart getRootPart();

   <span class="comment">/**
    * entity  object representing the part's body
    * mediaType Content-Type of the part
    * contentId  Content-ID to be used as identification for the current
    *            part, optional, if null one will be generated
    * contentTransferEncoding
    *            value used for the Content-Transfer-Encoding header
    *            field of the part. It's optional, if you don't want to set
    *            this pass null. Example values are: &quot;7bit&quot;,
    *            &quot;quoted-printable&quot;, &quot;base64&quot;, &quot;8bit&quot;, &quot;binary&quot;
    */</span>
   <span class="directive">public</span> OutputPart addPart(<span class="predefined-type">Object</span> entity, MediaType mediaType,
         <span class="predefined-type">String</span> contentId, <span class="predefined-type">String</span> contentTransferEncoding);

   <span class="comment">/**
    * start-info parameter of the Content-Type.  An optional parameter.
    * As described in RFC2387, section 3.3. The Start-Info Parameter
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getStartInfo();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multipart_related_example"><a class="anchor" href="#_multipart_related_example"></a>27.2.3. Multipart/related message example</h4>
<div class="paragraph">
<p>The client in this example creates a multipart/related message, POSTs it to the endpoint and processes the multipart/related message returned by the endpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    MultipartRelatedOutput mRelatedOutput = <span class="keyword">new</span> MultipartRelatedOutput();
    mRelatedOutput.setStartInfo(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>);
    mRelatedOutput.addPart(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">png</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">binary</span><span class="delimiter">&quot;</span></span>);
    mRelatedOutput.addPart(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">png</span><span class="delimiter">&quot;</span></span>), <span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">binary</span><span class="delimiter">&quot;</span></span>);

    <span class="predefined-type">Entity</span>&lt;MultipartRelatedOutput&gt; entity = <span class="predefined-type">Entity</span>.entity(mRelatedOutput,
        <span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">related</span><span class="delimiter">&quot;</span></span>));

    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        WebTarget target = client.target(SOME_URL);
        <span class="keyword">try</span> (Response response = target.request().post(entity)) {
            MultipartRelatedInput result = response.readEntity(
                  MultipartRelatedInput.class);
            <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, InputPart&gt; map = result.getRelatedMap();
            <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; keys = map.keySet();
            <span class="type">boolean</span> a = keys.contains(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>);
            <span class="type">boolean</span> b = keys.contains(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>);
            <span class="keyword">for</span> (InputPart inputPart : map.values()) {
                <span class="predefined-type">String</span> alterName = inputPart.getBody(<span class="predefined-type">String</span>.class, <span class="predefined-constant">null</span>);
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the endpoint the client above is calling.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/related</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/related</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post/related</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> MultipartRelatedOutput postRelated(MultipartRelatedInput input)
        <span class="directive">throws</span> <span class="exception">IOException</span> {

  MultipartRelatedOutput rtnMRelatedOutput = <span class="keyword">new</span> MultipartRelatedOutput();
        rtnMRelatedOutput.setStartInfo(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>);

  <span class="keyword">for</span> (<span class="predefined-type">Iterator</span>&lt;InputPart&gt; it = input.getParts().iterator(); it.hasNext(); ) {
      InputPart part = it.next();
      <span class="predefined-type">String</span> name = part.getBody(<span class="predefined-type">String</span>.class, <span class="predefined-constant">null</span>);
      rtnMRelatedOutput.addPart(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="delimiter">&quot;</span></span> + name,
                    <span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">png</span><span class="delimiter">&quot;</span></span>), name, <span class="predefined-constant">null</span>);
  }
  <span class="keyword">return</span> rtnMRelatedOutput;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_xml_binary_optimized_packaging"><a class="anchor" href="#_xml_binary_optimized_packaging"></a>27.2.4. XML-binary Optimized Packaging (XOP)</h4>
<div class="paragraph">
<p>RESTEasy supports XOP messages packaged as multipart/related messages (<a href="http://www.w3.org/TR/xop10/" class="bare">http://www.w3.org/TR/xop10/</a>). A Jakarta XML Binding annotated POJO that also holds binary content can be transmitted using XOP.
XOP allows the binary data to skip going through the XML serializer because binary data can be serialized differently from text and this can result in faster transport time.</p>
</div>
<div class="paragraph">
<p>RESTEasy requires annotation <code>@XopWithMultipartRelated</code> to be placed on any endpoint method that returns an object that is to be processed with XOP and on any endpoint input parameter that is to be processed by XOP.</p>
</div>
<div class="paragraph">
<p>RESTEasy highly recommends, if you know the exact mime type of the POJO&#8217;s binary data, tag the field with annotation @XmlMimeType.
This annotation tells Jakarta XML Binding the mime type of the binary content, however this is not required in order to do XOP packaging.</p>
</div>
</div>
<div class="sect3">
<h4 id="_xopwithmultipartrelated_return_object_example"><a class="anchor" href="#_xopwithmultipartrelated_return_object_example"></a>27.2.5. @XopWithMultipartRelated return object example</h4>
<div class="paragraph">
<p>The data to be transmitted is class, <code>ContextProvidersXop</code>.
Note that field, <code>bytes</code>, is identified as an application/octet-stream mime type using annotation @XmlMimeType</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.test.providers.multipart.resource</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlAccessType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlAccessorType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlMimeType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlRootElement</span>;

<span class="annotation">@XmlRootElement</span>
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContextProvidersXop</span> {

   <span class="annotation">@XmlMimeType</span>(MediaType.APPLICATION_OCTET_STREAM)
   <span class="directive">private</span> <span class="type">byte</span><span class="type">[]</span> bytes;

   <span class="directive">public</span> ContextProvidersXop(<span class="directive">final</span> <span class="type">byte</span><span class="type">[]</span> bytes) {
      <span class="local-variable">this</span>.bytes = bytes;
   }

   <span class="directive">public</span> ContextProvidersXop() {}
   <span class="directive">public</span> <span class="type">byte</span><span class="type">[]</span> getBytes() {<span class="keyword">return</span> bytes;}
   <span class="directive">public</span> <span class="type">void</span> setBytes(<span class="type">byte</span><span class="type">[]</span> bytes) {<span class="local-variable">this</span>.bytes = bytes;}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The endpoint returns an instance of <code>ContextProvidersXop</code>.
Note annotation <code>@XopWithMultipartRelated</code> is declared on the method because we want the return object to use XOP packaging.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/xop</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/related</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@XopWithMultipartRelated</span>
<span class="directive">public</span> ContextProvidersXop getXop() {
    <span class="keyword">return</span> <span class="keyword">new</span> ContextProvidersXop(<span class="string"><span class="delimiter">&quot;</span><span class="content">goodbye world</span><span class="delimiter">&quot;</span></span>.getBytes());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client retrieves the data as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        WebTarget target = client.target(SOME_URL);
        <span class="keyword">try</span> (Response response = target.request().get()) {
            ContextProvidersXo entity = response.readEntity(ContextProvidersXop.class);
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_xopwithmultipartrelated_input_parameter_example"><a class="anchor" href="#_xopwithmultipartrelated_input_parameter_example"></a>27.2.6. @XopWithMultipartRelated input parameter example</h4>
<div class="paragraph">
<p>Here is an endpoint that has an input parameter that is transmitted as an XOP package.
Note the @XopWithMultipartRelated annotation on input parameter xop.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post/xop</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/related</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> postXop(<span class="annotation">@XopWithMultipartRelated</span> ContextProvidersXop xop) {
    <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">String</span>(xop.getBytes());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This client is sending the data to the endpoint above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ContextProvidersXop xop = <span class="keyword">new</span> ContextProvidersXop(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>.getBytes());
<span class="predefined-type">Entity</span>&lt;ContextProvidersXop&gt; entity = <span class="predefined-type">Entity</span>.entity(xop,
    <span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">related</span><span class="delimiter">&quot;</span></span>));

Client client = ClientBuilder.newClient();
WebTarget target = client.target(SOME_URL);
Response response = target.request().post(entity);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multipart_formdata_group"><a class="anchor" href="#_multipart_formdata_group"></a>27.3. Multipart/form-data</h3>
<div class="paragraph">
<p>The MultiPart/Form-Data mime type is used in sending form data (rfc2388). It can include data generated by user input, information that is typed, or included from files that the user has selected.
"multipart/form-data" is often found in web application HTML Form documents and is generally used to upload files.
The form-data format is the same as other multi-part formats, except that each inlined piece of content has a name associated with it.</p>
</div>
<div class="sect3">
<h4 id="_entity_part"><a class="anchor" href="#_entity_part"></a>27.3.1. Multipart/form-data with EntityParts</h4>
<div class="paragraph">
<p>In Jakarta RESTful Web Services 3.1 the <code>jakarta.ws.rs.core.EntityPart</code> API was introduced.
This can be used to read and write <code>multipart/form-data</code> with a standardized API.</p>
</div>
<div class="paragraph">
<p>The content of the <code>EntityPart</code> has two definable size limits. It also allows you to override the temporary directory
where files will be written to. These can be set as system properties, servlet context properties or a MicroProfile
Config compatible value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dev.resteasy.entity.memory.threshold</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold to use for the amount of data to store in memory for entities.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512MB is equivalent to 512 Megabytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dev.resteasy.entity.file.threshold</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold to use for the amount of data that can be stored in a file for entities. If the threshold is reached an
  <code>IllegalStateException</code> will be thrown. A value of -1 means no limit.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1GB is equivalent to 1 Gigabyte</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dev.resteasy.entity.tmpdir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The temporary directory to use when the <code>dev.resteasy.entity.memory.threshold</code> was reached and the entity must be
  written to a file. Note that the directory must already exist.
<code>IllegalStateException</code> will be thrown. A value of -1 means no limit.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of the <code>java.io.tmpdir</code> system property.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/tmp/entity</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can read, write and inject (with <code>@FormParam</code>) an <code>EntityPart</code> in the following forms;</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EntityPart</code></p>
</li>
<li>
<p><code>List&lt;EntityPart&gt;</code></p>
</li>
<li>
<p><code>InputStream</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example reading data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        <span class="directive">final</span> ListEntityPart multipart = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>();
        multipart.add(
                EntityPart.withName(<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span>)
                        .content(<span class="string"><span class="delimiter">&quot;</span><span class="content">Example Content</span><span class="delimiter">&quot;</span></span>)
                        .mediaType(MediaType.TEXT_PLAIN_TYPE)
                        .build()
        );
        <span class="keyword">try</span> (
                Response response = client.target(INSTANCE.configuration().baseUriBuilder().path(<span class="string"><span class="delimiter">&quot;</span><span class="content">test/injected</span><span class="delimiter">&quot;</span></span>))
                        .request(MediaType.MULTIPART_FORM_DATA_TYPE)
                        .post(<span class="predefined-type">Entity</span>.entity(<span class="keyword">new</span> GenericEntity(multipart) {
                        }, MediaType.MULTIPART_FORM_DATA))
        ) {
            Assert.assertEquals(Response.Status.OK, response.getStatusInfo());
            <span class="directive">final</span> ListEntityPart entityParts = response.readEntity(<span class="keyword">new</span> GenericType() {
            });
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example receiving and writing data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Consumes</span>(MediaType.MULTIPART_FORM_DATA)
<span class="annotation">@Produces</span>(MediaType.MULTIPART_FORM_DATA)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/injected</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> ListEntityPart injected(<span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span>) <span class="directive">final</span> <span class="predefined-type">String</span> string,
                         <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span>) <span class="directive">final</span> EntityPart entityPart,
                         <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span>) <span class="directive">final</span> <span class="predefined-type">InputStream</span> in) <span class="directive">throws</span> <span class="exception">IOException</span> {
    <span class="directive">final</span> ListEntityPart multipart = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>();
    multipart.add(
            EntityPart.withName(<span class="string"><span class="delimiter">&quot;</span><span class="content">received-entity-part</span><span class="delimiter">&quot;</span></span>)
                    .content(entityPart.getContent(<span class="predefined-type">String</span>.class))
                    .mediaType(entityPart.getMediaType())
                    .fileName(entityPart.getFileName().orElse(<span class="predefined-constant">null</span>))
                    .build()
    );
    multipart.add(
            EntityPart.withName(<span class="string"><span class="delimiter">&quot;</span><span class="content">received-input-stream</span><span class="delimiter">&quot;</span></span>)
                    .content(MultipartEntityPartProviderTest.toString(in).getBytes(StandardCharsets.UTF_8))
                    .mediaType(MediaType.APPLICATION_OCTET_STREAM_TYPE)
                    .build()
    );
    multipart.add(
            EntityPart.withName(<span class="string"><span class="delimiter">&quot;</span><span class="content">received-string</span><span class="delimiter">&quot;</span></span>)
                    .content(string)
                    .mediaType(MediaType.TEXT_PLAIN_TYPE)
                    .build()
    );
    <span class="keyword">return</span> multipart;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_writing_multipart_formdata"><a class="anchor" href="#_writing_multipart_formdata"></a>27.3.2. Writing multipart/form-data messages</h4>
<div class="paragraph">
<p>Form data consists of key/value pairs.
RESTEasy provides class <code>MultipartFormDataOutput</code> to assist the user in specifying the required information and generating a properly formatted message.
It is a subclass of <code>MultipartOutput</code>.
And as with multipart/mixed data sometimes there may be marshalling which is sensitive to generic type metadata, in those cases use the methods containing input parameter GenericType.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.plugins.providers.multipart</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MultipartFormDataOutput</span> <span class="directive">extends</span> MultipartOutput {
    <span class="directive">public</span> OutputPart addFormData(<span class="predefined-type">String</span> key, <span class="predefined-type">Object</span> entity,
            MediaType mediaType)
    <span class="directive">public</span> OutputPart addFormData(<span class="predefined-type">String</span> key, <span class="predefined-type">Object</span> entity, GenericType type,
            MediaType mediaType)
    <span class="directive">public</span> OutputPart addFormData(<span class="predefined-type">String</span> key, <span class="predefined-type">Object</span> entity, <span class="predefined-type">Class</span> type,
            <span class="predefined-type">Type</span> genericType, MediaType mediaType)
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, OutputPart&gt; getFormData()
    <span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">List</span>&lt;OutputPart&gt;&gt; getFormDataMap()
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_reading_multipart_formdata"><a class="anchor" href="#_reading_multipart_formdata"></a>27.3.3. Reading multipart/form-data messages</h4>
<div class="paragraph">
<p><code>MultipartFormDataInput</code> is an interface class that provides access to multipart/form-data message data.
It is a subclass of <code>MultipartInput</code>.
RESTEasy provides an implementation of this class.
It performs the work to retrieve message data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.plugins.providers.multipart</span>;

<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.lang.reflect.Type</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.GenericType</span>;

<span class="directive">public</span> <span class="type">interface</span> <span class="class">MultipartFormDataInput</span> <span class="directive">extends</span> MultipartInput {
   <span class="comment">/**
    * @return A parameter map containing a list of values per name.
    */</span>
   <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">List</span>&lt;InputPart&gt;&gt; getFormDataMap();
   &lt;T&gt; T getFormDataPart(<span class="predefined-type">String</span> key, <span class="predefined-type">Class</span>&lt;T&gt; rawType, <span class="predefined-type">Type</span> genericType)
         <span class="directive">throws</span> <span class="exception">IOException</span>;
   &lt;T&gt; T getFormDataPart(<span class="predefined-type">String</span> key, GenericType&lt;T&gt; type) <span class="directive">throws</span> <span class="exception">IOException</span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_simple_multipart_formdata_example"><a class="anchor" href="#_simple_multipart_formdata_example"></a>27.3.4. Simple multipart/form-data message example</h4>
<div class="paragraph">
<p>The following example show how to read and write a simple multipart/form-data message.</p>
</div>
<div class="paragraph">
<p>The multipart/mixed message is created on the clientside using the <code>MultipartFormDataOutput</code> object.
One piece of form data to be transfered is a very simple class, <code>ContextProvidersName</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.test.providers.multipart.resource</span>;

<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlAccessType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlAccessorType</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlElement</span>;
<span class="keyword">import</span> <span class="include">jakarta.xml.bind.annotation.XmlRootElement</span>;

<span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContextProvidersName</span> {
   <span class="annotation">@XmlElement</span>
   <span class="directive">private</span> <span class="predefined-type">String</span> name;

   <span class="directive">public</span> ContextProvidersName() {}
   <span class="directive">public</span> ContextProvidersName(<span class="directive">final</span> <span class="predefined-type">String</span> name) {<span class="local-variable">this</span>.name = name;}
   <span class="directive">public</span> <span class="predefined-type">String</span> getName() {<span class="keyword">return</span> name;}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client creates and sends the message as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    MultipartFormDataOutput output = <span class="keyword">new</span> MultipartFormDataOutput();
    output.addFormData(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> ContextProvidersCustomer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>),
     MediaType.APPLICATION_XML_TYPE);
    output.addFormData(<span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>, MediaType.TEXT_PLAIN_TYPE);

    <span class="predefined-type">Entity</span>&lt;MultipartFormDataOutput&gt; entity = <span class="predefined-type">Entity</span>.entity(output,
      <span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">related</span><span class="delimiter">&quot;</span></span>));

    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        WebTarget target = client.target(SOME_URL);
        <span class="keyword">try</span> (Response response = target.request().post(entity)) {
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The endpoint receives the message and processes it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/form-data</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_XML)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post/form</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> Response postForm(MultipartFormDataInput input)
     <span class="directive">throws</span> <span class="exception">IOException</span> {

  <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">List</span>&lt;InputPart&gt;&gt; map = input.getFormDataMap();
  <span class="predefined-type">List</span>&lt;ContextProvidersName&gt; names = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;ContextProvidersName&gt;();

  <span class="keyword">for</span> (<span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">String</span>&gt; it = map.keySet().iterator(); it.hasNext(); ) {
     <span class="predefined-type">String</span> key = it.next();
     InputPart inputPart = map.get(key).iterator().next();
     <span class="keyword">if</span> (MediaType.APPLICATION_XML_TYPE.equals(inputPart.getMediaType())) {
        names.add(<span class="keyword">new</span> ContextProvidersName(inputPart.getBody(
              ContextProvidersCustomer.class, <span class="predefined-constant">null</span>).getName()));
     } <span class="keyword">else</span> {
        names.add(<span class="keyword">new</span> ContextProvidersName(inputPart.getBody(
              <span class="predefined-type">String</span>.class, <span class="predefined-constant">null</span>)));
     }
  }
  <span class="keyword">return</span> Response.ok().build();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_map_with_multipart_formdata"><a class="anchor" href="#_map_with_multipart_formdata"></a>27.3.5. java.util.Map with multipart/form-data</h4>
<div class="paragraph">
<p>When the data of a multipart/form-data message is uniform it does not need to be written in a <code>MultipartFormDataOutput</code> object.
It can be sent and received as a <code>java.util.Map</code> object.
RESTEasy performs the necessary work to read and write the message data, however the Map object must declare the type it is unmarshalling via the generic parameters in the Map type declaration.</p>
</div>
<div class="paragraph">
<p>Here is an example of a client creating and sending a multipart/form-data message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ContextProvidersCustomer&gt; customers =
          <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, ContextProvidersCustomer&gt;();
    customers.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> ContextProvidersCustomer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>));
    customers.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> ContextProvidersCustomer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>));

    <span class="predefined-type">Entity</span>&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ContextProvidersCustomer&gt;&gt; entity =
    <span class="predefined-type">Entity</span>.entity(customers, <span class="keyword">new</span> MediaType(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">form-data</span><span class="delimiter">&quot;</span></span>));

    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        WebTarget target = client.target(SOME_URL);
        <span class="keyword">try</span> (Response response = target.request().post(entity)) {
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the endpoint the client above is calling.
It receives the message and processes it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="annotation">@POST</span>
 <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/form-data</span><span class="delimiter">&quot;</span></span>)
 <span class="annotation">@Produces</span>(MediaType.APPLICATION_XML)
 <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post/map</span><span class="delimiter">&quot;</span></span>)
 <span class="directive">public</span> Response postMap(<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ContextProvidersCustomer&gt; customers)
         <span class="directive">throws</span> <span class="exception">IOException</span> {

   <span class="predefined-type">List</span>&lt;ContextProvidersName&gt; names = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;ContextProvidersName&gt;();
   <span class="keyword">for</span> (<span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">String</span>&gt; it = customers.keySet().iterator(); it.hasNext(); ) {
       <span class="predefined-type">String</span> key = it.next();
       ContextProvidersCustomer customer = customers.get(key);
       names.add(<span class="keyword">new</span> ContextProvidersName(key + <span class="string"><span class="delimiter">&quot;</span><span class="content">:</span><span class="delimiter">&quot;</span></span> + customer.getName()));
   }
   <span class="keyword">return</span> Response.ok().build();
 }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multipart_formdata_output"><a class="anchor" href="#_multipart_formdata_output"></a>27.3.6. Multipart/form-data java.util.Map as method return type</h4>
<div class="paragraph">
<p>A <code>java.util.Map</code> object representing a multipart/form-data message can be returned from an endpoint as long as the message data is uniform,  however the endpoint method MUST be annotated with @PartType which declares the media type of the Map entries and the Map object must declare the type it is unmarshalling via the generic parameters in the Map type declaration.
RESTEasy requires this information so it can generate the message properly.</p>
</div>
<div class="paragraph">
<p>Here is an example of an endpoint returning a Map of <code>ContextProvidersCustomer</code> to the client.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/form-data</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@PartType</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/map</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ContextProvidersCustomer&gt; getMap() {

  <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ContextProvidersCustomer&gt; map =
      <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, ContextProvidersCustomer&gt;();
  map.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> ContextProvidersCustomer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>));
  map.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> ContextProvidersCustomer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>));
  <span class="keyword">return</span> map;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client would retrieve the data as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> process() {
    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        WebTarget target = client.target(SOME_URL);
        <span class="keyword">try</span> (Response response = target.request().get()) {
            MultipartFormDataInput entity = response.readEntity(MultipartFormDataInput.class);
        }
    }

    ContextProvidersCustomer bill = entity.getFormDataPart(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>,
        ContextProvidersCustomer.class, <span class="predefined-constant">null</span>);
    ContextProvidersCustomer bob = entity.getFormDataPart(<span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>,
        ContextProvidersCustomer.class, <span class="predefined-constant">null</span>);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multipartform_annotation"><a class="anchor" href="#_multipartform_annotation"></a>27.3.7. @MultipartForm and POJOs</h4>
<div class="paragraph">
<p>If you have exact knowledge of the multipart/form-data packets, they can be mapped to and from a POJO class using the annotation <code>@org.jboss.resteasy.annotations.providers.multipart.MultipartForm</code> and the Jakarta RESTful Web Services <code>@FormParam</code> annotation.
Simply define a POJO with at least a default constructor and annotate its fields and/or properties with <code>@FormParams</code>.
These <code>@FormParams</code> must also be annotated with <code>@org.jboss.resteasy.annotations.providers.multipart.PartType</code> if doing output.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">CustomerProblemForm</span> {
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@PartType</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> Customer customer;

    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">problem</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@PartType</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> problem;

    <span class="directive">public</span> Customer getCustomer() { <span class="keyword">return</span> customer; }
    <span class="directive">public</span> <span class="type">void</span> setCustomer(Customer cust) { <span class="local-variable">this</span>.customer = cust; }
    <span class="directive">public</span> <span class="predefined-type">String</span> getProblem() { <span class="keyword">return</span> problem; }
    <span class="directive">public</span> <span class="type">void</span> setProblem(<span class="predefined-type">String</span> problem) { <span class="local-variable">this</span>.problem = problem; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After defining the POJO class it can be used to represent multipart/form-data.
Here&#8217;s an example of sending a <code>CustomerProblemForm</code> using the RESTEasy client framework:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">portal</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">CustomerPortal</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">issues/{id}</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/form-data</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@PUT</span>
   <span class="directive">public</span> <span class="type">void</span> putProblem(<span class="annotation">@MultipartForm</span> CustomerProblemForm form,
                          <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> id) {
      CustomerPortal portal = ProxyFactory.create(
            CustomerPortal.class, <span class="string"><span class="delimiter">&quot;</span><span class="content">http://example.com</span><span class="delimiter">&quot;</span></span>);
      portal.putProblem(form, <span class="integer">333</span>);
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>@MultipartForm</code> annotation was used to tell RESTEasy that the object has a <code>@FormParam</code> and that it should be marshalled from that.
The same object can be used to receive multipart data.
Here is an example of the server side counterpart of our customer portal.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">portal</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">CustomerPortalServer</span> {

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">issues/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/form-data</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@PUT</span>
    <span class="directive">public</span> <span class="type">void</span> putIssue(<span class="annotation">@MultipartForm</span> CustoemrProblemForm form,
                         <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> id) {
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to the XML data format, JSON formatted data can be used to represent POJO classes.
To achieve this, plug in a JSON provider into your project.
For example, add the RESTEasy Jackson2 Provider into the project&#8217;s dependency scope:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-jackson2-provider<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now an ordinary POJO class can be written, which Jackson2 will automatically serialize/deserialize into JSON format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">JsonUser</span> {
   <span class="directive">private</span> <span class="predefined-type">String</span> name;

   <span class="directive">public</span> JsonUser() {}
   <span class="directive">public</span> JsonUser(<span class="directive">final</span> <span class="predefined-type">String</span> name) { <span class="local-variable">this</span>.name = name; }
   <span class="directive">public</span> <span class="predefined-type">String</span> getName() { <span class="keyword">return</span> name; }
   <span class="directive">public</span> <span class="type">void</span> setName(<span class="predefined-type">String</span> name) { <span class="local-variable">this</span>.name = name; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resource class can be written like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.annotations.providers.multipart.MultipartForm</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.annotations.providers.multipart.PartType</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Consumes</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.FormParam</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.PUT</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Path</span>;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">JsonFormResource</span> {

    <span class="directive">public</span> JsonFormResource() {
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Form</span> {

    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@PartType</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> JsonUser user;

    <span class="directive">public</span> Form() {
    }

    <span class="directive">public</span> Form(<span class="directive">final</span> JsonUser user) {
    <span class="local-variable">this</span>.user = user;
    }

    <span class="directive">public</span> JsonUser getUser() {
      <span class="keyword">return</span> user;
    }
}

    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form/class</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/form-data</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> putMultipartForm(<span class="annotation">@MultipartForm</span> Form form) {
         <span class="keyword">return</span> form.getUser().getName();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the code shown above, it can be seen the PartType of JsonUser is marked as "application/json", and it&#8217;s included in the "@MultipartForm Form" class instance.</p>
</div>
<div class="paragraph">
<p>To send the request to the resource method, send the JSON formatted data that corresponds with the JsonUser class.
The easiest way to do this is to use a proxy class that has the same definition of the resource class.
Here is the sample code of the proxy class that is corresponding with the JsonFormResource class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.annotations.providers.multipart.MultipartForm</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Consumes</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.PUT</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Path</span>;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">JsonForm</span> {

    <span class="annotation">@PUT</span>
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">form/class</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/form-data</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> putMultipartForm(<span class="annotation">@MultipartForm</span> JsonFormResource.Form form);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then use the proxy class above to send the request to the resource method correctly.
Here is the sample code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResteasyClient client = (ResteasyClient)ClientBuilder.newClient();
JsonForm proxy = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">your_request_url_address</span><span class="delimiter">&quot;</span></span>)
                       .proxy(JsonForm.class);
<span class="predefined-type">String</span> name = proxy.putMultipartForm(<span class="keyword">new</span> JsonFormResource
                   .Form(<span class="keyword">new</span> JsonUser(<span class="string"><span class="delimiter">&quot;</span><span class="content">bill</span><span class="delimiter">&quot;</span></span>)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the client side has the Jackson2 provider included, the request will be marshaled correctly.
The JsonUser data will be converted into JSON format and sent to the server side.
Hand-crafted JSON data can be use in the request and sent to the server side.
It must be made sure the request data is in the correct form.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multipart_parsing_note"><a class="anchor" href="#_multipart_parsing_note"></a>27.4. Note about multipart parsing and working with other frameworks</h3>
<div class="paragraph">
<p>There are many frameworks doing multipart parsing automatically with the help of filters and interceptors, like <code>org.jboss.seam.web.MultipartFilter</code> in Seam and <code>org.springframework.web.multipart.MultipartResolver</code> in Spring, however these incoming multipart request stream can be parsed only once.
RESTEasy users working with multipart should make sure that nothing parses the stream before RESTEasy gets it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_multipart_overwrite_default_content_type"><a class="anchor" href="#_multipart_overwrite_default_content_type"></a>27.5. Overwriting the default fallback content type for multipart messages</h3>
<div class="paragraph">
<p>By default if no Content-Type header is present in a part <code>"text/plain; charset=us-ascii"</code> is used as the fallback.
This is the value defined by the MIME RFC, however some web clients, and web browsers do not send Content-Type headers for all fields in a multipart/form-data request.
They send them only for the file parts.
This can cause character encoding and unmarshalling errors on the server side.
To correct this there is an option to define another, non-rfc compliant fallback value.
This can be done dynamically per request with the filter facility of Jakarta RESTful Web Services 3.0.
In the following example we will set <code>"*/*; charset=UTF-8"</code> as the new default fallback:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.plugins.providers.multipart.InputPart</span>;

<span class="annotation">@Provider</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">InputPartDefaultCharsetOverwriteContentTypeCharsetUTF8</span>
   <span class="directive">implements</span> ContainerRequestFilter {

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="type">void</span> filter(ContainerRequestContext requestContext) <span class="directive">throws</span> <span class="exception">IOException</span> {
      requestContext.setProperty(InputPart.DEFAULT_CONTENT_TYPE_PROPERTY, <span class="string"><span class="delimiter">&quot;</span><span class="content">*/*; charset=UTF-8</span><span class="delimiter">&quot;</span></span>);
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multipart_overwrite_content_type"><a class="anchor" href="#_multipart_overwrite_content_type"></a>27.6. Overwriting the content type for multipart messages</h3>
<div class="paragraph">
<p>Using attribute, InputPart.DEFAULT_CONTENT_TYPE_PROPERTY and a filter enables the setting of a default Content-Type, It is also possible to override the Content-Type by setting a different media type with method <code>InputPart.setMediaType()</code>.
Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>(MediaType.MULTIPART_FORM_DATA)
<span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
<span class="directive">public</span> Response setMediaType(MultipartInput input) <span class="directive">throws</span> <span class="exception">IOException</span> {
    <span class="predefined-type">List</span>&lt;InputPart&gt; parts = input.getParts();
    InputPart part = parts.get(<span class="integer">0</span>);
    part.setMediaType(MediaType.valueOf(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/foo+xml</span><span class="delimiter">&quot;</span></span>));
    <span class="predefined-type">String</span> s = part.getBody(<span class="predefined-type">String</span>.class, <span class="predefined-constant">null</span>);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multipart_overwrite_default_charset"><a class="anchor" href="#_multipart_overwrite_default_charset"></a>27.7. Overwriting the default fallback charset for multipart messages</h3>
<div class="paragraph">
<p>Sometimes, a part may have a Content-Type header with no charset parameter.
If the <code>InputPart.DEFAULT_CONTENT_TYPE_PROPERTY</code> property is set and the value has a charset parameter, that value will be appended to an existing Content-Type header that has no charset parameter.
It is also possible to specify a default charset using the constant <code>InputPart.DEFAULT_CHARSET_PROPERTY</code> (actual value "resteasy.provider.multipart.inputpart.defaultCharset"):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.plugins.providers.multipart.InputPart</span>;

<span class="annotation">@Provider</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">InputPartDefaultCharsetOverwriteContentTypeCharsetUTF8</span>
   <span class="directive">implements</span> ContainerRequestFilter {

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="type">void</span> filter(ContainerRequestContext requestContext) <span class="directive">throws</span> <span class="exception">IOException</span> {
      requestContext.setProperty(InputPart.DEFAULT_CHARSET_PROPERTY, <span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>);
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If both <code>InputPart.DEFAULT_CONTENT_TYPE_PROPERTY</code> and <code>InputPart.DEFAULT_CHARSET_PROPERTY</code> are set, then the value of
<code>InputPart.DEFAULT_CHARSET_PROPERTY</code> will override any charset in the value of <code>InputPart.DEFAULT_CONTENT_TYPE_PROPERTY</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jakarta_rest_2.1_additions"><a class="anchor" href="#_jakarta_rest_2.1_additions"></a>28. Jakarta RESTful Web Services 2.1 Additions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jakarta RESTful Web Services 2.1 adds more asynchronous processing support in both the Client and the Server API.
The specification adds a Reactive programming style to the Client side and Server-Sent Events (SSE) protocol support to both client and server.</p>
</div>
<div class="sect2">
<h3 id="_completionstage_support"><a class="anchor" href="#_completionstage_support"></a>28.1. <code>CompletionStage</code> support</h3>
<div class="paragraph">
<p>The specification adds support for declaring asynchronous resource methods by returning a <code>CompletionStage</code> instead of
using the <code>@Suspended</code> annotation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_reactive">supports more reactive types than the specification</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reactive_clients_api"><a class="anchor" href="#_reactive_clients_api"></a>29. Reactive Clients API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The specification defines a new type of invoker named <code>RxInvoker</code>, and a default implementation of this type named
<code>CompletionStageRxInvoker</code>. <code>CompletionStageRxInvoker</code> implements Java 8&#8217;s interface <code>CompletionStage</code>.
This interface declares a large number of methods dedicated to managing asynchronous computations.</p>
</div>
<div class="paragraph">
<p>There is also a new rx method which is used in a similar manner to async.</p>
</div>
<div class="sect2">
<h3 id="_sse_server"><a class="anchor" href="#_sse_server"></a>29.1. Server-Sent Events (SSE)</h3>
<div class="paragraph">
<p>SSE is part of HTML standard, currently supported by many browsers.
It is a server push technology, which provides a way to establish  a one-way channel to continuously send data to clients.
SSE events are pushed  to the client via a long-running HTTP connection.
In case of lost connection, clients can retrieve missed events by setting a "Last-Event-ID" HTTP header in a new request.</p>
</div>
<div class="paragraph">
<p>SSE stream has text/event-stream media type and contains multiple SSE events.
SSE event is a data structure encoded with UTF-8 and contains fields and comment.
The field can be event, data, id, retry and other kinds of field will be ignored.</p>
</div>
<div class="paragraph">
<p>From Jakarta RESTful Web Services 2.1, Server-sent Events APIs are introduced to support sending, receiving and broadcasting SSE events.</p>
</div>
<div class="sect3">
<h4 id="_sse_server_2"><a class="anchor" href="#_sse_server_2"></a>29.1.1. SSE Server</h4>
<div class="paragraph">
<p>As shown in the following example, a SSE resource method has the text/event-stream produce  media type and an injected context parameter SseEventSink.
The injected SseEventSink is  the connected SSE stream where events can be sent.
Another injected context Sse is an  entry point for creating and broadcasting SSE events.
Here is an example to  demonstrate how to send SSE events every 200ms and close the stream after a "done" event.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Resource</span>
<span class="directive">private</span> ManagedExecutorService executor;

<span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">domains/{id}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.SERVER_SENT_EVENTS)
<span class="directive">public</span> <span class="type">void</span> startDomain(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="directive">final</span> <span class="predefined-type">String</span> id, <span class="annotation">@Context</span> SseEventSink sink, <span class="annotation">@Context</span> Sse sse) {
  executor.execute(() -&gt; {
        <span class="keyword">try</span> {
           sink.send(sse.newEventBuilder().name(<span class="string"><span class="delimiter">&quot;</span><span class="content">domain-progress</span><span class="delimiter">&quot;</span></span>)
                 .data(<span class="predefined-type">String</span>.class, <span class="string"><span class="delimiter">&quot;</span><span class="content">starting domain </span><span class="delimiter">&quot;</span></span> + id + <span class="string"><span class="delimiter">&quot;</span><span class="content"> ...</span><span class="delimiter">&quot;</span></span>).build());
           <span class="predefined-type">Thread</span>.sleep(<span class="integer">200</span>);
           sink.send(sse.newEvent(<span class="string"><span class="delimiter">&quot;</span><span class="content">domain-progress</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">50%</span><span class="delimiter">&quot;</span></span>));
           <span class="predefined-type">Thread</span>.sleep(<span class="integer">200</span>);
           sink.send(sse.newEvent(<span class="string"><span class="delimiter">&quot;</span><span class="content">domain-progress</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">60%</span><span class="delimiter">&quot;</span></span>));
           <span class="predefined-type">Thread</span>.sleep(<span class="integer">200</span>);
           sink.send(sse.newEvent(<span class="string"><span class="delimiter">&quot;</span><span class="content">domain-progress</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">70%</span><span class="delimiter">&quot;</span></span>));
           <span class="predefined-type">Thread</span>.sleep(<span class="integer">200</span>);
           sink.send(sse.newEvent(<span class="string"><span class="delimiter">&quot;</span><span class="content">domain-progress</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">99%</span><span class="delimiter">&quot;</span></span>));
           <span class="predefined-type">Thread</span>.sleep(<span class="integer">200</span>);
           sink.send(sse.newEvent(<span class="string"><span class="delimiter">&quot;</span><span class="content">domain-progress</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Done.</span><span class="delimiter">&quot;</span></span>)).thenAccept((<span class="predefined-type">Object</span> obj) -&gt; {
              sink.close();
           });
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
           logger.error(e.getMessage(), e);
        }
  });
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_reactive">supports sending SSE events via reactive types</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_sse_broadcasting"><a class="anchor" href="#_sse_broadcasting"></a>29.1.2. SSE Broadcasting</h4>
<div class="paragraph">
<p>With SseBroadcaster, SSE events can broadcast to multiple clients simultaneously.
It will iterate over all registered SseEventSinks and send events to all requested SSE Stream.
An application can create a SseBroadcaster from an injected context Sse.
The broadcast  method on a SseBroadcaster is used to send SSE events to all registered clients.
The following code snippet is an example on how to create SseBroadcaster, subscribe  and broadcast events to all subscribed consumers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/subscribe</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.SERVER_SENT_EVENTS)
<span class="directive">public</span> <span class="type">void</span> subscribe(<span class="annotation">@Context</span> SseEventSink sink) <span class="directive">throws</span> <span class="exception">IOException</span> {
  <span class="keyword">if</span> (sink == <span class="predefined-constant">null</span>) {
     <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalStateException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">No client connected.</span><span class="delimiter">&quot;</span></span>);
  }
  <span class="keyword">if</span> (sseBroadcaster == <span class="predefined-constant">null</span>) {
     sseBroadcaster = sse.newBroadcaster();
  }
  sseBroadcaster.register(sink);
}

<span class="annotation">@POST</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/broadcast</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">void</span> broadcast(<span class="predefined-type">String</span> message) <span class="directive">throws</span> <span class="exception">IOException</span> {
  <span class="keyword">if</span> (sseBroadcaster == <span class="predefined-constant">null</span>) {
     sseBroadcaster = sse.newBroadcaster();
  }
  sseBroadcaster.broadcast(sse.newEvent(message));

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sse_client"><a class="anchor" href="#_sse_client"></a>29.1.3. SSE Client</h4>
<div class="paragraph">
<p>SseEventSource is the entry point to read and process incoming SSE events.
A SseEventSource instance can be initialized with a WebTarget.
Once SseEventSource  is created and connected to a server, registered event consumer will be invoked when  an inbound event arrives.
In case of errors, an exception will be passed  to a registered consumer so that it can be processed.
SseEventSource can automatically reconnect the server  and continuously receive pushed events after the connection has been lost.
SseEventSource  can send lastEventId to the server by default when it is reconnected, and server may use  this id to replay all missed events.
But reply event is really upon on SSE resource  method implementation.
If the server responds HTTP 503 with a RETRY_AFTER header,  SseEventSource will automatically schedule a reconnect task with this RETRY_AFTER  value.
The following code snippet is to create a SseEventSource and print the  inbound event data value and error if it happens.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> printEvent() <span class="directive">throws</span> <span class="exception">Exception</span> {
  WebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/service/server-sent-events</span><span class="delimiter">&quot;</span></span>);
  <span class="keyword">try</span> (SseEventSource eventSource = SseEventSource.target(target).build()) {
     eventSource.register(event -&gt; <span class="predefined-type">System</span>.out.println(event.readData(<span class="predefined-type">String</span>.class)),
            ex -&gt; ex.printStackTrace());
     eventSource.open();
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_java_api_for_json_binding"><a class="anchor" href="#_java_api_for_json_binding"></a>29.2. Java API for JSON Binding</h3>
<div class="paragraph">
<p>RESTEasy supports both JSON-B and JSON-P.
In accordance with the specification, entity providers for JSON-B take precedence over those for JSON-P for all types except JsonValue and its sub-types.</p>
</div>
<div class="paragraph">
<p>The support for JSON-B is provided by the <code>JsonBindingProvider</code> from <code>resteasy-json-binding-provider</code> module.
To satisfy Jakarta RESTful Web Services" 2.1 requirements, JsonBindingProvider takes precedence over the other providers for dealing with JSON payloads, in particular the Jackson one.
The JSON outputs (for the same input) from Jackson and JSON-B reference implementation can be slightly different.
As a consequence, in order to allow retaining backward compatibility, RESTEasy offers a <code>resteasy.preferJacksonOverJsonB</code> context property that can be set to <code>true</code> to disable JsonBindingProvider for the current deployment.</p>
</div>
<div class="paragraph">
<p>WildFly 14 supports specifying the default value for the <code>resteasy.preferJacksonOverJsonB</code> context property by setting a system property with the same name.
Moreover, if no value is set for the context and system properties, it scans Jakarta RESTful Web Services deployments for Jackson annotations and sets the property to <code>true</code> if any of those annotations is found.</p>
</div>
</div>
<div class="sect2">
<h3 id="_json_patch_and_json_merge_patch"><a class="anchor" href="#_json_patch_and_json_merge_patch"></a>29.3. JSON Patch and JSON Merge Patch</h3>
<div class="paragraph">
<p>RESTEasy supports applying partial modifications to target resources with JSON Patch/JSON Merge Patch.
Instead of sending a json request which represents the whole modified resource with an HTTP PUT method, the json request only contains the modified part with an HTTP PATCH method to do the same job.</p>
</div>
<div class="paragraph">
<p>JSON Patch request has an array of json objects and each JSON object gives the operation to execute against the target resource.
Here is an example to modify the target Student resource which has these fields and values: <code>\{"firstName":"Alice","id":1,"school":"MiddleWood School"}</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>PATCH /StudentPatchTest/students/1 HTTP/1.1
Content-Type: application/json-patch+json
Content-Length: 184
Host: localhost:8090
Connection: Keep-Alive

[{&quot;op&quot;:&quot;copy&quot;,&quot;from&quot;:&quot;/firstName&quot;,&quot;path&quot;:&quot;/lastName&quot;},
 {&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/firstName&quot;,&quot;value&quot;:&quot;John&quot;},
 {&quot;op&quot;:&quot;remove&quot;,&quot;path&quot;:&quot;/school&quot;},
 {&quot;op&quot;:&quot;add&quot;,&quot;path&quot;:&quot;/gender&quot;,&quot;value&quot;:&quot;male&quot;}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This JSON Patch request will copy the firstName to lastName field , then change the firstName value to "John". The next
operation will remove the school value and add male gender to this "id=1" student resource.
After this JSON Path is applied.
The target resource will be modified to: <code>\{"firstName":"John","gender":"male","id":1,"lastName":"Taylor"}</code>. The operation
keyword here can be "add", "remove", "replace", "move", "copy", or "test". The "path" value must be a JSON Pointer
value that points to the part to apply this JSON Patch.</p>
</div>
<div class="paragraph">
<p>Unlike using the operation keyword to patch the target resource, JSON Merge Patch request directly sends the expected json change.
RestEasy merges this change into the target resource which is identified by the request URI.
Like the JSON Merge Patch request below, it removes the "school" value and changes the "firstName" to "Green".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code> PATCH /StudentPatchTest/students/1 HTTP/1.1
 Content-Type: application/merge-patch+json
 Content-Length: 34
 Host: localhost:8090
 Connection: Keep-Alive
 {&quot;firstName&quot;:&quot;Green&quot;,&quot;school&quot;:null}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enabling JSON Patch or JSON Merge Patch only requires correctly annotating the resource method with these mediaTypes.
<code>@Consumes(MediaType.APPLICATION_JSON_PATCH_JSON)</code> enables JSON Patch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{id}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>(MediaType.APPLICATION_JSON)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="directive">public</span> Student getStudent(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">long</span> id) {
    Student student = studentsMap.get(id);
    <span class="keyword">if</span> (student == <span class="predefined-constant">null</span>) {
        <span class="keyword">throw</span> <span class="keyword">new</span> NotFoundException();
    }
    <span class="keyword">return</span> student;
}
<span class="annotation">@PATCH</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{id}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>(MediaType.APPLICATION_JSON_PATCH_JSON)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
    <span class="directive">public</span> Student patchStudent(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">long</span> id, Student student) {
    <span class="keyword">if</span> (studentsMap.get(id) == <span class="predefined-constant">null</span>) {
        <span class="keyword">throw</span> <span class="keyword">new</span> NotFoundException();
    }
    studentsMap.put(id, student);
    <span class="keyword">return</span> student;
}
<span class="annotation">@PATCH</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{id}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/merge-patch+json</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="directive">public</span> Student mergePatchStudent(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="type">long</span> id, Student student) {
    <span class="keyword">if</span> (studentsMap.get(id) == <span class="predefined-constant">null</span>) {
        <span class="keyword">throw</span> <span class="keyword">new</span> NotFoundException();
    }
    studentsMap.put(id, student);
    <span class="keyword">return</span> student;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Before creating a JSON Patch or JSON Merge Patch resource method, there must be a GET method to get the target resource.
In the above code example, the first resource method is responsible for getting the target resource to apply the patch.</p>
</div>
<div class="paragraph">
<p>It requires the patch filter to enable JSON Patch or JSON Merge Patch.
The RESTEasy <code>PatchMethodFilter</code> is enabled by default.
This filter can be disabled by setting "resteasy.patchfilter.disabled" to true as described in <a href="#_configuration_switches">Configuration switches</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The client side needs to create these json objects and send them with a http PATCH method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//send JSON Patch request</span>
WebTarget patchTarget = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8090/StudentPatchTest/students/1</span><span class="delimiter">&quot;</span></span>));
JsonArray patchRequest = Json.createArrayBuilder()
.add(Json.createObjectBuilder().add(<span class="string"><span class="delimiter">&quot;</span><span class="content">op</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">copy</span><span class="delimiter">&quot;</span></span>).add(<span class="string"><span class="delimiter">&quot;</span><span class="content">from</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/firstName</span><span class="delimiter">&quot;</span></span>).add(<span class="string"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/lastName</span><span class="delimiter">&quot;</span></span>).build())
.build();
patchTarget.request().build(HttpMethod.PATCH, <span class="predefined-type">Entity</span>.entity(patchRequest, MediaType.APPLICATION_JSON_PATCH_JSON)).invoke();
<span class="comment">//send JSON Merge Patch request</span>
WebTarget patchTarget = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8090/StudentPatchTest/students/1</span><span class="delimiter">&quot;</span></span>);
JsonObject object = Json.createObjectBuilder().add(<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Green</span><span class="delimiter">&quot;</span></span>).addNull(<span class="string"><span class="delimiter">&quot;</span><span class="content">school</span><span class="delimiter">&quot;</span></span>).build();
Response result = patchTarget.request().build(HttpMethod.PATCH, <span class="predefined-type">Entity</span>.entity(object, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/merge-patch+json</span><span class="delimiter">&quot;</span></span>)).invoke();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stringconverter"><a class="anchor" href="#_stringconverter"></a>30. String marshalling for String based @*Param</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_simple_conversion"><a class="anchor" href="#_simple_conversion"></a>30.1. Simple conversion</h3>
<div class="paragraph">
<p>Parameters and properties annotated with <code>@CookieParam</code>, <code>@HeaderParam</code>, <code>@MatrixParam</code>, <code>@PathParam</code>, or <code>@QueryParam</code>
are represented as strings in a raw HTTP request. The specification says that any of these injected parameters can be
converted to an object if the object&#8217;s class has a <code>valueOf(String)</code> static method or a constructor that takes one
<code>String</code> parameter. In the following, for example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Customer</span> {
   <span class="directive">private</span> <span class="predefined-type">String</span> name;

   <span class="directive">public</span> Customer(<span class="predefined-type">String</span> name) {
      <span class="local-variable">this</span>.name = name;
   }

   <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
      <span class="keyword">return</span> name;
   }
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResource</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response test(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">cust</span><span class="delimiter">&quot;</span></span>) Customer cust) {
      <span class="keyword">return</span> Response.ok(cust.getName()).build();
   }
}

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testQuery() <span class="directive">throws</span> <span class="exception">Exception</span> {
   Invocation.Builder request = ClientBuilder.newClient().target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/test?cust=Bill</span><span class="delimiter">&quot;</span></span>).request();
   Response response = request.get();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the query "?cust=Bill" will be transformed automatically to an instance of <code>Customer</code> with name == "Bill".</p>
</div>
</div>
<div class="sect2">
<h3 id="_paramconverter"><a class="anchor" href="#_paramconverter"></a>30.2. ParamConverter</h3>
<div class="paragraph">
<p>What if you have a class where <code>valueOf()</code> or this string constructor don&#8217;t exist or is inappropriate for an HTTP
request? Jakarta RESTful Web Services has the <code>jakarta.ws.rs.ext.ParamConverterProvider</code> to help in this situation.</p>
</div>
<div class="paragraph">
<p>A <a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/ext/paramconverterprovider"><code>ParamConverterProvider</code></a> is a provider defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ParamConverterProvider</span> {

   &lt;T&gt; ParamConverter&lt;T&gt; getConverter(<span class="predefined-type">Class</span>&lt;T&gt; rawType, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>where a <a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/ext/paramconverter"><code>ParamConverter</code></a> is defined:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ParamConverter</span>&lt;T&gt; {
   T fromString(<span class="predefined-type">String</span> value);
   <span class="predefined-type">String</span> toString(T value);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, consider <code>DateParamConverterProvider</code> and <code>DateParamConverter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Provider</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">DateParamConverterProvider</span> <span class="directive">implements</span> ParamConverterProvider {

   <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Override</span>
   <span class="directive">public</span> T ParamConverterT getConverter(ClassT rawType, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations) {
      <span class="keyword">if</span> (rawType.isAssignableFrom(<span class="predefined-type">Date</span>.class)) {
         <span class="keyword">return</span> (ParamConverterT) <span class="keyword">new</span> DateParamConverter();
      }
      <span class="keyword">return</span> <span class="predefined-constant">null</span>;
   }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">DateParamConverter</span> <span class="directive">implements</span> ParamConverterDate {

   <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> DATE_PATTERN = <span class="string"><span class="delimiter">&quot;</span><span class="content">yyyyMMdd</span><span class="delimiter">&quot;</span></span>;

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="predefined-type">Date</span> fromString(<span class="predefined-type">String</span> param) {
      <span class="keyword">try</span> {
         <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">SimpleDateFormat</span>(DATE_PATTERN).parse(param.trim());
      } <span class="keyword">catch</span> (<span class="exception">ParseException</span> e) {
         <span class="keyword">throw</span> <span class="keyword">new</span> BadRequestException(e);
      }
   }

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> toString(<span class="predefined-type">Date</span> date) {
      <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">SimpleDateFormat</span>(DATE_PATTERN).format(date);
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sending a <code>Date</code> in the form of a query, e.g., "?date=20161217" will cause the string "20161217" to be converted to a <code>Date</code> on the server.</p>
</div>
</div>
<div class="sect2">
<h3 id="_stringparameterunmarshaller"><a class="anchor" href="#_stringparameterunmarshaller"></a>30.3. StringParameterUnmarshaller</h3>
<div class="paragraph">
<p>In addition to the Jakarta RESTful Web Services <code>jakarta.ws.rs.ext.ParamConverterProvider</code>, RESTEasy also has its own <code>org.jboss.resteasy.StringParameterUnmarshaller</code>, defined</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">StringParameterUnmarshaller</span>&lt;T&gt; {
   <span class="type">void</span> setAnnotations(<span class="predefined-type">Annotation</span><span class="type">[]</span> annotations);

   T fromString(<span class="predefined-type">String</span> str);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is similar to <code>jakarta.ws.rs.ext.ParamConverter</code> except that</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it converts only from String&#8217;s;</p>
</li>
<li>
<p>it is configured with the annotations on the injected parameter, which
allows for fine-grained control over the injection; and</p>
</li>
<li>
<p>it is bound to a given parameter by an annotation that is annotated with the meta-annotation <code>org.jboss.resteasy.annotations.StringParameterUnmarshallerBinder:</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.ANNOTATION_TYPE})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> StringParameterUnmarshallerBinder {
   <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> StringParameterUnmarshaller&gt; value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@StringParameterUnmarshallerBinder</span>(TestDateFormatter.class)
<span class="directive">public</span> <span class="annotation">@interface</span> TestDateFormat {
    <span class="predefined-type">String</span> value();
}

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestDateFormatter</span> <span class="directive">implements</span> StringParameterUnmarshallerDate {
  <span class="directive">private</span> <span class="predefined-type">SimpleDateFormat</span> formatter;

  <span class="directive">public</span> <span class="type">void</span> setAnnotations(<span class="predefined-type">Annotation</span><span class="type">[]</span> annotations) {
     TestDateFormat format = FindAnnotation.findAnnotation(annotations, TestDateFormat.class);
     formatter = <span class="keyword">new</span> <span class="predefined-type">SimpleDateFormat</span>(format.value());
  }

  <span class="directive">public</span> <span class="predefined-type">Date</span> fromString(<span class="predefined-type">String</span> str) {
     <span class="keyword">try</span> {
        <span class="keyword">return</span> formatter.parse(str);
     } <span class="keyword">catch</span> (<span class="exception">ParseException</span> e) {
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(e);
     }
  }
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResource</span> {

  <span class="annotation">@GET</span>
  <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/datetest/{date}</span><span class="delimiter">&quot;</span></span>)
  <span class="directive">public</span> <span class="predefined-type">String</span> get(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>) <span class="annotation">@TestDateFormat</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">MM-dd-yyyy</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Date</span> date) {
     <span class="predefined-type">Calendar</span> c = <span class="predefined-type">Calendar</span>.getInstance();
     c.setTime(date);
     <span class="keyword">return</span> date.toString();
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the annotation <code>@StringParameterUnmarshallerBinder</code> on the annotation <code>@TestDateFormat</code> binds the formatter <code>TestDateFormatter</code> to a parameter annotated with <code>@TestDateFormat</code>.
In this example, <code>TestDateFormatter</code> is used to format the <code>Date</code> parameter.
Note also that the parameter "MM-dd-yyyy" to <code>@TestDateFormat</code> is accessible from <code>TestDateFormatter.setAnnotations()</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_collections"><a class="anchor" href="#_collections"></a>30.4. Collections</h3>
<div class="paragraph">
<p>For parameters and properties annotated with <code>@CookieParam</code>, <code>@HeaderParam</code>, <code>@MatrixParam</code>, <code>@PathParam,</code> or <code>@QueryParam</code>, the Jakarta RESTful Web Services
specification [<a href="https://jakarta.ee/specifications/restful-ws/3.1/jakarta-restful-ws-spec-3.1" class="bare">https://jakarta.ee/specifications/restful-ws/3.1/jakarta-restful-ws-spec-3.1</a>] allows conversion as defined in the Javadoc of the corresponding annotation.
In general, the following types are supported:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Types for which a <code>ParamConverter</code> is available via a registered <code>ParamConverterProvider</code>. See Javadoc for these classes for more information.</p>
</li>
<li>
<p>Primitive types.</p>
</li>
<li>
<p>Types that have a constructor that accepts a single <code>String</code> argument.</p>
</li>
<li>
<p>Types that have a static method named <code>valueOf</code> or <code>fromString</code> with a single <code>String</code> argument that return an instance of the type. If both methods are present then <code>valueOf</code> MUST be used unless the type is an enum in which case <code>fromString</code> MUST be used.</p>
</li>
<li>
<p><code>List&lt;T&gt;</code>, <code>Set&lt;T&gt;</code>, or <code>SortedSet&lt;T&gt;</code>, where <code>T</code> satisfies 3 or 4 above.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Items 1, 3, and 4 have been discussed above, and item 2 is obvious.
Note that item 5 allows for collections of parameters.
How these collections are expressed in HTTP messages depends, by default, on the particular kind of parameter.
In most cases, the notation for collections is based on convention rather than a specification.</p>
</div>
<div class="sect3">
<h4 id="_queryparam_2"><a class="anchor" href="#_queryparam_2"></a>30.4.1. @QueryParam</h4>
<div class="paragraph">
<p>For example, a multivalued query parameter is conventionally expressed like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://bluemonkeydiamond.com?q=1q=2q=3</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, there is a query with name "q" and value {1, 2, 3}. This notation is further supported in Jakarta RESTful Web Services by the method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getQueryParameters();</code></pre>
</div>
</div>
<div class="paragraph">
<p>in <code>jakarta.ws.rs.core.UriInfo</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_matrixparam_2"><a class="anchor" href="#_matrixparam_2"></a>30.4.2. @MatrixParam</h4>
<div class="paragraph">
<p>There is no specified syntax for collections derived from matrix parameters, but</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>matrix parameters in a URL segment are conventionally separated by ";", and</p>
</li>
<li>
<p>the method</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getMatrixParameters();</code></pre>
</div>
</div>
<div class="paragraph">
<p>in <code>jakarta.ws.rs.core.PathSegment</code> supports extraction of collections from matrix parameters.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>RESTEasy adopts the convention that multiple instances of a matrix parameter with the same name are treated as a collection.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://bluemonkeydiamond.com/sippycup;m=1;m=2;m=3</code></pre>
</div>
</div>
<div class="paragraph">
<p>is interpreted as a matrix parameter on path segment "sippycup" with name "m" and value {1, 2, 3}.</p>
</div>
</div>
<div class="sect3">
<h4 id="_headerparam_2"><a class="anchor" href="#_headerparam_2"></a>30.4.3. @HeaderParam</h4>
<div class="paragraph">
<p>The HTTP 1.1 specification doesn&#8217;t exactly specify that multiple components of a header value should be separated by commas, but commas are used in those headers that naturally use lists, e.g.
Accept and Allow.
Also, note that the method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; getRequestHeaders();</code></pre>
</div>
</div>
<div class="paragraph">
<p>in <code>jakarta.ws.rs.core.HttpHeaders</code> returns a <code>MultivaluedMap</code>.
It is natural, then, for RESTEasy to treat</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>x-header: a, b, c</code></pre>
</div>
</div>
<div class="paragraph">
<p>as mapping name "x-header" to set {a, b, c}.</p>
</div>
</div>
<div class="sect3">
<h4 id="_cookieparam_2"><a class="anchor" href="#_cookieparam_2"></a>30.4.4. @CookieParam</h4>
<div class="paragraph">
<p>The syntax for cookies is specified, but, unfortunately, it is specified in multiple competing specifications.
Typically, multiple name=value cookie pairs are separated by ";". However, unlike the case with query and matrix parameters, there is no specified Jakarta RESTful Web Services method that returns a collection of cookie values.
Consequently, if two cookies with the same name are received on the server and directed to a collection typed parameter, RESTEasy will inject only the second one.
Note, in fact, that the method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Cookie&gt; getCookies();</code></pre>
</div>
</div>
<div class="paragraph">
<p>in <code>jakarta.ws.rs.core.HttpHeaders</code> returns a <code>Map</code> rather than a <code>MultivaluedMap</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pathparam_2"><a class="anchor" href="#_pathparam_2"></a>30.4.5. @PathParam</h4>
<div class="paragraph">
<p>Deriving a collection from path segments is somewhat less natural than it is for other parameters, but Jakarta RESTful Web Services supports the injection of multiple <code>jakarta.ws.rs.core.PathSegment</code>.
There are a couple of ways of obtaining multiple <code>PathSegment</code>.
One is through the use of multiple path variables with the same name.
For example, the result of calling <code>testTwoSegmentsArray()</code> and <code>testTwoSegmentsList()</code> in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResource</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{segment}/{other}/{segment}/array</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response getTwoSegmentsArray(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">segment</span><span class="delimiter">&quot;</span></span>) PathSegment<span class="type">[]</span> segments) {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">array segments: </span><span class="delimiter">&quot;</span></span> + segments.length);
      <span class="keyword">return</span> Response.ok().build();
   }

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{segment}/{other}/{segment}/list</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response getTwoSegmentsList(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">segment</span><span class="delimiter">&quot;</span></span>) ListPathSegment segments) {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">list segments: </span><span class="delimiter">&quot;</span></span> + segments.size());
      <span class="keyword">return</span> Response.ok().build();
   }
}

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testTwoSegmentsArray() <span class="directive">throws</span> <span class="exception">Exception</span> {
      Invocation.Builder request = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/a/b/c/array</span><span class="delimiter">&quot;</span></span>).request();
      Response response = request.get();
      Assert.assertEquals(<span class="integer">200</span>, response.getStatus());
      response.close();
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testTwoSegmentsList() <span class="directive">throws</span> <span class="exception">Exception</span> {
      Invocation.Builder request = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/a/b/c/list</span><span class="delimiter">&quot;</span></span>).request();
      Response response = request.get();
      Assert.assertEquals(<span class="integer">200</span>, response.getStatus());
      response.close();
   }</code></pre>
</div>
</div>
<div class="paragraph">
<p>is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>array segments: 2
list segments: 2</code></pre>
</div>
</div>
<div class="paragraph">
<p>An alternative is to use a wildcard template parameter.
For example, the output of calling <code>testWildcardArray()</code> and <code>testWildcardList()</code> in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResource</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{segments:.*}/array</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response getWildcardArray(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">segments</span><span class="delimiter">&quot;</span></span>) PathSegment<span class="type">[]</span> segments) {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">array segments: </span><span class="delimiter">&quot;</span></span> + segments.length);
      <span class="keyword">return</span> Response.ok().build();
   }

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{segments:.*}/list</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response getWildcardList(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">segments</span><span class="delimiter">&quot;</span></span>) ListPathSegment segments) {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">list segments: </span><span class="delimiter">&quot;</span></span> + segments.size());
      <span class="keyword">return</span> Response.ok().build();
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testWildcardArray() <span class="directive">throws</span> <span class="exception">Exception</span> {
      Invocation.Builder request = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/a/b/c/array</span><span class="delimiter">&quot;</span></span>).request();
      Response response = request.get();
      response.close();
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testWildcardList() <span class="directive">throws</span> <span class="exception">Exception</span> {
      Invocation.Builder request = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/a/b/c/list</span><span class="delimiter">&quot;</span></span>).request();
      Response response = request.get();
      response.close();
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>array segments: 3
list segments: 3</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extension_to_paramconverter_semantics"><a class="anchor" href="#_extension_to_paramconverter_semantics"></a>30.5. Extension to <code>ParamConverter</code> semantics</h3>
<div class="paragraph">
<p>In the Jakarta RESTful Web Services semantics, a <code>ParamConverter</code> is supposed to convert a single <code>String</code> that represents an individual object.
RESTEasy extends the semantics to allow a <code>ParamConverter</code> to parse the <code>String</code> representation of multiple objects and
generate a <code>List&lt;T&gt;</code>, <code>Set&lt;T&gt;</code>, <code>SortedSet&lt;T&gt;</code>, array, or, indeed, any multivalued data structure whatever.
First, consider the resource</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">queryParam</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResource</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response conversion(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">q</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; list) {
      <span class="keyword">return</span> Response.ok(stringify(list)).build();
   }
}

<span class="directive">private</span> <span class="directive">static</span> &lt;T&gt; <span class="predefined-type">String</span> stringify(<span class="predefined-type">List</span>&lt;T&gt; list) {
   <span class="predefined-type">StringBuilder</span> sb = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
   <span class="keyword">for</span> (T s : list) {
      sb.append(s).append(<span class="string"><span class="delimiter">'</span><span class="content">,</span><span class="delimiter">'</span></span>);
   }
   <span class="keyword">return</span> sb.toString();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calling <code>TestResource</code> as follows, using the standard notation,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testQueryParamStandard() <span class="directive">throws</span> <span class="exception">Exception</span> {
   Client client = ClientBuilder.newClient();
   Invocation.Builder request = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/queryParam?q=20161217q=20161218q=20161219</span><span class="delimiter">&quot;</span></span>).request();
   Response response = request.get();
   <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">response: </span><span class="delimiter">&quot;</span></span> + response.readEntity(<span class="predefined-type">String</span>.class));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>results in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>response: 20161217,20161218,20161219,</code></pre>
</div>
</div>
<div class="paragraph">
<p>Suppose, instead, that we want to use a comma separated notation.
We can add</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MultiValuedParamConverterProvider</span> <span class="directive">implements</span> ParamConverterProvider {

   <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Override</span>
   <span class="directive">public</span> &lt;T&gt; ParamConverter&lt;T&gt; getConverter(<span class="predefined-type">Class</span>&lt;T&gt; rawType, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations) {
      <span class="keyword">if</span> (<span class="predefined-type">List</span>.class.isAssignableFrom(rawType)) {
         <span class="keyword">return</span> (ParamConverterT) <span class="keyword">new</span> MultiValuedParamConverter();
      }
      <span class="keyword">return</span> <span class="predefined-constant">null</span>;
   }
}

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MultiValuedParamConverter</span> <span class="directive">implements</span> ParamConverter&lt;<span class="predefined-type">List</span>&lt;?&gt;&gt; {

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="predefined-type">List</span>&lt;?&gt; fromString(<span class="predefined-type">String</span> param) {
      <span class="keyword">if</span> (param == <span class="predefined-constant">null</span> || param.trim().isEmpty()) {
         <span class="keyword">return</span> <span class="predefined-constant">null</span>;
      }
      <span class="keyword">return</span> parse(param.split(<span class="string"><span class="delimiter">&quot;</span><span class="content">,</span><span class="delimiter">&quot;</span></span>));
   }

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> toString(<span class="predefined-type">List</span>&lt;?&gt; list) {
      <span class="keyword">if</span> (list == <span class="predefined-constant">null</span> || list.isEmpty()) {
         <span class="keyword">return</span> <span class="predefined-constant">null</span>;
      }
      <span class="keyword">return</span> stringify(list);
   }

   <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; parse(<span class="predefined-type">String</span><span class="type">[]</span> params) {
      <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; list = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">String</span>&gt;();
      <span class="keyword">for</span> (<span class="predefined-type">String</span> param : params) {
         list.add(param);
      }
      <span class="keyword">return</span> list;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can call</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testQueryParamCustom() <span class="directive">throws</span> <span class="exception">Exception</span> {
   Client client = ClientBuilder.newClient();
   Invocation.Builder request = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/queryParam?q=20161217,20161218,20161219</span><span class="delimiter">&quot;</span></span>).request();
   Response response = request.get();
   <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">response: </span><span class="delimiter">&quot;</span></span> + response.readEntity(<span class="predefined-type">String</span>.class));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and get</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>response: 20161217,20161218,20161219,</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in this case, <code>MultiValuedParamConverter.fromString()</code> creates and returns an <code>ArrayList</code>, so <code>TestResource.conversion()</code> could be rewritten</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">queryParam</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResource</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response conversion(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">q</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">String</span>&gt; list) {
      <span class="keyword">return</span> Response.ok(stringify(list)).build();
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, <code>MultiValuedParamConverter</code> could be rewritten to return a <code>LinkList</code> and the parameter list in <code>TestResource.conversion()</code> could be either a <code>List</code> or a <code>LinkedList</code>.</p>
</div>
<div class="paragraph">
<p>Finally, note that this extension works for arrays as well.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">  <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Foo</span> {
      <span class="directive">private</span> <span class="predefined-type">String</span> foo;
      <span class="directive">public</span> Foo(<span class="predefined-type">String</span> foo) {<span class="local-variable">this</span>.foo = foo;}
      <span class="directive">public</span> <span class="predefined-type">String</span> getFoo() {<span class="keyword">return</span> foo;}
   }

   <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">FooArrayParamConverter</span> <span class="directive">implements</span> ParamConverter&lt;Foo<span class="type">[]</span>&gt; {

      <span class="annotation">@Override</span>
      <span class="directive">public</span> Foo<span class="type">[]</span> fromString(<span class="predefined-type">String</span> value) {
         <span class="predefined-type">String</span><span class="type">[]</span> ss = value.split(<span class="string"><span class="delimiter">&quot;</span><span class="content">,</span><span class="delimiter">&quot;</span></span>);
         Foo<span class="type">[]</span> fs = <span class="keyword">new</span> Foo[ss.length];
         <span class="type">int</span> i = <span class="integer">0</span>;
         <span class="keyword">for</span> (<span class="predefined-type">String</span> s : ss) {
            fs[i++] = <span class="keyword">new</span> Foo(s);
         }
         <span class="keyword">return</span> fs;
      }

      <span class="annotation">@Override</span>
      <span class="directive">public</span> <span class="predefined-type">String</span> toString(Foo<span class="type">[]</span> values) {
         <span class="predefined-type">StringBuffer</span> sb = <span class="keyword">new</span> <span class="predefined-type">StringBuffer</span>();
          <span class="keyword">for</span> (Foo value : values) {
              sb.append(value.getFoo()).append(<span class="string"><span class="delimiter">&quot;</span><span class="content">,</span><span class="delimiter">&quot;</span></span>);
          }
         <span class="keyword">if</span> (sb.length() &lt; <span class="integer">0</span>) {
            sb.deleteCharAt(sb.length() - <span class="integer">1</span>);
         }
         <span class="keyword">return</span> sb.toString();
      }
   }

   <span class="annotation">@Provider</span>
   <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">FooArrayParamConverterProvider</span> <span class="directive">implements</span> ParamConverterProvider {

      <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
      <span class="annotation">@Override</span>
      <span class="directive">public</span> &lt;T&gt; ParamConverter&lt;T&gt; getConverter(<span class="predefined-type">Class</span>&lt;T&gt; rawType, <span class="predefined-type">Type</span> genericType, <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations) {
         <span class="keyword">if</span> (rawType.equals(Foo<span class="type">[]</span>.class))
            <span class="keyword">return</span> (ParamConverter&lt;T&gt;) <span class="keyword">new</span> FooArrayParamConverter();
         <span class="keyword">return</span> <span class="predefined-constant">null</span>;
      }
   }

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">ParamConverterResource</span> {

      <span class="annotation">@GET</span>
      <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
      <span class="directive">public</span> Response test(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">foos</span><span class="delimiter">&quot;</span></span>) Foo<span class="type">[]</span> foos) {
         <span class="keyword">return</span> Response.ok(<span class="keyword">new</span> FooArrayParamConverter().toString(foos)).build();
      }
   }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_default_multiple_valued_paramconverter"><a class="anchor" href="#_default_multiple_valued_paramconverter"></a>30.6. Default multiple valued <code>ParamConverter</code></h3>
<div class="paragraph">
<p>RESTEasy includes two built-in ParamConverter&#8217;s in the resteasy-core module, one for collections:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>org.jboss.resteasy.plugins.providers.MultiValuedCollectionParamConverter,</code></pre>
</div>
</div>
<div class="paragraph">
<p>and one for arrays:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>org.jboss.resteasy.plugins.providers.MultiValuedArrayParamConverter,</code></pre>
</div>
</div>
<div class="paragraph">
<p>which implement the concepts in the previous section.</p>
</div>
<div class="paragraph">
<p>In particular, <code>MultiValued*ParamConverter.fromString()</code> can transform a string representation coming over the network into a <code>Collection</code> or array, and <code>MultiValued*ParamConverter.toString()</code> can be used by a client side proxy to transform `Collection`s or arrays into a string representation.</p>
</div>
<div class="paragraph">
<p>String representations are determined by <code>org.jboss.resteasy.annotations.Separator</code>, a parameter annotation in the resteasy-core module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.PARAMETER})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Separator {
   <span class="predefined-type">String</span> value() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of <code>Separator.value()</code> is used to separate individual elements of a <code>Collection</code> or array.
For example, a proxy implementing</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">path/separator/multi/{p}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> pathMultiSeparator(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>) <span class="annotation">@Separator</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">-</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; ss);</code></pre>
</div>
</div>
<div class="paragraph">
<p>will turn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; list = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;<span class="predefined-type">String</span>&gt;();
list.add(<span class="string"><span class="delimiter">&quot;</span><span class="content">abc</span><span class="delimiter">&quot;</span></span>);
list.add(<span class="string"><span class="delimiter">&quot;</span><span class="content">xyz</span><span class="delimiter">&quot;</span></span>);
proxy.pathMultiSeparator(list);</code></pre>
</div>
</div>
<div class="paragraph">
<p>and "path/separator/multi/{p}" into "&#8230;&#8203;/path/separator/multi/abc-xyz". On the server side, the RESTEasy runtime will turn "abc-xyz" back into a list consisting of elements "abc" and "xyz" for</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">path/separator/multi/{p}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@GET</span>
<span class="directive">public</span> <span class="predefined-type">String</span> pathMultiSeparator(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>) <span class="annotation">@Separator</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">-</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; ss) {
    <span class="keyword">return</span> <span class="predefined-type">String</span>.join(<span class="string"><span class="delimiter">&quot;</span><span class="content">|</span><span class="delimiter">&quot;</span></span>, ss);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>which will return "abc|xyz|".</p>
</div>
<div class="paragraph">
<p>In fact, the value of the <code>Separator</code> annotations may be a more general regular expression, which is passed to <code>String.split()</code>.
For example, "[-,;]" tells the server side to break up a string using either "-", ",", or ";". On the client side, a string will be created using the first element, "-" in this case.</p>
</div>
<div class="paragraph">
<p>If a parameter is annotated with <code>@Separator</code> with no value, then the default value is</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"," for a <code>@HeaderParam</code>, <code>@MatrixParam</code>, <code>@PathParam</code>, or <code>@QueryParam</code>, and</p>
</li>
<li>
<p>"-" for a <code>@CookieParam</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The MultiValued*ParamConverter&#8217;s depend on existing facilities for handling the individual elements.
On the server side, once it has parsed the incoming string into substrings, <code>MultiValued*ParamConverter</code> turns each substring into an Java object according to Section 3.2 "Fields and Bean Properties" of the Jakarta RESTful Web Services specification.
On the client side, <code>MultiValued*ParamConverter</code> turns a Java object into a string as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>look for a <code>ParamConverter</code>;</p>
</li>
<li>
<p>if there is no suitable <code>ParamConverter</code> and the parameter is labeled <code>@HeaderParam</code>, look for a <code>HeaderDelegate</code>; or</p>
</li>
<li>
<p>call <code>toString()</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These `ParamConverter`s are meant to be fairly general, but there are a number of restrictions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>They don&#8217;t handle nested <code>Collections</code> or arrays. That is, <code>List&lt;String&gt;</code> and <code>String[]</code> are OK, but <code>List&lt;List&lt;String&gt;&gt;</code> and <code>String[][]</code> are not.</p>
</li>
<li>
<p>The regular expression used in Separator must match the regular expression</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&quot;\\p{Punct}|\\[\\p{Punct}+\\]&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is, it must be either a single instance of a punctuation symbol, i.e., a symbol in the set</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>!&quot;#$%'()*+,-./:;=?@[\]^_`{|}~</code></pre>
</div>
</div>
<div class="paragraph">
<p>or a class of punctuation symbols like "[-,;]".</p>
</div>
</li>
<li>
<p>For either of these ParamConverter&#8217;s to be available for use with a given parameter, that parameter must be annotated with <code>@Separator</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There are also some logical restrictions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Cookie syntax, as specified in <a href="https://tools.ietf.org/html/rfc6265#section-4.1.1" class="bare">https://tools.ietf.org/html/rfc6265#section-4.1.1</a>, assigns a meaning to ";", so it cannot be used as a separator.</p>
</li>
<li>
<p>If a separator character appears in the content of an element, then there will be problems. For example, if "," is
used as a separator, then, if a proxy sends the array <code>["a","b,c","d"]</code>, it will turn into the  string "a,b,c,d" on
the wire and be reconstituted on the server as four elements.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These built-in `ParamConverter`s have the lowest priority, so any user supplied ParamConverter&#8217;s will be tried first.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_responses_using_jakarta.ws.rs.core.response"><a class="anchor" href="#_responses_using_jakarta.ws.rs.core.response"></a>31. Responses using jakarta.ws.rs.core.Response</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Custom responses can be built using the <code>jakarta.ws.rs.core.Response</code> and <code>ResponseBuilder</code> classes.
To do your own streaming, your entity response must be an implementation of
<a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/core/streamingoutput"><code>jakarta.ws.rs.core.StreamingOutput</code></a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exceptionhandling"><a class="anchor" href="#_exceptionhandling"></a>32. Exception Handling</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exceptionmappers"><a class="anchor" href="#_exceptionmappers"></a>32.1. Exception Mappers</h3>
<div class="paragraph">
<p>ExceptionMappers are custom, application provided, components that can catch thrown application exceptions and write specific HTTP responses.
They are classes annotated with <code>@Provider</code> and implement the <a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/ext/exceptionmapper"><code>ExceptionMapper</code></a> interface.</p>
</div>
<div class="paragraph">
<p>When an application exception is thrown it will be caught by the Jakarta RESTful Web Services runtime.
Jakarta RESTful Web Services will then scan registered ExceptionMappers to see which one support marshalling the exception type thrown.
Here is an example of ExceptionMapper</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Provider</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">EJBExceptionMapper</span> <span class="directive">implements</span> ExceptionMapper&lt;EJBException&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> Response toResponse(EJBException exception) {
       <span class="keyword">return</span> Response.status(<span class="integer">500</span>).build();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>ExceptionMappers are registered the same way as MessageBodyReader/Writers.
By scanning for <code>@Provider</code> annotated classes, or programmatically through the <code>ResteasyProviderFactory</code> class.</p>
</div>
<div class="paragraph">
<p>As of RESTEasy 6.1 if a default <code>ExceptionMapper</code> is registered.
It handles all uncaught exceptions and returns a response with the exception&#8217;s message and a status of 500.
If the exception is a <code>WebApplicationException</code> the response from the exception is returned.
This can be turned off by setting the <code>dev.resteasy.exception.mapper</code> to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>The default <code>ExceptionMapper</code> will also log the exception at a error level.
The logger name is <code>org.jboss.resteasy.core.providerfactory.DefaultExceptionMapper</code> which can be used to disable these log messages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_builtinexception"><a class="anchor" href="#_builtinexception"></a>32.2. RESTEasy Built-in Internally-Thrown Exceptions</h3>
<div class="paragraph">
<p>RESTEasy has a set of built-in exceptions that are thrown when it encounters errors during dispatching or marshalling.
They all revolve around specific HTTP error codes.
They can be found in RESTEasy&#8217;s javadoc under the package org.jboss.resteasy.spi.
Here&#8217;s a list of them:</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Exception</th>
<th class="tableblock halign-left valign-top">HTTP Code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ReaderException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All exceptions thrown from MessageBodyReaders are wrapped within this exception.  If there is no <code>ExceptionMapper</code> for the
wrapped exception or if the exception isn&#8217;t a <code>WebApplicationException</code>, then resteasy will return a 400 code by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WriterException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All exceptions thrown from MessageBodyWriters are wrapped within this exception.  If there is no <code>ExceptionMapper</code> for the
wrapped exception or if the exception isn&#8217;t a `WebApplicationExceptio`n, then resteasy will return a 400 code by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.jboss.resteasy.plugins.providers.jaxb.`JAXBUnmarshalException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Jakarta RESTful Web Services providers throw this exception on reads. They may be wrapping <code>JAXBExceptions</code>. This class extends <code>ReaderException</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.jboss.resteasy.plugins.providers.jaxb.JAXBMarshalException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Jakarta RESTful Web Services providers throw this exception on writes. They may be wrapping <code>JAXBExceptions</code>. This class extends <code>WriterException</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ApplicationException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This exception wraps all exceptions thrown from application code.  It functions much in the same way as <code>InvocationTargetException</code>.
If there is an <code>ExceptionMapper</code> for wrapped exception, then that is used to handle the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Failure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal RESTEasy. Not logged</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LoggableFailure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal RESTEasy error. Logged</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DefaultOptionsMethodException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the user invokes HTTP OPTIONS and no Jakarta RESTful Web Services method for it, RESTEasy provides a default behavior by throwing this exception.
This is only done if the property <code>dev.resteasy.throw.options.exception</code> is set to true.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JsonProcessingException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Jackson provider throws this exception when JSON data is determined to be invalid.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_resteasywebapplicationexception"><a class="anchor" href="#_resteasywebapplicationexception"></a>32.3. Resteasy WebApplicationExceptions</h3>
<div class="paragraph">
<p>Suppose a client at local.com calls the following resource method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">remote</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> remote() {
    Client client = ClientBuilder.newClient();
    <span class="keyword">return</span> client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost/exception</span><span class="delimiter">&quot;</span></span>).request().get(<span class="predefined-type">String</span>.class);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the call to <a href="http://localhost" class="bare">http://localhost</a> returns a status code 3xx, 4xx, or 5xx, then the <code>Client</code> is obliged by the
Jakarta RESTful Web Services specification to throw a <code>WebApplicationException</code>. Moreover, if the <code>WebApplicationException</code>
contains a <code>Response</code>, which it normally would in RESTEasy, the server runtime is obliged by the Jakarta RESTful Web Services
specification to return that <code>Response</code>. As a result, information from the server at third.party.com, e.g., headers and
body, will get sent back to local.com. The problem is that that information could be, at best, meaningless to the
client and, at worst, a security breach.</p>
</div>
<div class="paragraph">
<p>RESTEasy has a solution that works around the problem and still conforms to the Jakarta RESTful Web Services specification.
In particular, for each <code>WebApplicationException</code> it defines a new subclass:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>WebApplicationException
+-ResteasyWebApplicationException
+-ClientErrorException
| +-ResteasyClientErrorException
| +-BadRequestException
| | +-ResteasyBadRequestException
| +-ForbiddenException
| | +-ResteasyForbiddenException
| +-NotAcceptableException
| | +-ResteasyNotAcceptableException
| +-NotAllowedException
| | +-ResteasyNotAllowedException
| +-NotAuthorizedException
| | +-ResteasyNotAuthorizedException
| +-NotFoundException
| | +-ResteasyNotFoundException
| +-NotSupportedException
| | +-ResteasyNotSupportedException
+-RedirectionException
| +-ResteasyRedirectionException
+-ServerErrorException
| +-ResteasyServerErrorException
| +-InternalServerErrorException
| | +-ResteasyInternalServerErrorException
| +-ServiceUnavailableException
| | +-ResteasyServiceUnavailableException</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new exceptions play the same role as the original ones, but RESTEasy treats them slightly differently.
When a <code>Client</code> detects that it is running in the context of a resource method, it will throw one of the new <code>Exception</code>.
However, instead of storing the original <code>Response</code>, it stores a "sanitized" version of the <code>Response</code>, in which only
the status and the Allow and Content-Type headers are preserved.
The original <code>WebApplicationException</code>, and therefore the original <code>Response</code>, can be accessed in one of two ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Create a NotAcceptableException.</span>
NotAcceptableException nae = <span class="keyword">new</span> NotAcceptableException(Response.status(<span class="integer">406</span>).entity(<span class="string"><span class="delimiter">&quot;</span><span class="content">ooops</span><span class="delimiter">&quot;</span></span>).build());

<span class="comment">// Wrap the NotAcceptableException in a ResteasyNotAcceptableException.</span>
ResteasyNotAcceptableException rnae = (ResteasyNotAcceptableException) WebApplicationExceptionWrapper.wrap(nae);

<span class="comment">// Extract the original NotAcceptableException using instance method.</span>
NotAcceptableException nae2 = rnae.unwrap();
Assertions.assertEquals(nae, nae2);

<span class="comment">// Extract the original NotAcceptableException using class method.</span>
NotAcceptableException nae3 = (NotAcceptableException) WebApplicationExceptionWrapper.unwrap(nae); <span class="comment">// second way</span>
Assertions.assertEquals(nae, nae3);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this change is intended to introduce a safe default behavior in the case that the <code>Exception</code> generated by the
remote call is allowed to make its way up to the server runtime. It is considered a good practice, though, to catch the
<code>Exception</code> and treat it in some appropriate manner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">remote/{i}</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> remote(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">i</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> i) <span class="directive">throws</span> <span class="exception">Exception</span> {
  Client client = ClientBuilder.newClient();
  <span class="keyword">try</span> {
     <span class="keyword">return</span> client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost/exception/</span><span class="delimiter">&quot;</span></span> + i).request().get(<span class="predefined-type">String</span>.class);
  } <span class="keyword">catch</span> (WebApplicationException wae) {
      LOGGER.errorf(wae, <span class="string"><span class="delimiter">&quot;</span><span class="content">Failed to execute %s</span><span class="delimiter">&quot;</span></span>, i);
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While RESTEasy will default to the new, safer behavior, the original behavior can be restored by setting the
configuration parameter <code>resteasy.original.webapplicationexception.behavior</code> to "true".
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_overring_resteasy_exceptions"><a class="anchor" href="#_overring_resteasy_exceptions"></a>32.4. Overriding RESTEasy Builtin Exceptions</h3>
<div class="paragraph">
<p>RESTEasy built-in exceptions can be overridden by writing an <code>ExceptionMapper</code> for the exception.
You can write an <code>ExceptionMapper</code> for any thrown exception including <code>WebApplicationException</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gzip"><a class="anchor" href="#_gzip"></a>33. Content encoding</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gzip_compressiondecompression"><a class="anchor" href="#_gzip_compressiondecompression"></a>33.1. GZIP Compression/Decompression</h3>
<div class="paragraph">
<p>RESTEasy supports (though not by default - see below) GZIP decompression. If properly configured, the client framework
or a Jakarta RESTful Web Services service, upon receiving a message body with a Content-Encoding of "gzip", will automatically
decompress it. The client framework can (though not by default - see below) automatically set the Accept-Encoding
header to be "gzip, deflate", so you do not have to set this header yourself.</p>
</div>
<div class="paragraph">
<p>RESTEasy also supports (though not by default - see below) automatic compression.
If the client framework is sending a request or the server is sending a response with the Content-Encoding header set to "gzip", RESTEasy will (if properly configured) do the compression.
So that you do not have to set the Content-Encoding header directly, you can use the @org.jboss.resteasy.annotation.GZIP annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MyProxy</span> {

   <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@PUT</span>
   <span class="type">void</span> put(<span class="annotation">@GZIP</span> Order order);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, we tag the outgoing message body, order, to be gzip compressed.
The same annotation can be used to tag server responses</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyService</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@GZIP</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getData() {}
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_configuring"><a class="anchor" href="#_configuring"></a>33.1.1. Configuring GZIP compression / decompression</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Decompression carries a risk of attack from a bad actor that can package an entity that will expand greatly.
Consequently, RESTEasy disables GZIP compression / decompression by default.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are three interceptors that are relevant to GZIP compression / decompression:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>org.jboss.resteasy.plugins.interceptors.GZIPDecodingInterceptor</code>: If the Content-Encoding header is present and has the value "gzip", <code>GZIPDecodingInterceptor</code> will install an <code>InputStream</code> that decompresses the message body.</p>
</li>
<li>
<p><code>org.jboss.resteasy.plugins.interceptors.GZIPEncodingInterceptor</code>: If the Content-Encoding header is present and has the value "gzip", <code>GZIPEncodingInterceptor</code> will install an <code>OutputStream</code> that compresses the message body.</p>
</li>
<li>
<p><code>org.jboss.resteasy.plugins.interceptors.AcceptEncodingGZIPFilter</code>:  If the Accept-Encoding header does not exist, <code>AcceptEncodingGZIPFilter</code> will add Accept-Encoding with the value "gzip, deflate". If the Accept-Encoding header exists but does not contain "gzip", <code>AcceptEncodingGZIPFilter</code> will append ", gzip". Note that enabling GZIP compression / decompression does not depend on the presence of this interceptor.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If GZIP decompression is enabled, an upper limit is imposed on the number of bytes <code>GZIPDecodingInterceptor</code> will extract from a compressed message body.
The default limit is 10,000,000, but a different value can be configured.
See below.</p>
</div>
<div class="sect4">
<h5 id="_server_side_configuration"><a class="anchor" href="#_server_side_configuration"></a>Server side configuration</h5>
<div class="paragraph">
<p>The interceptors may be enabled by including their classnames in a META-INF/services/jakarta.ws.rs.ext.Providers file on the classpath.
The upper limit on deflated files may be configured by setting the parameter "resteasy.gzip.max.input". [See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.] If the limit is exceeded on the server side, <code>GZIPDecodingInterceptor</code> will return a <code>Response</code> with status 413 ("Request Entity Too Large") and a message specifying the upper limit.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As of release 3.1.0.Final, the GZIP interceptors have moved from package <code>org.jboss.resteasy.plugins.interceptors.encoding</code> to <code>org.jboss.resteasy.plugins.interceptors</code> and they should be named accordingly in <code>jakarta.ws.rs.ext.Providers</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_client_side_configuration"><a class="anchor" href="#_client_side_configuration"></a>Client side configuration</h5>
<div class="paragraph">
<p>The interceptors may be enabled by registering them with a <code>Client</code> or <code>WebTarget</code>.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newBuilder() <span class="comment">// Activate gzip compression on client:</span>
                    .register(AcceptEncodingGZIPFilter.class)
                    .register(GZIPDecodingInterceptor.class)
                    .register(GZIPEncodingInterceptor.class)
                    .build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The upper limit on deflated files may be configured by creating an instance of <code>GZIPDecodingInterceptor</code> with a specific value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newBuilder() <span class="comment">// Activate gzip compression on client:</span>
                    .register(AcceptEncodingGZIPFilter.class)
                    .register(<span class="keyword">new</span> GZIPDecodingInterceptor(<span class="integer">256</span>))
                    .register(GZIPEncodingInterceptor.class)
                    .build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the limit is exceeded on the client side, <code>GZIPDecodingInterceptor</code> will throw a <code>ProcessingException</code> with a message specifying the upper limit.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_general_content_encoding"><a class="anchor" href="#_general_content_encoding"></a>33.2. General content encoding</h3>
<div class="paragraph">
<p>The designation of a compressible entity by the use of the <code>@GZIP</code> annotation is a built-in, specific instance of a more general facility supported by RESTEasy.
There are three components to this facility.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The annotation <code>org.jboss.resteasy.annotations.ContentEncoding</code> is a "meta-annotation" used on other annotations to
indicate that they represent a Content-Encoding. For example, @GZIP is defined</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD, <span class="predefined-type">ElementType</span>.PARAMETER})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@ContentEncoding</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">gzip</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="annotation">@interface</span> GZIP {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of @ContentEncoding indicates the represented Content-Encoding. For <code>@GZIP</code> it is "gzip".</p>
</div>
</li>
<li>
<p><code>ClientContentEncodingAnnotationFeature</code> and <code>ServerContentEncodingAnnotationFeature</code>, two <code>DynamicFeatures</code> in
package <code>org.jboss.resteasy.plugins.interceptors</code>, examine resource methods for annotations decorated with
<code>@ContentEncoding</code>.</p>
</li>
<li>
<p>For each value found in a <code>@ContentEncoding</code> decorated annotation on a resource method, an instance of
<code>ClientContentEncodingAnnotationFilter</code> or <code>ServerContentEncodingAnnotationFilter</code>, <code>jakarta.ws.rs.ext.WriterInterceptors</code>
in package <code>org.jboss.resteasy.plugins.interceptors</code>, is registered. They are responsible for adding an appropriate
Content-Encoding header. For example, <code>ClientContentEncodingAnnotationFilter</code> is defined.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ConstrainedTo</span>(RuntimeType.CLIENT)
<span class="annotation">@Priority</span>(Priorities.HEADER_DECORATOR)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ClientContentEncodingAnnotationFilter</span> <span class="directive">implements</span> WriterInterceptor {
   <span class="directive">protected</span> <span class="predefined-type">String</span> encoding;

   <span class="directive">public</span> ClientContentEncodingAnnotationFilter(<span class="predefined-type">String</span> encoding) {
      <span class="local-variable">this</span>.encoding = encoding;
   }

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="type">void</span> aroundWriteTo(WriterInterceptorContext context) {
      context.getHeaders().putSingle(HttpHeaders.CONTENT_ENCODING, encoding);
      context.proceed();
   }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The annotation <code>@GZIP</code> is built into RESTEasy, but <code>ClientContentEncodingAnnotationFeature</code> and <code>ServerContentEncodingAnnotationFeature</code> will also recognize application defined annotations.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD, <span class="predefined-type">ElementType</span>.PARAMETER})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@ContentEncoding</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">compress</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="annotation">@interface</span> Compress {
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResource</span> {

  <span class="annotation">@GET</span>
  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>)
  <span class="annotation">@Compress</span>
  <span class="directive">public</span> <span class="predefined-type">String</span> a() {
     <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>TestResource.a()</code> is invoked as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testCompress() <span class="directive">throws</span> <span class="exception">Exception</span> {
  <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
      Invocation.Builder request = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/a</span><span class="delimiter">&quot;</span></span>).request();
      request.acceptEncoding(<span class="string"><span class="delimiter">&quot;</span><span class="content">gzip,compress</span><span class="delimiter">&quot;</span></span>);
      Response response = request.get();
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">content-encoding: </span><span class="delimiter">&quot;</span></span>+ response.getHeaderString(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Encoding</span><span class="delimiter">&quot;</span></span>));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the output will be</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>content-encoding: compress</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cors"><a class="anchor" href="#_cors"></a>34. CORS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy has a <code>ContainerRequestFilter</code> that can be used to handle CORS preflight and actual requests. <code>org.jboss.resteasy.plugins.interceptors.CorsFilter</code>.
You must allocate this and register it as a singleton provider from your Application class.
See the javadoc or its various settings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CorsFilter filter = <span class="keyword">new</span> CorsFilter();
filter.getAllowedOrigins().add(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contentrange"><a class="anchor" href="#_contentrange"></a>35. Content-Range Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy supports <code>Range</code> requests for <code>java.io.File</code> response entities.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Resource</span> {
  <span class="annotation">@GET</span>
  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">file</span><span class="delimiter">&quot;</span></span>)
  <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
  <span class="directive">public</span> <span class="predefined-type">File</span> getFile(){
     <span class="keyword">return</span> file;
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response response = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/file</span><span class="delimiter">&quot;</span></span>)).request()
      .header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Range</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">1-4</span><span class="delimiter">&quot;</span></span>).get();
Assertions.assertEquals(response.getStatus(), <span class="integer">206</span>);
Assertions.assertEquals(<span class="integer">4</span>, response.getLength());
<span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Range: </span><span class="delimiter">&quot;</span></span> + response.getHeaderString(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Range</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cache_nocache_cachecontrol"><a class="anchor" href="#_cache_nocache_cachecontrol"></a>36. RESTEasy Caching Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy provides numerous annotations and facilities to support HTTP caching semantics.
Annotations to make setting Cache-Control headers easier and both server-side and client-side in-memory caches are available.</p>
</div>
<div class="sect2">
<h3 id="_cache_annotation"><a class="anchor" href="#_cache_annotation"></a>36.1. @Cache and @NoCache Annotations</h3>
<div class="paragraph">
<p>RESTEasy provides an extension to Jakarta RESTful Web Services that allows you to automatically set Cache-Control headers on a successful GET request.
It can only be used on @GET annotated methods.
A successful <code>@GET</code> request is any request that returns 200 OK response.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.annotations.cache</span>;

<span class="directive">public</span> <span class="annotation">@interface</span> Cache {
   <span class="type">int</span> maxAge() <span class="keyword">default</span> -<span class="integer">1</span>;
   <span class="type">int</span> sMaxAge() <span class="keyword">default</span> -<span class="integer">1</span>;
   <span class="type">boolean</span> noStore() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
   <span class="type">boolean</span> noTransform() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
   <span class="type">boolean</span> mustRevalidate() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
   <span class="type">boolean</span> proxyRevalidate() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
   <span class="type">boolean</span> isPrivate() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}

<span class="directive">public</span> <span class="annotation">@interface</span> NoCache {
   <span class="predefined-type">String</span><span class="type">[]</span> fields() <span class="keyword">default</span> {};
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>While <code>@Cache</code> builds a complex Cache-Control header, @NoCache is a simplified notation to indicate no caching is wanted; i.e.
Cache-Control: nocache.</p>
</div>
<div class="paragraph">
<p>These annotations can be put on the resource class or interface and specifies a default cache value for each @GET resource method, or they can be put individually on each @GET resource method.</p>
</div>
</div>
<div class="sect2">
<h3 id="_client_cache"><a class="anchor" href="#_client_cache"></a>36.2. Client "Browser" Cache</h3>
<div class="paragraph">
<p>RESTEasy has the ability to set up a client-side, browser-like, cache.
It can be used with the Client Proxy Framework, or with ordinary requests.
This cache looks for Cache-Control headers sent back with a server response.
If the Cache-Control headers specify that the client is allowed to cache the response, Resteasy caches it within local memory.
The cache obeys max-age requirements  and will also automatically do HTTP 1.1 cache revalidation if either or both the Last-Modified and/or ETag headers are sent back with the original response.
See the HTTP 1.1 specification for details on how Cache-Control or cache revalidation works.</p>
</div>
<div class="paragraph">
<p>It is very simple to enable caching.
Here&#8217;s an example of using the client cache with the Client Proxy Framework</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/orders</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">OrderServiceClient</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{id}</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@GET</span>
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
   Order getOrder(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a proxy for this interface and enable caching for that proxy requires only a few simple steps in which the <code>BrowserCacheFeature</code> is registered:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResteasyWebTarget target = (ResteasyWebTarget) ClientBuilder.newClient().target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081</span><span class="delimiter">&quot;</span></span>);
BrowserCacheFeature cacheFeature = <span class="keyword">new</span> BrowserCacheFeature();
OrderServiceClient orderService = target.register(cacheFeature).proxy(OrderServiceClient.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>BrowserCacheFeature</code> will create a Resteasy <code>LightweightBrowserCache</code> by default.
It is also possible to configure the cache, or install a completely different cache implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResteasyWebTarget target = (ResteasyWebTarget) ClientBuilder.newClient().target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081</span><span class="delimiter">&quot;</span></span>);
LightweightBrowserCache cache = <span class="keyword">new</span> LightweightBrowserCache();
cache.setMaxBytes(<span class="integer">20L</span>);
BrowserCacheFeature cacheFeature = <span class="keyword">new</span> BrowserCacheFeature();
cacheFeature.setCache(cache);
OrderServiceClient orderService = target.register(cacheFeature).proxy(OrderServiceClient.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If using the standard Jakarta RESTful Web Services client framework to make invocations rather than the proxy framework, it is just as easy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResteasyWebTarget target = (ResteasyWebTarget) ClientBuilder.newClient().target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/orders/{id}</span><span class="delimiter">&quot;</span></span>);
BrowserCacheFeature cacheFeature = <span class="keyword">new</span> BrowserCacheFeature();
target.register(cacheFeature);
<span class="predefined-type">String</span> rtn = target.resolveTemplate(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>).request().get(<span class="predefined-type">String</span>.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The LightweightBrowserCache, by default, has a maximum 2 megabytes of caching space.
This can be changed programmatically by calling its <code>setMaxBytes()</code> method.
If the cache gets full, the cache completely wipes itself of all cached data.
This may seem a bit draconian, but the cache was written to avoid unnecessary synchronizations in a concurrent environment where the cache is  shared between multiple threads.
If a more complex caching solution is desired or a third party cache is to be plugged in please contact our resteasy-developers list and discuss it with the community.</p>
</div>
</div>
<div class="sect2">
<h3 id="_server_cache"><a class="anchor" href="#_server_cache"></a>36.3. Local Server-Side Response Cache</h3>
<div class="paragraph">
<p>RESTEasy has a server-side cache that can sit in front of Jakarta RESTful Web Services services.
It automatically caches marshalled responses from HTTP GET Jakarta RESTful Web Services invocations if, and only if the
Jakarta RESTful Web Services resource method sets a Cache-Control header.
When a GET comes in, the RESTEasy Server Cache checks to see if the URI is stored in the cache.
If found, it returns the already marshalled response without invoking the Jakarta RESTful Web Services method.
Each cache entry has a max age to whatever is specified in the Cache-Control header of the initial request.
The cache also will automatically generate an ETag using an MD5 hash on the response body.
This allows the client to do HTTP 1.1 cache revalidation with the IF-NONE-MATCH header.
The cache is also smart enough to perform revalidation if there is no initial cache hit, but the Jakarta RESTful Web Services method still returns a body that has the same ETag.</p>
</div>
<div class="paragraph">
<p>The cache is also automatically invalidated for a particular URI that has PUT, POST, or DELETE invoked on it.
A reference to the cache can be obtained by injecting an <code>org.jboss.resteasy.plugins.cache.ServerCache</code> via the <code>@Context</code> annotation</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Context</span>
    ServerCache cache;

    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get(<span class="annotation">@Context</span> ServerCache cache) {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To set up the server-side cache an instance of <code>org.jboss.resteasy.plugins.cache.server.ServerCacheFeature</code> must be registered via the Application&#8217;s <code>getSingletons()</code> or <code>getClasses()</code> methods.
The underlying cache is Infinispan.
By default, RESTEasy will create an Infinispan cache for you.
Alternatively, you can create and pass in an instance of your cache to the <code>ServerCacheFeature</code> constructor.
Infinispan can also be configured by specifying various parameters.
If using Maven, add RESTEasy&#8217;s cache-core artifact to the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
   <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy.cache<span class="tag">&lt;/groupId&gt;</span>
   <span class="tag">&lt;artifactId&gt;</span>cache-core<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;version&gt;</span>${version.org.jboss.resteasy.cache}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next set up the Infinispan configuration in the application&#8217;s <code>web.xml</code>, it would look like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>server.request.cache.infinispan.config.file<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>infinispan.xml<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>

    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>server.request.cache.infinispan.cache.name<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>MyCache<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>

<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>server.request.cache.infinispan.config.file</code> can either be a classpath or a file path. <code>server.request.cache.infinispan.cache.name</code> is the name of the cache to reference that is declared in the config file.</p>
</div>
<div class="paragraph">
<p>See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_http_precondition"><a class="anchor" href="#_http_precondition"></a>36.4. HTTP preconditions</h3>
<div class="paragraph">
<p>Jakarta RESTful Web Services provides an API for evaluating HTTP preconditions based on <code>"If-Match"</code>, <code>"If-None-Match"</code>, <code>"If-Modified-Since"</code> and <code>"If-Unmodified-Since"</code> headers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Response.ResponseBuilder rb = request.evaluatePreconditions(lastModified, etag);</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, RESTEasy will return status code 304 (Not modified) or 412 (Precondition failed) if any of conditions fails, however it is not compliant with RFC 7232 which states that headers <code>"If-Match"</code>, <code>"If-None-Match"</code> MUST have higher precedence.
RFC 7232 compatible mode can be enabled by setting the parameter <code>resteasy.rfc7232preconditions</code> to <code>true</code>.
See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interceptors"><a class="anchor" href="#_interceptors"></a>37. Filters and Interceptors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jakarta RESTful Web Services has two different concepts for interceptions: Filters and Interceptors. Filters are mainly used to modify
or process incoming and outgoing request headers or response headers. They execute before and after request and response
processing.</p>
</div>
<div class="sect2">
<h3 id="_server_side_filters"><a class="anchor" href="#_server_side_filters"></a>37.1. Server Side Filters</h3>
<div class="paragraph">
<p>On the server-side there are two different types of filters.ContainerRequestFilters run before a Jakarta RESTful Web Services resource
method is invoked. ContainerResponseFilters run after a Jakarta RESTful Web Services resource method is invoked. As an added caveat,
ContainerRequestFilters come in two flavors: pre-match and post-matching.
Pre-matching ContainerRequestFilters are designated with the <code>@PreMatching</code> annotation and will execute before the
Jakarta RESTful Web Services resource method is matched with the incoming HTTP request.
Pre-matching filters often are used to modify request attributes to change how it matches to a specific resource method
(i.e. strip .xml and add an Accept header). ContainerRequestFilters can abort the request by calling
<code>ContainerRequestContext.abortWith(Response)</code>.  A filter might want to abort if it implements a custom authentication protocol.</p>
</div>
<div class="paragraph">
<p>After the resource class method is executed, Jakarta RESTful Web Services will run all ContainerResponseFilters.
These filters allow the outgoing response to be modified before it is marshalling and sent to the client.
Here is some pseudocode to give some understanding of how it works.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> filter() {
    <span class="comment">// execute pre match filters</span>
    <span class="keyword">for</span> (ContainerRequestFilter filter : preMatchFilters) {
        filter.filter(requestContext);
        <span class="keyword">if</span> (isAborted(requestContext)) {
           sendAbortionToClient(requestContext);
           <span class="keyword">return</span>;
        }
    }
    <span class="comment">// match the HTTP request to a resource class and method</span>
    JaxrsMethod method = matchMethod(requestContext);

    <span class="comment">// Execute post match filters</span>
    <span class="keyword">for</span> (ContainerRequestFilter filter : postMatchFilters) {
       filter.filter(requestContext);
       <span class="keyword">if</span> (isAborted(requestContext)) {
          sendAbortionToClient(requestContext);
          <span class="keyword">return</span>;
       }
    }

    <span class="comment">// execute resource class method</span>
    method.execute(request);

    <span class="comment">// execute response filters</span>
    <span class="keyword">for</span> (ContainerResponseFilter filter : responseFilters) {
       filter.filter(requestContext, responseContext);
    }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_asynchronous_filter"><a class="anchor" href="#_asynchronous_filter"></a>37.1.1. Asynchronous filters</h4>
<div class="paragraph">
<p>It is possible to turn filters into asynchronous filters, if it is needed to suspend execution of the filter until a certain resource has become available.
This makes the request asynchronous, but requires no change to the resource method declaration.
In particular, <a href="#_asynchronous_http_request_processing">synchronous and asynchronous resource methods</a> continue to work
as specified, regardless of whether a filter has made the request asynchronous. Similarly, one filter making the request
asynchronous requires no change in the declaration of other filters.</p>
</div>
<div class="paragraph">
<p>In order to make a filter&#8217;s execution asynchronous, <code>ContainerRequestContext</code> must be cast to a
<code>SuspendableContainerRequestContext</code> (for pre/post request filters), or cast the <code>ContainerResponseContext</code> to a
<code>SuspendableContainerResponseContext</code> (for response filters).</p>
</div>
<div class="paragraph">
<p>These context objects can make the current filter&#8217;s execution asynchronous by calling the <code>suspend()</code> method.
Once asynchronous, the filter chain is suspended, and will only resume after one of the following methods is called on the context object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>abortWith(Response)</code></p>
<div class="paragraph">
<p>Terminate the filter chain, return the given <code>Response</code> to the client (only for <code>ContainerRequestFilter</code>).</p>
</div>
</li>
<li>
<p><code>resume()</code></p>
<div class="paragraph">
<p>Resume execution of the filter chain by calling the next filter.</p>
</div>
</li>
<li>
<p><code>resume(Throwable)</code></p>
<div class="paragraph">
<p>Abort execution of the filter chain by throwing the given exception. This behaves as if the filter were synchronous
and threw the given exception.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Async processing can be done inside an <code>AsyncWriterInterceptor</code> (if using <a href="#_asynchronous_io">Async IO</a>), which is the
asynchronous-supporting equivalent to <code>WriterInterceptor</code>. In this case, there is no need to manually suspend or resume the request.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_client_side_filters"><a class="anchor" href="#_client_side_filters"></a>37.2. Client Side Filters</h3>
<div class="paragraph">
<p>The client side also has two types of filters: <code>ClientRequestFilter</code> and <code>ClientResponseFilter</code>.
ClientRequestFilters run before an HTTP request is sent over the wire to the server.
ClientResponseFilters run after a response is received from the server, but before the response body is unmarshalled.
ClientRequestFilters are allowed to abort the execution of the request and provide a canned response without going over the wire to the server.
ClientResponseFilters can modify the Response object before it is handed back to application code.
Here&#8217;s pseudocode to illustrate this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> Response filter() {
    <span class="comment">// execute request filters</span>
    <span class="keyword">for</span> (ClientRequestFilter filter : requestFilters) {
       filter.filter(requestContext);
       <span class="keyword">if</span> (isAborted(requestContext)) {
          <span class="keyword">return</span> requestContext.getAbortedResponseObject();
       }
    }

    <span class="comment">// send request over the wire</span>
    response = sendRequest(request);

    <span class="comment">// execute response filters</span>
    <span class="keyword">for</span> (ClientResponseFilter filter : responseFilters) {
       filter.filter(requestContext, responseContext);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reader_and_writer_interceptors"><a class="anchor" href="#_reader_and_writer_interceptors"></a>37.3. Reader and Writer Interceptors</h3>
<div class="paragraph">
<p>While filters modify request or response headers, interceptors deal with message bodies.
Interceptors are executed in the same call stack as their corresponding reader or writer.
ReaderInterceptors wrap around the execution of MessageBodyReaders.
WriterInterceptors wrap around the execution of MessageBodyWriters.
They can be used to implement a specific content-encoding.
They can be used to generate digital signatures or to post or pre-process a Java object model before or after it is marshalled.</p>
</div>
<div class="paragraph">
<p>Note that in order to support Async IO, <code>AsyncWriterInterceptor</code> can be implemented, which is a subtype of <code>WriterInterceptor</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_per_resource_method_filters_and_interceptors"><a class="anchor" href="#_per_resource_method_filters_and_interceptors"></a>37.4. Per Resource Method Filters and Interceptors</h3>
<div class="paragraph">
<p>Sometimes it is desired to have a filter or interceptor only run for a specific resource method.
This can be done in two different ways:  register an implementation of <code>DynamicFeature</code> or use the <code>@NameBinding</code> annotation.
The DynamicFeature interface is executed at deployment time for each resource method.
Use the Configurable interface to register the filters and interceptors wanted for the specific resource method.
<code>@NameBinding</code> works a lot like CDI interceptors.
Annotate a custom annotation with <code>@NameBinding</code> and then apply that custom annotation to the filter and resource method.
The custom annotation must use <code>@Retention(RetentionPolicy.RUNTIME)</code> in order for the attribute to be picked up by the RESTEasy runtime when it is deployed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@NameBinding</span>
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> DoIt {}

<span class="annotation">@DoIt</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyFilter</span> <span class="directive">implements</span> ContainerRequestFilter {}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/root</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyResource</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@DoIt</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> get() {}
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ordering"><a class="anchor" href="#_ordering"></a>37.5. Ordering</h3>
<div class="paragraph">
<p>Ordering is accomplished by using the <code>@BindingPriority</code> annotation on the filter or interceptor classes.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_asynchronous_http_request_processing"><a class="anchor" href="#_asynchronous_http_request_processing"></a>38. Asynchronous HTTP Request Processing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Asynchronous HTTP Request Processing is a relatively new technique that allows the processing of a single HTTP request using non-blocking I/O and, if desired in separate threads.
Some refer to it as COMET capabilities.
The primary use case for Asynchronous HTTP is in the case where the client is polling the server for a delayed response.
The usual example is an AJAX chat client where you want to push/pull from both the client and the server.
These scenarios have the client blocking a long time on the server&#8217;s socket waiting for a new message.
In synchronous HTTP where the server is blocking on incoming and outgoing I/O is that you have a thread consumed per client connection.
This eats up memory and valuable thread resources.
Not such a big deal in 90% of applications (in fact using asynchronous processing may actually hurt performance in most common scenarios), but when there are a lot of concurrent clients that are blocking like this, there is a lot of wasted resources and the server does not scale that well.</p>
</div>
<div class="sect2">
<h3 id="_using_the_suspended_annotation"><a class="anchor" href="#_using_the_suspended_annotation"></a>38.1. Using the <code>@Suspended</code> annotation</h3>
<div class="paragraph">
<p>The Jakarta RESTful Web Services specification includes asynchronous HTTP support via two classes.
The <code>@Suspended</code> annotation, and AsyncResponse interface.</p>
</div>
<div class="paragraph">
<p>Injecting an AsyncResponse as a parameter to a Jakarta RESTful Web Services methods tells RESTEasy that the HTTP request/response should be detached from the currently executing thread and that the current thread should not try to automatically process the response.</p>
</div>
<div class="paragraph">
<p>The AsyncResponse is the callback object.
The act of calling one of the <code>resume()</code> methods will cause a response to be sent back to the client and will also terminate the HTTP request.
Here is an example of asynchronous processing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.annotation.Resource</span>;
<span class="keyword">import</span> <span class="include">jakarta.enterprise.concurrent.ManagedExecutorService</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Suspend</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.container.AsyncResponse</span>;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleResource</span> {

    <span class="annotation">@Resource</span>
    <span class="directive">private</span> ManagedExecutorService executor;

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="type">void</span> getBasic(<span class="annotation">@Suspended</span> <span class="directive">final</span> AsyncResponse response) {
       executor.execute(() -&gt; {
           <span class="keyword">try</span> {
               <span class="directive">final</span> Resourse builtResponse = Response.ok(<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span>).type(MediaType.TEXT_PLAIN).build();
               response.resume(builtResponse);
           } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
               response.resmume(e);
           }
       });
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>AsyncResponse</code> also has other methods to cancel the execution.
See <a href="https://jakarta.ee/specifications/restful-ws/3.1/apidocs/jakarta.ws.rs/jakarta/ws/rs/container/asyncresponse">javadoc</a> for more details.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
In RESTEasy version 4.0.0.Final proprietary annotation <code>org.jboss.resteasy.annotations.Suspend</code> was removed and
replaced by <code>jakarta.ws.rs.container.Suspended</code> and class <code>org.jboss.resteasy.spi.AsynchronousResponse</code> was removed and
replaced by <code>jakarta.ws.rs.container.AsyncResponse</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>@Suspended</code> does not have a value field, which represented a timeout limit.
Instead, <code>AsyncResponse.setTimeout()</code> may be called.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_using_reactive_return_types"><a class="anchor" href="#_using_reactive_return_types"></a>38.2. Using Reactive return types</h3>
<div class="paragraph">
<p>The Jakarta RESTful Web Services 2.1 specification adds support for declaring asynchronous resource methods by returning a <code>CompletionStage</code> instead of using the <code>@Suspended</code> annotation.</p>
</div>
<div class="paragraph">
<p>Whenever a resource method returns a <code>CompletionStage</code>, it will be subscribed to, the request will be suspended, and only resumed when the <code>CompletionStage</code> is resolved either to a value (which is then treated as the return value for the method), or as an error case, in which case the exception will be processed as if it were thrown by the resource method.</p>
</div>
<div class="paragraph">
<p>Here is an example of asynchronous processing using <code>CompletionStage</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">jakarta.annotation.Resource</span>;
<span class="keyword">import</span> <span class="include">jakarta.enterprise.concurrent.ManagedExecutorService</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Suspend</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.container.AsyncResponse</span>;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">SimpleResource</span> {

    <span class="annotation">@Resource</span>
    <span class="directive">private</span> ManagedExecutorService executor;

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> CompletionStage&lt;Response&gt; getBasic() {
      <span class="directive">final</span> CompletableFuture&lt;Response&gt; response = <span class="keyword">new</span> CompletableFuture&lt;&gt;();
      executor.execute(() -&gt; {
            <span class="keyword">try</span>{
               <span class="directive">final</span> Response jaxrs = Response.ok(<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span>).type(MediaType.TEXT_PLAIN).build();
               response.complete(jaxrs);
            } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
               response.completeExceptionally(e);
            }
      });
      <span class="keyword">return</span> response;
   }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RESTEasy <a href="#_reactive">supports more reactive types for asynchronous programming</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_asynchronous_filters"><a class="anchor" href="#_asynchronous_filters"></a>38.3. Asynchronous filters</h3>
<div class="paragraph">
<p>It is possible to write <a href="#_asynchronous_filter">filters that also make the request asynchronous</a>.
Whether filters make the request asynchronous before execution of a method makes absolutely no difference to a method: it does not need to be declared asynchronous in order to function as specified.
Synchronous methods and asynchronous methods will work as specified by the spec.</p>
</div>
</div>
<div class="sect2">
<h3 id="_asynchronous_io"><a class="anchor" href="#_asynchronous_io"></a>38.4. Asynchronous IO</h3>
<div class="paragraph">
<p>Some backends support asynchronous IO operations (Servlet, Undertow, Vert.x, Quarkus, Netty), which are exposed using the <code>AsyncOutputStream</code> subtype of <code>OutputStream</code>.
It includes async variants for writing and flushing the stream.</p>
</div>
<div class="paragraph">
<p>Some backends have what is called an "Event Loop Thread", which is a thread responsible for doing all IO operations.
Those backends require the Event Loop Thread to never be blocked, because it does IO for every other thread.
Those backends typically require Jakarta RESTful Web Services endpoints to be invoked on worker threads, to make sure they never block the Event Loop Thread.</p>
</div>
<div class="paragraph">
<p>Sometimes, with Async programming, it is possible for asynchronous Jakarta RESTful Web Services requests to be resumed from the Event Loop Thread.
As a result, Jakarta RESTful Web Services will attempt to serialise the response and send it to the client.
But Jakarta RESTful Web Services is written using "Blocking IO" mechanics, such as <code>OutputStream</code> (used by <code>MessageBodyWriter</code> and <code>WriterInterceptor</code>), which means that sending the response will block the current thread until the response is received.
This would work on a worker thread, but if it happens on the Event Loop Thread it will block it and prevent it from sending the response, resulting in a deadlock.</p>
</div>
<div class="paragraph">
<p>As a result, we&#8217;ve decided to support and expose Async IO interfaces in the form of <code>AsyncOutputStream</code>, <code>AsyncMessageBodyWriter</code> and <code>AsyncWriterInterceptor</code>, to allow users to write Async IO applications in RESTEasy.</p>
</div>
<div class="paragraph">
<p>Most built-in <code>MessageBodyWriter</code> and <code>WriterInterceptor</code> support Async IO, with the notable exceptions of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HtmlRenderableWriter</code>, which is tied to servlet APIs</p>
</li>
<li>
<p><code>ReaderProvider</code></p>
</li>
<li>
<p><code>StreamingOutputProvider</code>: use <code>AsyncStreamingOutput</code> instead</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Async IO will be preferred if the following conditions are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The backend supports it</p>
</li>
<li>
<p>The writer supports it</p>
</li>
<li>
<p>All writer interceptors support it</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If those conditions are not met, and you attempt to use Blocking IO on an Event Loop Thread (as determined by the backend), then an exception will be thrown.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_async_job_service"><a class="anchor" href="#_async_job_service"></a>39. Asynchronous Job Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RESTEasy Asynchronous Job Service is an implementation of the Asynchronous Job pattern defined in O&#8217;Reilly&#8217;s "Restful Web Services" book.
The idea of it is to bring asynchronicity to a synchronous protocol.</p>
</div>
<div class="sect2">
<h3 id="_async_job"><a class="anchor" href="#_async_job"></a>39.1. Using Async Jobs</h3>
<div class="paragraph">
<p>While HTTP is a synchronous protocol it does have a faint idea of asynchronous invocations.
The HTTP 1.1 response code 202, "Accepted" means that the server has received and accepted the response for processing, but the processing has not yet been completed.
The RESTEasy Asynchronous Job Service builds around this idea.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>POST http://localhost/myservice?asynch=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, if making the above post with the asynch query parameter set to true, RESTEasy will return a 202, "Accepted" response code and run the invocation in the background.
It also sends back a Location header with a URL pointing to where the response of the background method is located.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>HTTP/1.1 202 Accepted
Location: http://localhost/asynch/jobs/3332334</code></pre>
</div>
</div>
<div class="paragraph">
<p>The URI will have the form of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>/asynch/jobs/{job-id}?wait={millisconds}|nowait=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can perform the GET, POST, and DELETE operations on this job URL.
GET returns whatever the Jakarta RESTful Web Services resource method invoked returns as a response if the job was completed.
If the job has not completed, this GET will return a response code of 202, Accepted.
Invoking GET does not remove the job, so it can be called multiple times.
When RESTEasy&#8217;s job queue gets full, it will evict the least recently used job from memory.
Manual clean up can be performed by calling DELETE on the URI.
POST does a read of the JOB response and will remove the JOB it has completed.</p>
</div>
<div class="paragraph">
<p>Both GET and POST allow the specification of a maximum wait time in milliseconds, a "wait" query parameter.
Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>POST http://localhost/asynch/jobs/122?wait=3000</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a "wait" parameter is not specified, the GET or POST will not wait if the job is not complete.</p>
</div>
<div class="paragraph">
<p>NOTE!!  While GET, DELETE, and PUT methods can be invoked asynchronously, this breaks the HTTP 1.1 contract of these methods.
While these invocations may not change the state of the resource if invoked more than once, they do change the state of the server as new Job entries with each invocation.
To be a purist, stick with only invoking POST methods asynchronously.</p>
</div>
<div class="paragraph">
<p>Security NOTE!  RESTEasy&#8217;s role-based security (annotations) does not work with the Asynchronous Job Service.
XML declarative security must be used within the web.xml file, because it is impossible to implement role-based security in a portable way.</p>
</div>
<div class="paragraph">
<p>NOTE.
A <code>java.security.SecureRandom</code> object is used to generate unique job ids.
For security purposes, the <code>SecureRandom</code> is periodically reseeded.
By default, it is reseeded after 100 uses.
This value may be configured with the servlet init parameter "resteasy.secure.random.max.use".</p>
</div>
</div>
<div class="sect2">
<h3 id="_oneway"><a class="anchor" href="#_oneway"></a>39.2. Oneway: Fire and Forget</h3>
<div class="paragraph">
<p>RESTEasy also supports the notion of fire and forget.
This will also return a 202, Accepted response, but no Job will be created.
This is as simple as using the oneway query parameter instead of asynch.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>POST http://localhost/myservice?oneway=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Security NOTE!  RESTEasy role-based security (annotations) does not work with the Asynchronous Job Service.
XML declarative security must be use within the web.xml file, because it is impossible to implement role-based security in a portable way.</p>
</div>
</div>
<div class="sect2">
<h3 id="_async_job_setup"><a class="anchor" href="#_async_job_setup"></a>39.3. Setup and Configuration</h3>
<div class="paragraph">
<p>The Asynchronous Job Service must be enabled, as it is not turned on by default.
If the relevant configuration properties are configured in web.xml, it would look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="comment">&lt;!-- enable the Asynchronous Job Service --&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.async.job.service.enabled<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>

    <span class="comment">&lt;!-- The next context parameters are all optional.
         Their default values are shown as example param-values --&gt;</span>

    <span class="comment">&lt;!-- How many jobs results can be held in memory at once? --&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.async.job.service.max.job.results<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>100<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>

    <span class="comment">&lt;!-- Maximum wait time on a job when a client is querying for it --&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.async.job.service.max.wait<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>300000<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>

    <span class="comment">&lt;!-- Thread pool size of background threads that run the job --&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.async.job.service.thread.pool.size<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>100<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>

    <span class="comment">&lt;!-- Set the base path for the Job uris --&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.async.job.service.base.path<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>/asynch/jobs<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>

    ...
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_async_injection"><a class="anchor" href="#_async_injection"></a>40. Asynchronous Injection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pluggable Asynchronous Injection, also referred to as Asynch Injection, is a feature that allows users to create custom injectable asynchronous types.
For example, it is possible to declare an injector for <code>Single&lt;Foo&gt;</code> and inject it into an endpoint as a class variable
or as a method parameter using <code>@Context Foo</code>. The response will be made asynchronous automatically and the resource
method will only be invoked once the <code>Single&lt;Foo&gt;</code> object is resolved to <code>Foo</code>. Resolution is done in a non-blocking
manner.</p>
</div>
<div class="paragraph">
<p><strong>Note.</strong> Asynch injection is only attempted at points where asynchronous injection is permitted, such as on resource
creation and resource method invocation. It is not enabled at points where the API does not allow for suspending the
request, for example on <code>ResourceContext.getResource(Foo.class)</code>.</p>
</div>
<div class="sect2">
<h3 id="_contextinjector_interface"><a class="anchor" href="#_contextinjector_interface"></a>40.1. org.jboss.resteasy.spi.ContextInjector Interface</h3>
<div class="paragraph">
<p>The <code>org.jboss.resteasy.spi.ContextInjector</code> interface must be implemented on any custom async injector object.
The implementation class must be annotated with the <code>@Provider</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * @param &lt;WrappedType&gt; A class that wraps a data type or data object
 *                            (e.g. Single&lt;Foo&gt;)
 * @param &lt;UnwrappedType&gt; The data type or data object declared in the
 *                              WrappedType (e.g. Foo)
*/</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">ContextInjector</span>&lt;WrappedType, UnwrappedType&gt; {
    <span class="comment">/**
     * This interface allows users to create custom injectable asynchronous types.
     *
     * Asynch injection is only attempted at points where asynchronous injection is
     * permitted, such as on resource creation and resource method invocation. It
     * is not enabled at points where the API does not allow for suspending the
     * request
     *
     * @param rawType
     * @param genericType
     * @param annotations The annotation list is useful to parametrize the injection.
     * @return
     */</span>
     WrappedType resolve(
                <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> WrappedType&gt; rawType,
                <span class="predefined-type">Type</span> genericType,
                <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations);
    }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_singlefoo_example"><a class="anchor" href="#_singlefoo_example"></a>40.2. Single&lt;Foo&gt; Example</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">my.test</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Foo</span> {
   <span class="directive">private</span> <span class="predefined-type">String</span> value = <span class="string"><span class="delimiter">&quot;</span><span class="content">PRE-SET-VALUE</span><span class="delimiter">&quot;</span></span>;

   <span class="directive">public</span> <span class="type">void</span> setValue(<span class="predefined-type">String</span> s) {
      <span class="local-variable">this</span>.value = s;
   }

   <span class="directive">public</span> <span class="predefined-type">String</span> getValue() {
      <span class="keyword">return</span> <span class="local-variable">this</span>.value;
   }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">my.test.asyc.resources</span>;

<span class="keyword">import</span> <span class="include">io.reactivex.Single</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.ext.Provider</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.spi.ContextInjector</span>;
<span class="keyword">import</span> <span class="include">my.test.Foo</span>;

<span class="annotation">@Provider</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">FooAsychInjectorProvider</span> <span class="directive">implements</span>
            ContextInjector&lt;Single&lt;Foo&gt;,Foo&gt; {

   <span class="directive">public</span> Single&lt;Foo&gt; resolve(<span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Single&lt;Foo&gt;&gt; rawType,
            <span class="predefined-type">Type</span> genericType,
            <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations) {
      Foo value = <span class="keyword">new</span> Foo();
      <span class="keyword">return</span> Single.just(value.setValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">made it</span><span class="delimiter">&quot;</span></span>));
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_injectory_with_annotations_example"><a class="anchor" href="#_injectory_with_annotations_example"></a>40.3. Async Injector With Annotations Example</h3>
<div class="paragraph">
<p>A convenience interface to provide annotation parameter designators</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Retention</span>(RUNTIME)
<span class="annotation">@Target</span>({ FIELD, METHOD, PARAMETER })
<span class="directive">public</span> <span class="annotation">@interface</span> AsyncInjectionPrimitiveInjectorSpecifier {
   <span class="type">enum</span> <span class="predefined-type">Type</span> {
      VALUE, NULL, NO_RESULT
   }

   <span class="predefined-type">Type</span> value() <span class="keyword">default</span> <span class="predefined-type">Type</span>.VALUE;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Provider</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">AsyncInjectionFloatInjector</span> <span class="directive">implements</span>
            ContextInjector&lt;CompletionStage&lt;<span class="predefined-type">Float</span>&gt;, <span class="predefined-type">Float</span>&gt; {

   <span class="annotation">@Override</span>
   <span class="directive">public</span> CompletionStage&lt;<span class="predefined-type">Float</span>&gt; resolve(
      <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> CompletionStage&lt;<span class="predefined-type">Float</span>&gt;&gt; rawType,
            <span class="predefined-type">Type</span> genericType,
            <span class="predefined-type">Annotation</span><span class="type">[]</span> annotations) {
       <span class="keyword">for</span> (<span class="predefined-type">Annotation</span> annotation : annotations) {
           <span class="keyword">if</span>(annotation.annotationType() == AsyncInjectionPrimitiveInjectorSpecifier.class) {
             AsyncInjectionPrimitiveInjectorSpecifier.Type value =
               ((AsyncInjectionPrimitiveInjectorSpecifier)annotation).value();
             <span class="keyword">switch</span>(value) {
               <span class="keyword">case</span> NO_RESULT:
                  <span class="keyword">return</span> <span class="predefined-constant">null</span>;
               <span class="keyword">case</span> NULL:
                  <span class="keyword">return</span> CompletableFuture.completedFuture(<span class="predefined-constant">null</span>);
               <span class="keyword">case</span> VALUE:
                  <span class="keyword">return</span> CompletableFuture.completedFuture(<span class="float">4.2f</span>);
            }
            <span class="keyword">break</span>;
          }
       }
       <span class="keyword">return</span> CompletableFuture.completedFuture(<span class="float">4.2f</span>);
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reactive"><a class="anchor" href="#_reactive"></a>41. Reactive programming support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With version 2.1, the Jakarta RESTful Web Services specification (<a href="https://jcp.org/en/jsr/detail?id=370" class="bare">https://jcp.org/en/jsr/detail?id=370</a>) takes its first steps into the world of Reactive Programming.
There are many discussions of reactive programming on the internet, and a general introduction is beyond the scope of this document, but there are a few things worth discussing.
Some primary aspects of reactive programming are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reactive programming supports the declarative creation of rich computational structures. The
representations of these structures can be passed around as first class objects such as method parameters
and return values.</p>
</li>
<li>
<p>Reactive programming supports both synchronous and asynchronous computation, but it is particularly helpful
in facilitating, at a relatively high level of expression, asynchronous computation. Conceptually,
asynchronous computation in reactive program typically involves pushing data from one entity to another, rather
than polling for data.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_completionstage"><a class="anchor" href="#_completionstage"></a>41.1. CompletionStage</h3>
<div class="paragraph">
<p>In Java 1.8 and Jakarta RESTful Web Services, the support for reactive programming is fairly limited.
Java 1.8 introduces the interface <code>java.util.concurrent.CompletionStage</code>, and Jakarta RESTful Web Services mandates support for the
<code>jakarta.ws.rs.client.CompletionStageRxInvoker</code>, which allows a client to obtain a response in the form of a <code>CompletionStage</code>.</p>
</div>
<div class="paragraph">
<p>One implementation of <code>CompletionStage</code> is the <code>java.util.concurrent.CompleteableFuture</code>.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testCompletionStage() <span class="directive">throws</span> <span class="exception">Exception</span> {
   CompletionStageString stage = getCompletionStage();
   log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">result: </span><span class="delimiter">&quot;</span></span> + stage.toCompletableFuture().get());
}

<span class="directive">private</span> CompletionStageString getCompletionStage() {
   CompletableFutureString future = <span class="keyword">new</span> CompletableFutureString();
   future.complete(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>);
   <span class="keyword">return</span> future;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, a <code>CompleteableFuture</code> is created with the value "foo", and its value is  extracted by the method <code>CompletableFuture.get()</code>.
That&#8217;s fine, but consider the altered version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testCompletionStageAsync() <span class="directive">throws</span> <span class="exception">Exception</span> {
   log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>);
   CompletionStageString stage = getCompletionStageAsync();
   <span class="predefined-type">String</span> result = stage.toCompletableFuture().get();
   log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">do some work</span><span class="delimiter">&quot;</span></span>);
   log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">result: </span><span class="delimiter">&quot;</span></span> + result);
}

<span class="directive">private</span> CompletionStageString getCompletionStageAsync() {
   CompletableFutureString future = <span class="keyword">new</span> CompletableFutureString();
   <span class="predefined-type">Executors</span>.newCachedThreadPool().submit(() -&gt; {sleep(<span class="integer">2000</span>); future.complete(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>);});
   <span class="keyword">return</span> future;
}

<span class="directive">private</span> <span class="type">void</span> sleep(<span class="type">long</span> l) {
   <span class="keyword">try</span> {
      <span class="predefined-type">Thread</span>.sleep(l);
   } <span class="keyword">catch</span> (<span class="exception">InterruptedException</span> e) {
      e.printStackTrace();
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>with output something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>3:10:51 PM INFO: start
3:10:53 PM INFO: do some work
3:10:53 PM INFO: result: foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>It also works, but it illustrates the fact that <code>CompletableFuture.get()</code> is a blocking call.
The <code>CompletionStage</code> is constructed and returned immediately, but the value isn&#8217;t returned for two seconds.
A version that is more in the spirit of the reactive style is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testCompletionStageAsyncAccept() <span class="directive">throws</span> <span class="exception">Exception</span> {
   log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>);
   CompletionStageString stage = getCompletionStageAsync();
   stage.thenAccept((<span class="predefined-type">String</span> s) -&gt; log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">s: </span><span class="delimiter">&quot;</span></span> + s));
   log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">do some work</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the lambda <code>(String s) &#8594; log.info("s: " + s)</code> is registered with the <code>CompletionStage</code> as a "subscriber", and, when the <code>CompletionStage</code> eventually has a value, that value is passed to the lambda.
Note that the output is something like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>3:23:05 INFO: start
3:23:05 INFO: do some work
3:23:07 INFO: s: foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>Executing a <code>CompletionStage</code> asynchronously is so common that there are  several supporting convenience methods.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testCompletionStageSupplyAsync() <span class="directive">throws</span> <span class="exception">Exception</span> {
   CompletionStageString stage = getCompletionStageSupplyAsync();
   stage.thenAccept((<span class="predefined-type">String</span> s) -&gt; log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">s: </span><span class="delimiter">&quot;</span></span> + s));
}

<span class="directive">private</span> CompletionStageString getCompletionStageSupplyAsync() {
   <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The static method <code>ComputableFuture.supplyAsync()</code> creates a <code>ComputableFuture</code>, the value of which is supplied asynchronously by the lambda <code>() &#8594; "foo"</code>, running, by default, in the default pool of <code>java.util.concurrent.ForkJoinPool</code>.</p>
</div>
<div class="paragraph">
<p>One final example illustrates a more complex computational structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testCompletionStageComplex() <span class="directive">throws</span> <span class="exception">Exception</span> {
   <span class="predefined-type">ExecutorService</span> executor = <span class="predefined-type">Executors</span>.newCachedThreadPool();
   CompletionStageString stage1 = getCompletionStageSupplyAsync1(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>, executor);
   CompletionStageString stage2 = getCompletionStageSupplyAsync1(<span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>, executor);
   CompletionStageString stage3 = stage1.thenCombineAsync(stage2, (<span class="predefined-type">String</span> s, <span class="predefined-type">String</span> t) -&gt; s + t, executor);
   stage3.thenAccept((<span class="predefined-type">String</span> s) -&gt; log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">s: </span><span class="delimiter">&quot;</span></span> + s));
}

<span class="directive">private</span> CompletionStageString getCompletionStageSupplyAsync1(<span class="predefined-type">String</span> s, <span class="predefined-type">ExecutorService</span> executor) {
   <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; s, executor);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>stage1</code> returns "foo", <code>stage2</code> returns "bar", and <code>stage3</code>, which runs when both <code>stage1</code> and <code>stage2</code> have completed, returns the concatenation of "foo" and "bar". Note that, in this example, an explict <code>ExecutorService</code> is provided for asynchronous processing.</p>
</div>
</div>
<div class="sect2">
<h3 id="_completionstage_in_jakarta_restful_web_services"><a class="anchor" href="#_completionstage_in_jakarta_restful_web_services"></a>41.2. CompletionStage in Jakarta RESTful Web Services</h3>
<div class="paragraph">
<p>On the client side, the Jakarta RESTful Web Services specification mandates an implementation of the interface <code>jakarta.ws.rs.client.CompletionStageRxInvoker</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">CompletionStageRxInvoker</span> <span class="directive">extends</span> RxInvoker&lt;CompletionStage&gt; {

    <span class="annotation">@Override</span>
    CompletionStage&lt;Response&gt; get();

    <span class="annotation">@Override</span>
    &lt;T&gt; CompletionStage&lt;T&gt; get(<span class="predefined-type">Class</span>&lt;T&gt; responseType);

    <span class="annotation">@Override</span>
    &lt;T&gt; CompletionStage&lt;T&gt; get(GenericTypeT responseType);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is, there are invocation methods for the standard HTTP verbs, just as in the standard <code>jakarta.ws.rs.client.SyncInvoker</code>.
A <code>CompletionStageRxInvoker</code> is obtained by calling <code>rx()</code> on a <code>jakarta.ws.rs.client.Invocation.Builder</code>, which extends <code>SyncInvoker</code>.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Invocation.Builder builder = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/get/string</span><span class="delimiter">&quot;</span></span>)).request();
CompletionStageRxInvoker invoker = builder.rx(CompletionStageRxInvoker.class);
CompletionStageResponse stage = invoker.get();
Response response = stage.toCompletableFuture().get();
log.infof(<span class="string"><span class="delimiter">&quot;</span><span class="content">result: %s</span><span class="delimiter">&quot;</span></span>, response.readEntity(<span class="predefined-type">String</span>.class));</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CompletionStageRxInvoker invoker = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/get/string</span><span class="delimiter">&quot;</span></span>)).request().rx(CompletionStageRxInvoker.class);
CompletionStageString stage = invoker.get(<span class="predefined-type">String</span>.class);
<span class="predefined-type">String</span> s = stage.toCompletableFuture().get();
log.infof(<span class="string"><span class="delimiter">&quot;</span><span class="content">result: %s</span><span class="delimiter">&quot;</span></span>, s);</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the server side, the Jakarta RESTful Web Services specification requires support for resource methods with return type <code>CompletionStage&lt;T&gt;</code>.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/async</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> CompletionStageString longRunningOpAsync() {
   CompletableFutureString cs = <span class="keyword">new</span> CompletableFuture();
   executor.submit(
           (<span class="predefined-type">Runnable</span>) () -&gt; {
               executeLongRunningOp();
               cs.complete(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello async world!</span><span class="delimiter">&quot;</span></span>);
           });
   <span class="keyword">return</span> cs;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The way to think about <code>longRunningOpAsync()</code> is that it is asynchronously creating and returning a <code>String</code>.
After <code>cs.complete()</code> is called, the server will return the <code>String</code> "Hello async world!" to the client.</p>
</div>
<div class="paragraph">
<p>An important thing to understand is that the decision to produce a result asynchronously on the server and the decision to retrieve the result asynchronously on the client are independent.
Suppose that there is also a resource method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/sync</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> longRunningOpSync() {
   <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello async world!</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then all three of the following invocations are valid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> testGetStringAsyncAsync() <span class="directive">throws</span> <span class="exception">Exception</span> {
   CompletionStageRxInvoker invoker = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/get/async</span><span class="delimiter">&quot;</span></span>)).request().rx();
   CompletionStageString stage = invoker.get(<span class="predefined-type">String</span>.class);
   log.infof(<span class="string"><span class="delimiter">&quot;</span><span class="content">s: %s</span><span class="delimiter">&quot;</span></span>, stage.toCompletableFuture().get());
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> testGetStringSyncAsync() <span class="directive">throws</span> <span class="exception">Exception</span> {
   Builder request = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/get/async</span><span class="delimiter">&quot;</span></span>)).request();
   <span class="predefined-type">String</span> s = request.get(<span class="predefined-type">String</span>.class);
   log.infof(<span class="string"><span class="delimiter">&quot;</span><span class="content">s: %s</span><span class="delimiter">&quot;</span></span>, s);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> testGetStringAsyncSync() <span class="directive">throws</span> <span class="exception">Exception</span> {
   CompletionStageRxInvoker invoker = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/get/sync</span><span class="delimiter">&quot;</span></span>)).request().rx();
   CompletionStageString stage = invoker.get(<span class="predefined-type">String</span>.class);
   log.infof(<span class="string"><span class="delimiter">&quot;</span><span class="content">s: %s</span><span class="delimiter">&quot;</span></span>, stage.toCompletableFuture().get());
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>CompletionStage</code> in Jakarta RESTful Web Services is also discussed in the chapter <a href="#_asynchronous_http_request_processing">Asynchronous HTTP Request Processing</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since running code asynchronously is so common in this context, it is worth pointing out that objects obtained by way of the annotation <code>@Context</code> or by way of calling <code>ResteasyContext.getContextData()</code> are sensitive to the executing thread.
For example, given resource method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Resource</span>
<span class="directive">private</span> ManagedExecutorService executor;

<span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> CompletionStageString text(<span class="annotation">@Context</span> HttpRequest request) {
   CompletableFutureString cs = <span class="keyword">new</span> CompletableFuture();
   executor.submit(
           (<span class="predefined-type">Runnable</span>) () -&gt; {
               <span class="keyword">try</span> {
                   <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">request (async): </span><span class="delimiter">&quot;</span></span> + request);
                   cs.complete(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>);
               } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
                   e.printStackTrace();
               }
           });
   <span class="keyword">return</span> cs;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the output will look something like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>application (inline): org.jboss.resteasy.experiment.Test1798CompletionStage$TestApp@23c57474
request (inline): org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@2ce23138
application (async): null
org.jboss.resteasy.spi.LoggableFailure: RESTEASY003880: Unable to find contextual data of type: org.jboss.resteasy.spi.HttpRequest</code></pre>
</div>
</div>
<div class="paragraph">
<p>The point is that it is the developer&#8217;s responsibility to extract information from these context objects in advance.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Resource</span>
<span class="directive">private</span> ManagedExecutorService executor;

<span class="annotation">@Application</span>
<span class="directive">private</span> Application application;

<span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> CompletionStageString text(<span class="annotation">@Context</span> HttpRequest request) {
   <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">request (inline): </span><span class="delimiter">&quot;</span></span> + request);
   CompletableFutureString cs = <span class="keyword">new</span> CompletableFuture();
   <span class="directive">final</span> <span class="predefined-type">String</span> httpMethodFinal = request.getHttpMethod();
   <span class="directive">final</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; mapFinal = application.getProperties();
   executor.submit(
           (<span class="predefined-type">Runnable</span>) () -&gt; {
               <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">httpMethod (async): </span><span class="delimiter">&quot;</span></span> + httpMethodFinal);
               <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">map (async): </span><span class="delimiter">&quot;</span></span> + mapFinal);
               cs.complete(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>);
           });
   <span class="keyword">return</span> cs;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, RESTEasy&#8217;s support of <a href="https://github.com/eclipse/microprofile-context-propagation">MicroProfile Context Propagation</a> can be used by using <code>ThreadContext.contextualRunnable</code> around a <code>Runnable</code>, which will take care of capturing and restoring all registered contexts (the <code>org.jboss.resteasy.microprofile:microprofile-context-propagation</code> module will need to be imported):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Resource</span>
<span class="directive">private</span> ManagedExecutorService executor;

<span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> CompletionStageString text(<span class="annotation">@Context</span> HttpRequest request) {
   <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">request (inline): </span><span class="delimiter">&quot;</span></span> + request);
   CompletableFutureString cs = <span class="keyword">new</span> CompletableFuture();
   ThreadContext threadContext = ThreadContext.builder()
                                                   .propagated(ThreadContext.ALL_REMAINING)
                                                   .unchanged()
                                                   .cleared()
                                                   .build();
   executor.submit(
         threadContext.contextualRunnable((<span class="predefined-type">Runnable</span>) () -&gt; {
             <span class="keyword">try</span> {
                 <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">request (async): </span><span class="delimiter">&quot;</span></span> + request);
                 cs.complete(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>);
             } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
                 e.printStackTrace();
             }
         }));
   <span class="keyword">return</span> cs;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As another alternative the RESTEasy SPI&#8217;s <code>ContextualExecutor</code> can be used if the MicroProfile Context Propagation is not available.
This requires a dependency on <code>org.jboss.resteasy:resteasy-core</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
<span class="directive">public</span> CompletionStageString text(<span class="annotation">@Context</span> UriInfo uriInfo) {
  CompletableFutureString cs = <span class="keyword">new</span> CompletableFuture();
  <span class="predefined-type">ExecutorService</span> executor = ContextualExecutors.threadPool();
  executor.submit(() -&gt; {
     <span class="keyword">try</span> {
        cs.complete(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello from: </span><span class="delimiter">&quot;</span></span> + uriInfo.getAbsolutePath());
     } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
        e.printStackTrace();
     }
  });
  <span class="keyword">return</span> cs;
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_beyond_completionstage"><a class="anchor" href="#_beyond_completionstage"></a>41.3. Beyond CompletionStage</h3>
<div class="paragraph">
<p>The picture becomes more complex and interesting when sequences are added.
A <code>CompletionStage</code> holds no more than one potential value, but other reactive objects can hold multiple, even unlimited, values.
Currently, most Java implementations of reactive programming are based on the project Reactive Streams (<a href="http://www.reactive-streams.org/" class="bare">http://www.reactive-streams.org/</a>), which defines a set of four interfaces and a specification, in the form of a set of rules, describing how they interact:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Publisher</span>&lt;T&gt; {
    <span class="type">void</span> subscribe(Subscriber&lt;? <span class="local-variable">super</span> T&gt; s);
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">Subscriber</span>&lt;T&gt; {
    <span class="type">void</span> onSubscribe(Subscription s);
    <span class="type">void</span> onNext(T t);
    <span class="type">void</span> onError(<span class="predefined-type">Throwable</span> t);
    <span class="type">void</span> onComplete();
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">Subscription</span> {
    <span class="type">void</span> request(<span class="type">long</span> n);
    <span class="type">void</span> cancel();
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">Processor</span>&lt;T, R&gt; <span class="directive">extends</span> Subscriber&lt;T&gt;, Publisher&lt;R&gt; {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>Producer</code> pushes objects to a <code>Subscriber</code>, a <code>Subscription</code> mediates the relationship between the two, and a <code>Processor</code> which is derived from both, helps to construct pipelines through which objects pass.</p>
</div>
<div class="paragraph">
<p>One important aspect of the specification is flow control, the ability of a <code>Suscriber</code> to control the load it receives from a <code>Producer</code> by calling <code>Suscription.request()</code>.
The general term in this context for flow control is <strong>backpressure</strong>.</p>
</div>
<div class="paragraph">
<p>There are a number of implementations of Reactive Streams, including</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>RxJava: <a href="https://github.com/ReactiveX/RxJava/1.x">https://github.com/ReactiveX/RxJava/tree/1.x</a></p>
</li>
<li>
<p>RxJava 2: <a href="https://github.com/ReactiveX/RxJava/2.x">https://github.com/ReactiveX/RxJava/tree/2.x</a></p>
</li>
<li>
<p>RxJava 3: <a href="https://github.com/ReactiveX/RxJava" class="bare">https://github.com/ReactiveX/RxJava</a></p>
</li>
<li>
<p>Reactor: <a href="http://projectreactor.io/" class="bare">http://projectreactor.io/</a></p>
</li>
<li>
<p>Flow : <a href="https://community.oracle.com/docs/DOC-1006738">https://community.oracle.com/docs/DOC-1006738/</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>RESTEasy currently supports RxJava (deprecated), RxJava2 and Reactor.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pluggable_reactive_types_rxjava_2_in_resteasy"><a class="anchor" href="#_pluggable_reactive_types_rxjava_2_in_resteasy"></a>41.4. Pluggable reactive types: RxJava 2 in RESTEasy</h3>
<div class="paragraph">
<p>Jakarta RESTful Web Services doesn&#8217;t currently require support for any Reactive Streams implementations, but it does allow for extensibility to support various reactive libraries.
RESTEasy&#8217;s optional module <code>resteasy-rxjava2</code>  adds support for <a href="https://github.com/ReactiveX/RxJava">RxJava 2</a>.</p>
</div>
<div class="paragraph">
<p>More in details, <code>resteasy-rxjava2</code> contributes support for reactive types <code>io.reactivex.Single</code>, <code>io.reactivex.Flowable</code>, and <code>io.reactivex.Observable</code>.
Of these, <code>Single</code> is similar to <code>CompletionStage</code> in that it holds at most one potential value. <code>Flowable</code> implements <code>io.reactivex.Publisher</code>, and <code>Observable</code> is very similar to <code>Flowable</code> except that it doesn&#8217;t support backpressure.
If importing <code>resteasy-rxjava2</code>, you can start returning these reactive types from your resource methods on the server side and receiving them on the client side.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When using RESTEasy&#8217;s modules for RxJava, the reactive contexts are automatically propagated to all supported RxJava types, which means there is no need to worry about <code>@Context</code> injection not working within RxJava lambdas, contrary to <code>CompletionStage</code> (as previously noted).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_server_side"><a class="anchor" href="#_server_side"></a>41.4.1. Server side</h4>
<div class="paragraph">
<p>Given the class <code>Thing</code>, which can be represented in JSON:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Thing</span> {

   <span class="directive">private</span> <span class="predefined-type">String</span> name;

   <span class="directive">public</span> Thing() {
   }

   <span class="directive">public</span> Thing(<span class="predefined-type">String</span> name) {
      <span class="local-variable">this</span>.name = name;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the method <code>postThingList()</code> in the following is a valid resource method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post/thing/list</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="annotation">@Stream</span>
<span class="directive">public</span> Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; postThingList(<span class="predefined-type">String</span> s) {
   <span class="keyword">return</span> buildFlowableThingList(s, <span class="integer">2</span>, <span class="integer">3</span>);
}

<span class="directive">static</span> Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; buildFlowableThingList(<span class="predefined-type">String</span> s, <span class="type">int</span> listSize, <span class="type">int</span> elementSize) {
   <span class="keyword">return</span> Flowable.create(
      <span class="keyword">new</span> FlowableOnSubscribeListThing() {

         <span class="annotation">@Override</span>
         <span class="directive">public</span> <span class="type">void</span> subscribe(FlowableEmitter&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; emitter) <span class="directive">throws</span> <span class="exception">Exception</span> {
            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i listSize; i++) {
               <span class="predefined-type">List</span>&lt;Thing&gt; list = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
               <span class="keyword">for</span> (<span class="type">int</span> j = <span class="integer">0</span>; j &lt; elementSize; j++) {
                  list.add(<span class="keyword">new</span> Thing(s));
               }
               emitter.onNext(list);
            }
            emitter.onComplete();
         }
      },
      BackpressureStrategy.BUFFER);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method <code>buildFlowableThingList()</code> deserves some explanation.
First,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; Flowable.create(FlowableOnSubscribe&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; source, BackpressureStrategy mode);</code></pre>
</div>
</div>
<div class="paragraph">
<p>creates a <code>Flowable&lt;List&lt;Thing&gt;&gt;</code> by describing what should happen when the <code>Flowable&lt;List&lt;Thing&gt;&gt;</code> is subscribed to. <code>FlowableEmitter&lt;List&lt;Thing&gt;&gt;</code> extends ` io.reactivex.Emitter&lt;List&lt;Thing&gt;&gt;`:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Base interface for emitting signals in a push-fashion in various generator-like source
 * operators (create, generate).
 *
 * @param T the value type emitted
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Emitter</span>&lt;T&gt; {

    <span class="comment">/**
     * Signal a normal value.
     * @param value the value to signal, not null
     */</span>
    <span class="type">void</span> onNext(<span class="annotation">@NonNull</span> T value);

    <span class="comment">/**
     * Signal a Throwable exception.
     * @param error the Throwable to signal, not null
     */</span>
    <span class="type">void</span> onError(<span class="annotation">@NonNull</span> <span class="predefined-type">Throwable</span> error);

    <span class="comment">/**
     * Signal a completion.
     */</span>
    <span class="type">void</span> onComplete();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and <code>FlowableOnSubscribe</code> uses a <code>FlowableEmitter</code> to send out values from the <code>Flowable&lt;List&lt;Thing&gt;&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * A functional interface that has a {@code subscribe()} method that receives
 * an instance of a {@link FlowableEmitter} instance that allows pushing
 * events in a backpressure-safe and cancellation-safe manner.
 *
 * @param T the value type pushed
 */</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">FlowableOnSubscribe</span>&lt;T&gt; {

    <span class="comment">/**
     * Called for each Subscriber that subscribes.
     * @param e the safe emitter instance, never null
     * @throws Exception on error
     */</span>
    <span class="type">void</span> subscribe(<span class="annotation">@NonNull</span> FlowableEmitter&lt;T&gt; e) <span class="directive">throws</span> <span class="exception">Exception</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>So, what will happen when a subscription to the <code>Flowable&lt;List&lt;Thing&gt;&gt;</code> is created is, the <code>FlowableEmitter.onNext()</code> will be called, once for each <code>&lt;List&lt;Thing&gt;&gt;</code> created, followed by a call to <code>FlowableEmitter.onComplete()</code> to indicate that the sequence has ended.
Under the covers, RESTEasy subscribes to the <code>Flowable&lt;List&lt;Thing&gt;&gt;</code> and handles each element passed in by way of <code>onNext()</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_client_side_2"><a class="anchor" href="#_client_side_2"></a>41.4.2. Client side</h4>
<div class="paragraph">
<p>On the client side, Jakarta RESTful Web Services supports extensions for reactive classes by adding the method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">/**
 * Access a reactive invoker based on a {@link RxInvoker} subclass provider. Note
 * that corresponding {@link RxInvokerProvider} must be registered in the client runtime.
 *
 * This method is an extension point for Jakarta RESTful Web Services implementations to support other types
 * representing asynchronous computations.
 *
 * @param clazz {@link RxInvoker} subclass.
 * @return reactive invoker instance.
 * @throws IllegalStateException when provider for given class is not registered.
 * @see jakarta.ws.rs.client.Client#register(Class)
 * @since 2.1
 */</span>
<span class="directive">public</span> &lt;T <span class="directive">extends</span> RxInvoker&gt; T rx(ClassT clazz);</code></pre>
</div>
</div>
<div class="paragraph">
<p>to interface <code>jakarta.ws.rs.client.Invocation.Builder</code>.
Resteasy module <code>resteasy-rxjava2</code> adds support for classes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>org.jboss.resteasy.rxjava2.SingleRxInvoker</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.rxjava2.FlowableRxInvoker</code></p>
</li>
<li>
<p><code>org.jbosss.resteasy.rxjava2.ObservableRxInvoker</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>which allows accessing `Single`s, `Observable`s, and `Flowable`s on the client side.</p>
</div>
<div class="paragraph">
<p>For example, given the resource method <code>postThingList()</code> above, a <code>Flowable&lt;List&lt;Thing&gt;&gt;</code> can be retrieved from the server by calling</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testPostThingList() <span class="directive">throws</span> <span class="exception">Exception</span> {
   <span class="predefined-type">CountDownLatch</span> latch = <span class="keyword">new</span> CountdownLatch(<span class="integer">1</span>);
   FlowableRxInvoker invoker = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/post/thing/list</span><span class="delimiter">&quot;</span></span>)).request().rx(FlowableRxInvoker.class);
   Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; flowable = (Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt;) invoker.post(<span class="predefined-type">Entity</span>.entity(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, MediaType.TEXT_PLAIN_TYPE), <span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt;() {});
   flowable.subscribe(
         (<span class="predefined-type">List</span>&lt;?&gt; l) -&gt; thingListList.add(l),
         (<span class="predefined-type">Throwable</span> t) -&gt; latch.countDown(),
         () -&gt; latch.countDown());
   latch.await();
   Assert.assertEquals(aThingListList, thingListList);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>aThingListList</code> is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>[[Thing[a], Thing[a], Thing[a]], [Thing[a], Thing[a], Thing[a]]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the call to <code>Flowable.suscribe()</code>.
On the server side, RESTEasy subscribes to a  returning <code>Flowable</code> in order to receive its elements and send them over the wire.
On the client side, the user subscribes to the <code>Flowable</code> in order to receive its elements and do whatever it wants to with them.
In this case, three lambdas determine what should happen 1) for each element, 2) if a <code>Throwable</code> is thrown, and 3) when the <code>Flowable</code> is done passing elements.</p>
</div>
</div>
<div class="sect3">
<h4 id="_representation_on_the_wire"><a class="anchor" href="#_representation_on_the_wire"></a>41.4.3. Representation on the wire</h4>
<div class="paragraph">
<p>Neither Reactive Streams nor Jakarta RESTful Web Services have anything to say about representing reactive types on the network.
RESTEasy offers a number of representations, each suitable for different circumstances.
The wire protocol is determined by 1) the presence or absence of the <code>@Stream</code> annotation on the resource method,  and 2) the value of the <code>value</code> field in the <code>@Stream</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Stream {
   <span class="directive">public</span> <span class="type">enum</span> MODE {RAW, GENERAL};
   <span class="directive">public</span> <span class="predefined-type">String</span> INCLUDE_STREAMING_PARAMETER = <span class="string"><span class="delimiter">&quot;</span><span class="content">streaming</span><span class="delimiter">&quot;</span></span>;
   <span class="directive">public</span> MODE value() <span class="keyword">default</span> MODE.GENERAL;
   <span class="directive">public</span> <span class="type">boolean</span> includeStreaming() <span class="keyword">default</span> <span class="predefined-constant">false</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>MODE.GENERAL</code> is the default value, so <code>@Stream</code> is equivalent to <code>@Stream(Stream.MODE.GENERAL)</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No <code>@Stream</code> annotation on the resource method:</p>
<div class="paragraph">
<p><code>java.util.List</code> entity and send to the client.</p>
</div>
</li>
<li>
<p><code>@Stream(Stream.MODE.GENERAL)</code></p>
<div class="paragraph">
<p>This case uses a variant of the SSE format, modified to eliminate some restrictions inherent in SSE.
(See the specification at <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html" class="bare">https://html.spec.whatwg.org/multipage/server-sent-events.html</a> for details.)
In particular, 1) SSE events are meant to hold text data, represented in character set UTF-8. In the general streaming mode,
certain delimiting characters in the data ('\r', '\n', and '\') are escaped so that arbitrary binary data can be
transmitted. Also, 2) the SSE specification requires the client to reconnect if it gets disconnected. If the stream
is finite, reconnecting will induce a repeat of the stream, so SSE is really meant for unlimited streams.
In general streaming mode, the client will close, rather than automatically reconnect, at the end of the stream. It follows
that this mode is suitable for finite streams.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
&lt;emphasis role="bold"&gt;Note. &lt;/emphasis&gt; The Content-Type header in general streaming mode is set to
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>applicaton/x-stream-general;&quot;element-type=element-type&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where element-type is the media type of the data elements in the stream.
The element media type is derived from the @Produces annotation.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">flowable/thing</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Stream</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> FlowableThing getFlowable() {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>induces the media type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>application/x-stream-general;&quot;element-type=application/json&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>which describes a stream of JSON elements.</p>
</div>
</li>
<li>
<p><code>@Stream(Stream.MODE.RAW)</code></p>
<div class="paragraph">
<p>In this case each value is written directly to the wire, without any formatting, as it becomes available. This is most
useful for values that can be cut in pieces, such as strings, bytes, buffers, etc., and then re-concatenated on the
client side. Note that without delimiters as in general mode, it isn&#8217;t possible to reconstruct something like <code>List&lt;List&lt;String&gt;&gt;</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Content-Type header in raw streaming mode is derived from the <code>@Produces</code> annotation.
The <code>@Stream</code> annotation offers the possibility of an optional <code>MediaType</code> parameter called "streaming". The point is to be able to suggest that the stream of data emanating from the server is unbounded, i.e., that the client shouldn&#8217;t try to read it all as a single byte array, for example.
The parameter is set by explicitly setting the <code>@Stream</code> parameter <code>includeStreaming()</code> to <code>true</code>.
For example,
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">byte/default</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/octet-stream;x=y</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Stream</span>(Stream.MODE.RAW)
<span class="directive">public</span> FlowableByte aByteDefault() {
  <span class="keyword">return</span> Flowable.fromArray((<span class="type">byte</span>) <span class="integer">0</span>, (<span class="type">byte</span>) <span class="integer">1</span>, (<span class="type">byte</span>) <span class="integer">2</span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>induces the <code>MediaType</code> "application/octet-stream;x=y", and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">byte/true</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/octet-stream;x=y</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Stream</span>(value=Stream.MODE.RAW, includeStreaming=<span class="predefined-constant">true</span>)
<span class="directive">public</span> FlowableByte aByteTrue() {
  <span class="keyword">return</span> Flowable.fromArray((<span class="type">byte</span>) <span class="integer">0</span>, (<span class="type">byte</span>) <span class="integer">1</span>, (<span class="type">byte</span>) <span class="integer">2</span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>induces the <code>MediaType</code> "application/octet-stream;x=y;streaming=true".</p>
</div>
<div class="paragraph">
<p>Note that browsers such as Firefox and Chrome seem to be comfortable with reading unlimited streams without any additional hints.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_examples"><a class="anchor" href="#_examples"></a>41.4.4. Examples</h4>
<div class="paragraph">
<p><strong>Example 1.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post/thing/list</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="annotation">@Stream</span>(Stream.MODE.GENERAL)
<span class="directive">public</span> Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; postThingList(<span class="predefined-type">String</span> s) {
   <span class="keyword">return</span> buildFlowableThingList(s, <span class="integer">2</span>, <span class="integer">3</span>);
}

<span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testPostThingList() <span class="directive">throws</span> <span class="exception">Exception</span> {
   <span class="predefined-type">CountDownLatch</span> latch = <span class="keyword">new</span> CountdownLatch(<span class="integer">1</span>);
   FlowableRxInvoker invoker = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/post/thing/list</span><span class="delimiter">&quot;</span></span>)).request().rx(FlowableRxInvoker.class);
   Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; flowable = (Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt;) invoker.post(<span class="predefined-type">Entity</span>.entity(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, MediaType.TEXT_PLAIN_TYPE), <span class="keyword">new</span> GenericType&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt;() {});
   flowable.subscribe(
         (<span class="predefined-type">List</span>&lt;?&gt; l) -&gt; thingListList.add(l),
         (<span class="predefined-type">Throwable</span> t) -&gt; latch.countDown(),
         () -&gt; latch.countDown());
   latch.await();
   Assert.assertEquals(aThingListList, thingListList);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the example given previously, except that the mode in the <code>@Stream</code> annotation (which defaults to MODE.GENERAL) is given explicitly.
In this scenario, the <code>Flowable</code> emits <code>List&lt;Thing&gt;</code> elements on the server, they are transmitted over the wire as SSE events:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>data: [{&quot;name&quot;:&quot;a&quot;},{&quot;name&quot;:&quot;a&quot;},{&quot;name&quot;:&quot;a&quot;}]
data: [{&quot;name&quot;:&quot;a&quot;},{&quot;name&quot;:&quot;a&quot;},{&quot;name&quot;:&quot;a&quot;}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the <code>FlowableRxInvoker</code> reconstitutes a <code>Flowable</code> on the client side.</p>
</div>
<div class="paragraph">
<p><strong>Example 2.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">post/thing/list</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="directive">public</span> Flowable&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; postThingList(<span class="predefined-type">String</span> s) {
   <span class="keyword">return</span> buildFlowableThingList(s, <span class="integer">2</span>, <span class="integer">3</span>);
}

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testPostThingList() <span class="directive">throws</span> <span class="exception">Exception</span> {
   Builder request = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/post/thing/list</span><span class="delimiter">&quot;</span></span>)).request();
   <span class="predefined-type">List</span>&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt; list = request.post(<span class="predefined-type">Entity</span>.entity(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, MediaType.TEXT_PLAIN_TYPE), <span class="keyword">new</span> GenericTypeList&lt;<span class="predefined-type">List</span>&lt;Thing&gt;&gt;() {});
   Assert.assertEquals(aThingListList, list);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this scenario, in which the resource method has no <code>@Stream</code> annotation, the <code>Flowable</code> emits stream elements which are accumulated by the server until the <code>Flowable</code> is done, at which point the entire JSON list is transmitted over the wire:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>[[{&quot;name&quot;:&quot;a&quot;},{&quot;name&quot;:&quot;a&quot;},{&quot;name&quot;:&quot;a&quot;}],[{&quot;name&quot;:&quot;a&quot;},{&quot;name&quot;:&quot;a&quot;},{&quot;name&quot;:&quot;a&quot;}]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the list is reconstituted on the client side by an ordinary invoker.</p>
</div>
<div class="paragraph">
<p><strong>Example 3.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/bytes</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(MediaType.APPLICATION_OCTET_STREAM)
<span class="annotation">@Stream</span>(Stream.MODE.RAW)
<span class="directive">public</span> Flowable&lt;<span class="type">byte</span><span class="type">[]</span>&gt; getBytes() {
   <span class="keyword">return</span> Flowable.create(
      <span class="keyword">new</span> FlowableOnSubscribe&lt;<span class="type">byte</span><span class="type">[]</span>&gt;() {

         <span class="annotation">@Override</span>
         <span class="directive">public</span> <span class="type">void</span> subscribe(FlowableEmitterbyte<span class="type">[]</span> emitter) <span class="directive">throws</span> <span class="exception">Exception</span> {
            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i &lt; <span class="integer">3</span>; i++) {
               <span class="type">byte</span><span class="type">[]</span> b = <span class="keyword">new</span> <span class="type">byte</span>[<span class="integer">10</span>];
               <span class="keyword">for</span> (<span class="type">int</span> j = <span class="integer">0</span>; j  &lt;<span class="integer">10</span>; j++) {
                  b[j] = (<span class="type">byte</span>) (i + j);
               }
               emitter.onNext(b);
            }
            emitter.onComplete();
         }
      },
      BackpressureStrategy.BUFFER);
}

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testGetBytes() <span class="directive">throws</span> <span class="exception">Exception</span> {
   Builder request = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/get/bytes</span><span class="delimiter">&quot;</span></span>)).request();
   <span class="predefined-type">InputStream</span> is = request.get(<span class="predefined-type">InputStream</span>.class);
   <span class="type">int</span> n = is.read();
   <span class="keyword">while</span> (n &lt; -<span class="integer">1</span>) {
      <span class="predefined-type">System</span>.out.print(n);
      n = is.read();
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the byte arrays are written to the network as they are created by the <code>Flowable</code>.
On the network, they are concatenated, so the client sees one stream of bytes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rx_and_sse"><a class="anchor" href="#_rx_and_sse"></a>41.4.5. Rx and SSE</h4>
<div class="paragraph">
<p>Since general streaming mode and SSE share minor variants of the same wire protocol, they are, modulo the SSE restriction to character data, interchangeable.
That is, an SSE client can connect to a resource method that returns a <code>Flowable</code> or an <code>Observable</code>, and a <code>FlowableRxInvoker</code>, for example, can connect to an SSE resource method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SSE requires a <code>@Produces("text/event-stream")</code> annotation, so, unlike the cases of raw and general streaming, the element media type cannot be derived from the <code>@Produces</code> annotation.
To solve this problem, Resteasy introduces the
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> SseElementType {
   <span class="predefined-type">String</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>annotation, from which the element media type is derived.</p>
</div>
<div class="paragraph">
<p><strong>Example 1.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">eventStream/thing</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/event-stream</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SseElementType</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">void</span> eventStreamThing(<span class="annotation">@Context</span> SseEventSink eventSink, <span class="annotation">@Context</span> Sse sse) {
   <span class="keyword">new</span> <span class="predefined-type">ScheduledThreadPoolExecutor</span>(<span class="integer">5</span>).execute(() -&gt; {
      <span class="keyword">try</span> (SseEventSink sink = eventSink) {
         OutboundSseEvent.Builder  builder = sse.newEventBuilder();
         eventSink.send(builder.data(<span class="keyword">new</span> Thing(<span class="string"><span class="delimiter">&quot;</span><span class="content">e1</span><span class="delimiter">&quot;</span></span>)).build());
         eventSink.send(builder.data(<span class="keyword">new</span> Thing(<span class="string"><span class="delimiter">&quot;</span><span class="content">e2</span><span class="delimiter">&quot;</span></span>)).build());
         eventSink.send(builder.data(<span class="keyword">new</span> Thing(<span class="string"><span class="delimiter">&quot;</span><span class="content">e3</span><span class="delimiter">&quot;</span></span>)).build());
      }
   });
}

<span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testFlowableToSse() <span class="directive">throws</span> <span class="exception">Exception</span> {
   <span class="predefined-type">CountDownLatch</span> latch = <span class="keyword">new</span> <span class="predefined-type">CountDownLatch</span>(<span class="integer">1</span>);
   <span class="directive">final</span> <span class="predefined-type">AtomicInteger</span> errors = <span class="keyword">new</span> <span class="predefined-type">AtomicInteger</span>(<span class="integer">0</span>);
   FlowableRxInvoker invoker = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/eventStream/thing</span><span class="delimiter">&quot;</span></span>)).request().rx(FlowableRxInvoker.class);
   FlowableThing flowable = (FlowableThing) invoker.get(Thing.class);
   flowable.subscribe(
      (Thing t) -&gt; thingList.add(t),
      (<span class="predefined-type">Throwable</span> t) -&gt; errors.incrementAndGet(),
      () -&gt; latch.countDown());
   <span class="type">boolean</span> waitResult = latch.await(<span class="integer">30</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);
   Assert.assertTrue(<span class="string"><span class="delimiter">&quot;</span><span class="content">Waiting for event to be delivered has timed out.</span><span class="delimiter">&quot;</span></span>, waitResult);
   Assert.assertEquals(<span class="integer">0</span>, errors.get());
   Assert.assertEquals(eThingList, thingList);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, a <code>FlowableRxInvoker</code> is connecting to an SSE resource method.
On the network, the data looks like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>data: {&quot;name&quot;:&quot;e1&quot;}
data: {&quot;name&quot;:&quot;e2&quot;}
data: {&quot;name&quot;:&quot;e3&quot;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the character data is suitable for an SSE resource method.</p>
</div>
<div class="paragraph">
<p>Also, note that the <code>eventStreamThing()</code> method in this example induces the media type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>text/event-stream;element-type=&quot;application/json&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">flowable/thing</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/event-stream</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SseElementType</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> Flowable&lt;Thing&gt; flowableSSE() {
   <span class="keyword">return</span> Flowable.create(
      <span class="keyword">new</span> FlowableOnSubscribe&lt;Thing&gt;() {

         <span class="annotation">@Override</span>
         <span class="directive">public</span> <span class="type">void</span> subscribe(FlowableEmitter&lt;Thing&gt; emitter) <span class="directive">throws</span> <span class="exception">Exception</span> {
            emitter.onNext(<span class="keyword">new</span> Thing(<span class="string"><span class="delimiter">&quot;</span><span class="content">e1</span><span class="delimiter">&quot;</span></span>));
            emitter.onNext(<span class="keyword">new</span> Thing(<span class="string"><span class="delimiter">&quot;</span><span class="content">e2</span><span class="delimiter">&quot;</span></span>));
            emitter.onNext(<span class="keyword">new</span> Thing(<span class="string"><span class="delimiter">&quot;</span><span class="content">e3</span><span class="delimiter">&quot;</span></span>));
            emitter.onComplete();
         }
      },
      BackpressureStrategy.BUFFER);
}

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testSseToFlowable() <span class="directive">throws</span> <span class="exception">Exception</span> {
   <span class="directive">final</span> <span class="predefined-type">CountDownLatch</span> latch = <span class="keyword">new</span> <span class="predefined-type">CountDownLatch</span>(<span class="integer">3</span>);
   <span class="directive">final</span> <span class="predefined-type">AtomicInteger</span> errors = <span class="keyword">new</span> <span class="predefined-type">AtomicInteger</span>(<span class="integer">0</span>);
   WebTarget target = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/flowable/thing</span><span class="delimiter">&quot;</span></span>));
   SseEventSource msgEventSource = SseEventSource.target(target).build();
   <span class="keyword">try</span> (SseEventSource eventSource = msgEventSource) {
      eventSource.register(
         event -&gt; {thingList.add(event.readData(Thing.class, MediaType.APPLICATION_JSON_TYPE)); latch.countDown();},
         ex -&gt; errors.incrementAndGet());
      eventSource.open();

      <span class="type">boolean</span> waitResult = latch.await(<span class="integer">30</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);
      Assert.assertTrue(<span class="string"><span class="delimiter">&quot;</span><span class="content">Waiting for event to be delivered has timed out.</span><span class="delimiter">&quot;</span></span>, waitResult);
      Assert.assertEquals(<span class="integer">0</span>, errors.get());
      Assert.assertEquals(eThingList, thingList);
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, an SSE client is connecting to a resource method that returns a <code>Flowable</code>.
Again, the server is sending character data, which is suitable for the SSE client, and the data looks the same on the network.</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_stream_or_not_to_stream"><a class="anchor" href="#_to_stream_or_not_to_stream"></a>41.4.6. To stream or not to stream</h4>
<div class="paragraph">
<p>Whether or not it is appropriate to stream a list of values is a judgment call.
Certainly, if the list is unbounded, then it isn&#8217;t practical, or even possible, perhaps, to collect the entire list and send it at once.
In other cases, the decision is less obvious.</p>
</div>
<div class="paragraph">
<p><strong>Case 1.</strong> Suppose that all of the elements are producible quickly.
Then the overhead of sending them independently is probably not worth it.</p>
</div>
<div class="paragraph">
<p><strong>Case 2.</strong> Suppose that the list is bounded but the elements will be produced over an extended period of time.
Then returning the initial elements when they become available might lead to a better user experience.</p>
</div>
<div class="paragraph">
<p><strong>Case 3.</strong> Suppose that the list is bounded and the elements can be produced in a relatively short span of time but only after some delay.
Here is a situation that illustrates the fact that asynchronous reactive processing and streaming over the network are independent concepts.
In this case it&#8217;s worth considering having the resource method return something like <code>CompletionStage&lt;List&lt;Thing&gt;&gt;</code> rather than <code>Flowable&lt;List&lt;Thing&gt;&gt;</code>.
This has the  benefit of creating the list asynchronously but, once it is available, sending it to the client in one piece.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_proxies"><a class="anchor" href="#_proxies"></a>41.5. Proxies</h3>
<div class="paragraph">
<p>Proxies, discussed in <a href="#_client_proxies">RESTEasy Proxy Framework</a>, are a RESTEasy extension that supports a natural programming style in which generic Jakarta RESTful Web Services invoker calls are replaced by application specific interface calls.
The proxy framework is extended to include both <code>CompletionStage</code> and the RxJava2 types <code>Single</code>, <code>Observable</code>, and <code>Flowable</code>.</p>
</div>
<div class="paragraph">
<p><strong>Example 1.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">RxCompletionStageResource</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/string</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
   CompletionStage&lt;<span class="predefined-type">String</span>&gt; getString();
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">RxCompletionStageResourceImpl</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/string</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
   <span class="directive">public</span> CompletionStage&lt;<span class="predefined-type">String</span>&gt; getString() { . }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">RxCompletionStageProxyTest</span> {

   <span class="directive">private</span> <span class="directive">static</span> ResteasyClient client;
   <span class="directive">private</span> <span class="directive">static</span> RxCompletionStageResource proxy;

   <span class="directive">static</span> {
      client = (ResteasyClient)ClientBuilder.newClient();
      proxy = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)).proxy(RxCompletionStageResource.class);
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testGet() <span class="directive">throws</span> <span class="exception">Exception</span> {
      CompletionStage&lt;<span class="predefined-type">String</span>&gt; completionStage = proxy.getString();
      Assert.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">x</span><span class="delimiter">&quot;</span></span>, completionStage.toCompletableFuture().get());
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 2.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Rx2FlowableResource</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/string</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
   <span class="annotation">@Stream</span>
   <span class="directive">public</span> Flowable&lt;<span class="predefined-type">String</span>&gt; getFlowable();
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Rx2FlowableResourceImpl</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">get/string</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
   <span class="annotation">@Stream</span>
   <span class="directive">public</span> Flowable&lt;<span class="predefined-type">String</span>&gt; getFlowable() {  }
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Rx2FlowableProxyTest</span> {

   <span class="directive">private</span> <span class="directive">static</span> ResteasyClient client;
   <span class="directive">private</span> <span class="directive">static</span> Rx2FlowableResource proxy;

   <span class="directive">static</span> {
      client = (ResteasyClient)ClientBuilder.newClient();
      proxy = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)).proxy(Rx2FlowableResource.class);
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testGet() <span class="directive">throws</span> <span class="exception">Exception</span> {
      Flowable&lt;<span class="predefined-type">String</span>&gt; flowable = proxy.getFlowable();
      flowable.subscribe(
         (<span class="predefined-type">String</span> o) -&gt; stringList.add(o),
         (<span class="predefined-type">Throwable</span> t) -&gt; errors.incrementAndGet(),
         () -&gt; latch.countDown());
      <span class="type">boolean</span> waitResult = latch.await(<span class="integer">30</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);
      Assert.assertTrue(<span class="string"><span class="delimiter">&quot;</span><span class="content">Waiting for event to be delivered has timed out.</span><span class="delimiter">&quot;</span></span>, waitResult);
      Assert.assertEquals(<span class="integer">0</span>, errors.get());
      Assert.assertEquals(xStringList, stringList);
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_extensions"><a class="anchor" href="#_adding_extensions"></a>41.6. Adding extensions</h3>
<div class="paragraph">
<p>RESTEasy implements a framework that supports extensions for additional reactive classes.
To understand the framework, it is necessary to understand the existing support for <code>CompletionStage</code> and other reactive classes.</p>
</div>
<div class="paragraph">
<p><strong>Server side.</strong> When a resource method returns a <code>CompletionStage</code>, RESTEasy subscribes to it using the class <code>org.jboss.resteasy.core.AsyncResponseConsumer.CompletionStageResponseConsumer</code>.
When the <code>CompletionStage</code> completes, it calls <code>CompletionStageResponseConsumer.accept()</code>, which sends the result back to the client.</p>
</div>
<div class="paragraph">
<p>Support for <code>CompletionStage</code> is built in to RESTEasy, but it&#8217;s not hard to extend that support to a class like <code>Single</code> by providing a mechanism for transforming a <code>Single</code> into a <code>CompletionStage</code>.
In module resteasy-rxjava2, that mechanism is supplied by <code>org.jboss.resteasy.rxjava2.SingleProvider</code>, which implements interface <code>org.jboss.resteasy.spi.AsyncResponseProviderSingle?</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AsyncResponseProvider</span>&lt;T&gt; {
   CompletionStage&lt;T&gt; toCompletionStage(T asyncResponse);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Given <code>SingleProvider</code>, RESTEasy can take a <code>Single</code>, transform it into a <code>CompletionStage</code>, and then use <code>CompletionStageResponseConsumer</code> to handle the eventual value of the <code>Single</code>.</p>
</div>
<div class="paragraph">
<p>Similarly, when a resource method returns a streaming reactive class like <code>Flowable</code>, RESTEasy subscribes to it, receives a stream of data elements, and sends them to the client. <code>AsyncResponseConsumer</code> has several supporting classes, each of which implements a  different mode of streaming.
For example, <code>AsyncResponseConsumer.AsyncGeneralStreamingSseResponseConsumer</code> handles general streaming and SSE streaming.
Subscribing is done by calling <code>org.reactivestreams.Publisher.subscribe()</code>, so a mechanism is needed for turning, say, a <code>Flowable</code> into a <code>Publisher</code>.
That is, an implementation of <code>org.jboss.resteasy.spi.AsyncStreamProviderFlowable</code> is called for, where <code>AsyncStreamProvider</code> is defined:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AsyncStreamProvider</span>&lt;T&gt; {
   Publisher&lt;T&gt; toAsyncStream(T asyncResponse);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In module resteasy-rxjava2, <code>org.jboss.resteasy.FlowableProvider</code> provides that mechanism for <code>Flowable</code>.
\[Actually, that&#8217;s not too hard since, in rxjava2, a <code>Flowable</code> <em>is</em> a <code>Provider</code>.]</p>
</div>
<div class="paragraph">
<p>So, on the server side, adding support for other reactive types can be done by declaring a <code>@Provider</code> for the interface <code>AsyncStreamProvider</code> (for streams) or <code>AsyncResponseProvider</code> (for single values), which both have a single method to convert the new reactive type into (respectively) a <code>Publisher</code> (for streams) or a <code>CompletionStage</code> (for single values).</p>
</div>
<div class="paragraph">
<p><strong>Client side.</strong> The Jakarta RESTful Web Services specification imposes two requirements for support of reactive classes on the client side:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>support for <code>CompletionStage</code> in the form of an implementation of the interface <code>jakarta.ws.rs.client.CompletionStageRxInvoker</code>, and</p>
</li>
<li>
<p>extensibility in the form of support for registering providers that implement</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">RxInvokerProvider</span>&lt;T&gt; <span class="directive">extends</span> RxInvoker {
    <span class="type">boolean</span> isProviderFor(<span class="predefined-type">Class</span>&lt;T&gt; clazz);
    T getRxInvoker(SyncInvoker syncInvoker, <span class="predefined-type">ExecutorService</span> executorService);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once an <code>RxInvokerProvider</code> is registered, an <code>RxInvoker</code> can be requested by calling the <code>jakarta.ws.rs.client.Invocation.Builder</code> method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> &lt;T <span class="directive">extends</span> RxInvoker&gt; T rx(<span class="predefined-type">Class</span>&lt;T&gt; clazz);</code></pre>
</div>
</div>
<div class="paragraph">
<p>That <code>RxInvoker</code> can then be used for making an invocation that returns the appropriate reactive class. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FlowableRxInvoker invoker = client.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/get/string</span><span class="delimiter">&quot;</span></span>)).request().rx(FlowableRxInvoker.class);
FlowableString flowable = (FlowableString) invoker.get();</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>RESTEasy provides partial support for implementing a <code>RxInvoker</code>.
For example, <code>SingleProvider</code>, mentioned above, also implements <code>org.jboss.resteasy.spi.AsyncClientResponse&lt;Provider&lt;Single&lt;?&gt;&gt;&gt;</code>, where <code>AsyncClientResponseProvider</code> is defined</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AsyncClientResponseProvider</span>&lt;T&gt; {
   T fromCompletionStage(CompletionStage&lt;?&gt; completionStage);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>SingleProvider</code> has the ability to turn a <code>CompletionStage</code> into a <code>Single</code> is used in the implementation of <code>org.jboss.resteasy.rxjava2.SingleRxInvokerImpl</code>.</p>
</div>
<div class="paragraph">
<p>The same concept might be useful in implementing other <code>RxInvoker</code> implementations.
Note, though, that <code>ObservableRxInvokerImpl</code> and <code>FlowableRxInvokerImpl</code> in module resteasy-rxjava2 are each derived directly from the SSE implementation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_se_bootstrap"><a class="anchor" href="#_se_bootstrap"></a>42. Jakarta RESTful Web Services SeBootstrap</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Jakarta RESTful Web Services 3.1 the new <code>jakarta.ws.rs.SeBootstrap</code> API was introduced to run Jakarta RESTful Web Services applications in a
Java SE environment. As an implementation of the specification RESTEasy includes an implementation for this API.</p>
</div>
<div class="sect2">
<h3 id="_sebootstrap_overview"><a class="anchor" href="#_sebootstrap_overview"></a>42.1. Overview</h3>
<div class="paragraph">
<p>Its suggested by default that the <code>org.jboss.resteasy:resteasy-undertow-cdi</code> implementation be used.
However, the other <code>org.jboss.resteasy.plugins.server.embedded.EmbeddedServer</code> will work excluding the
<code>org.jboss.resteasy:resteasy-jdk-http</code>.</p>
</div>
<div class="paragraph">
<p>The <code>org.jboss.resteasy:resteasy-undertow-cdi</code> implementation also uses Weld to create a CDI container.
This allows the CDI in the SE environment to be used.
If CDI is not required or desired the <code>org.jboss.resteasy:resteasy-undertow</code> implementation could be used instead.</p>
</div>
<div class="paragraph">
<p>Example POM Dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>jakarta.ws.rs<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>jakarta.ws.rs-api<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>resteasy-core<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>resteasy-client<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>resteasy-undertow-cdi<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Its also suggested that if you do not explicitly define the resources to be used in your application that you use the
<code>io.smallrye:jandex-maven-plugin</code> to create a Jandex Index.
Without this the class path will be scanned for resources which could have significant performance impacts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>io.smallrye<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>jandex-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;executions&gt;</span>
        <span class="tag">&lt;execution&gt;</span>
            <span class="tag">&lt;id&gt;</span>make-index<span class="tag">&lt;/id&gt;</span>
            <span class="tag">&lt;goals&gt;</span>
                <span class="tag">&lt;goal&gt;</span>jandex<span class="tag">&lt;/goal&gt;</span>
            <span class="tag">&lt;/goals&gt;</span>
        <span class="tag">&lt;/execution&gt;</span>
    <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sebootstrap_usage"><a class="anchor" href="#_sebootstrap_usage"></a>42.2. Usage</h3>
<div class="paragraph">
<p>Example of using the <code>jakarta.ws.rs.SeBootstrap</code> API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="directive">final</span> <span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    SeBootstrap.start(ExampleApplication.class, SeBootstrap.Configuration.builder()
                    .build())
            .thenApply((instance) -&gt; {
                <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
                    <span class="directive">final</span> WebTarget target = client.target(instance.configuration().baseUriBuilder());
                    <span class="directive">final</span> Response response = client.target(instance.configuration()
                                    .baseUriBuilder()
                                    .path(<span class="string"><span class="delimiter">&quot;</span><span class="content">/api/product/widget</span><span class="delimiter">&quot;</span></span>))
                            .request()
                            .get();
                    <span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">Response: %d - %s%n</span><span class="delimiter">&quot;</span></span>, response.getStatus(), response.readEntity(<span class="predefined-type">String</span>.class));
                }
                <span class="keyword">return</span> instance;
            })
            .whenComplete((instance, t) -&gt; instance.stop());
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sebootstrap_config_options"><a class="anchor" href="#_sebootstrap_config_options"></a>42.3. Configuration Options</h3>
<div class="paragraph">
<p>Configuration options are represented by the <code>org.jboss.resteasy.core.se.ConfigurationOption</code> enum.
This enum includes all the supported configuration options.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">final</span> SeBootstrap.Configuration configuration = SeBootstrap.Configuration.builder()
        .port(<span class="integer">8443</span>)
        .protocol(<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTPS</span><span class="delimiter">&quot;</span></span>)
        .property(ConfigurationOption.JANDEX_CLASS_PATH_FILTER.key(), Index.of(ItemResource.class, OrderResource.class));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resteasy_embedded_container"><a class="anchor" href="#_resteasy_embedded_container"></a>43. Embedded Containers</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The <code>org.jboss.resteasy.plugins.server.embedded.EmbeddedJaxrsServer</code> is deprecated and replaced by <code>org.jboss.resteasy.plugins.server.embedded.EmbeddedServer</code> and <code>jakarta.ws.rs.SeBootstrap.Instance</code>.
The preference should be to use the <a href="#_se_bootstrap">SeBootstrap API</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>RESTEasy has a few different plugins for different embeddable HTTP and/or Servlet containers, if using RESTEasy in a test environment or within an environment where you do not want a Servlet engine dependency.</p>
</div>
<div class="sect2">
<h3 id="_undertow"><a class="anchor" href="#_undertow"></a>43.1. Undertow</h3>
<div class="paragraph">
<p>Undertow is a new Servlet Container that is used by WildFly (JBoss Community Server).  It can be embedded if desired.
Here&#8217;s a test that shows it in action.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">io.undertow.servlet.api.DeploymentInfo</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.plugins.server.undertow.UndertowJaxrsServer</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.test.TestPortProvider</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.AfterAll</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Assertions</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeAll</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.ApplicationPath</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.GET</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Path</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Produces</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.Client</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.ClientBuilder</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Application</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="comment">/**
 * @author &lt;a href=&quot;mailto:bill@burkecentral.com&quot;&gt;Bill Burke&lt;/a&gt;
 * @version $Revision: 1 $
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">UndertowTest</span> {
   <span class="directive">private</span> <span class="directive">static</span> UndertowJaxrsServer server;

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/test</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Resource</span> {
      <span class="annotation">@GET</span>
      <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
      <span class="directive">public</span> <span class="predefined-type">String</span> get() {
         <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>;
      }
   }

   <span class="annotation">@ApplicationPath</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/base</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MyApp</span> <span class="directive">extends</span> Application {
      <span class="annotation">@Override</span>
      <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; getClasses() {
         <span class="keyword">return</span> <span class="predefined-type">Set</span>.of(Resource.class);
      }
   }

   <span class="annotation">@BeforeAll</span>
   <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> init() <span class="directive">throws</span> <span class="exception">Exception</span> {
      server = <span class="keyword">new</span> UndertowJaxrsServer().start();
   }

   <span class="annotation">@AfterAll</span>
   <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> stop() <span class="directive">throws</span> <span class="exception">Exception</span> {
      server.stop();
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testApplicationPath() <span class="directive">throws</span> <span class="exception">Exception</span> {
      server.deployOldStyle(MyApp.class);
      <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
          <span class="predefined-type">String</span> val = client.target(TestPortProvider.generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/base/test</span><span class="delimiter">&quot;</span></span>))
                             .request().get(<span class="predefined-type">String</span>.class);
          Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>, val);
      }
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testApplicationContext() <span class="directive">throws</span> <span class="exception">Exception</span> {
      server.deployOldStyle(MyApp.class, <span class="string"><span class="delimiter">&quot;</span><span class="content">/root</span><span class="delimiter">&quot;</span></span>);
      <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
          <span class="predefined-type">String</span> val = client.target(TestPortProvider.generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/root/test</span><span class="delimiter">&quot;</span></span>))
                             .request().get(<span class="predefined-type">String</span>.class);
          Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>, val);
      }
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> testDeploymentInfo() <span class="directive">throws</span> <span class="exception">Exception</span> {
      DeploymentInfo di = server.undertowDeployment(MyApp.class);
      di.setContextPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">/di</span><span class="delimiter">&quot;</span></span>);
      di.setDeploymentName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DI</span><span class="delimiter">&quot;</span></span>);
      server.deploy(di);
      <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
          <span class="predefined-type">String</span> val = client.target(TestPortProvider.generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/di/base/test</span><span class="delimiter">&quot;</span></span>))
                             .request().get(<span class="predefined-type">String</span>.class);
          Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>, val);
      }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oracle_jdk_http_server"><a class="anchor" href="#_oracle_jdk_http_server"></a>43.2. Oracle JDK HTTP Server</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This module is deprecated and should not be used.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Oracle JDK comes with a simple HTTP server implementation (<code>com.sun.net.httpserver.HttpServer</code>) on which RESTEasy can be run on top of.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="directive">final</span> <span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    HttpServer httpServer = HttpServer.create(<span class="keyword">new</span> <span class="predefined-type">InetSocketAddress</span>(port), <span class="integer">10</span>);
    contextBuilder = <span class="keyword">new</span> HttpContextBuilder();
    contextBuilder.getDeployment().getActualResourceClasses().add(SimpleResource.class);
    HttpContext context = contextBuilder.bind(httpServer);
    context.getAttributes().put(<span class="string"><span class="delimiter">&quot;</span><span class="content">some.config.info</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">42</span><span class="delimiter">&quot;</span></span>);
    httpServer.start();

    contextBuilder.cleanup();
    httpServer.stop(<span class="integer">0</span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create the HttpServer as desired, then use the <code>org.jboss.resteasy.plugins.server.sun.http.HttpContextBuilder</code> to initialize Resteasy and bind it to an <code>HttpContext</code>.
The <code>HttpContext</code> attributes are available by injecting an <code>org.jboss.resteasy.spi.ResteasyConfiguration</code> interface using <code>@Context</code> within the provider and resource classes.</p>
</div>
<div class="paragraph">
<p>Maven project you must include is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-jdk-http<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_netty"><a class="anchor" href="#_netty"></a>43.3. Netty</h3>
<div class="paragraph">
<p>RESTEasy has integration with the popular Netty project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> start(ResteasyDeployment deployment) <span class="directive">throws</span> <span class="exception">Exception</span> {
    netty = <span class="keyword">new</span> NettyJaxrsServer();
    netty.setDeployment(deployment);
    netty.setPort(TestPortProvider.getPort());
    netty.setRootResourcePath(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
    netty.setSecurityDomain(<span class="predefined-constant">null</span>);
    netty.start();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Include this archive to use netty4</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-netty4<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reactor_netty"><a class="anchor" href="#_reactor_netty"></a>43.4. Reactor-Netty</h3>
<div class="paragraph">
<p>RESTEasy integrates with the reactor-netty project.
This server adapter was created to pair with RESTEasy&#8217;s reactor-netty based Jakarta RESTful Web Services client integration.
Ultimately, if using reactor-netty for both the server and server-contained clients it will be possible to do things like share the same event loop for both server and client calls.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> start(ResteasyDeployment deployment) <span class="directive">throws</span> <span class="exception">Exception</span> {
    ReactorNettyJaxrsServer server =  <span class="keyword">new</span> ReactorNettyJaxrsServer();
    server.setDeployment(<span class="keyword">new</span> ResteasyDeploymentImpl());
    server.setDeployment(deployment);
    server.setPort(TestPortProvider.getPort());
    server.setRootResourcePath(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
    server.setSecurityDomain(<span class="predefined-constant">null</span>);
    server.start();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Include this archive to use the reactor netty feature</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-reactor-netty<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vert_x"><a class="anchor" href="#_vert_x"></a>43.5. Vert.x</h3>
<div class="paragraph">
<p>RESTEasy has integration with the popular Vert.x project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> start(VertxResteasyDeployment deployment) <span class="directive">throws</span> <span class="exception">Exception</span> {
    VertxJaxrsServer server = <span class="keyword">new</span> VertxJaxrsServer();
    server.setDeployment(deployment);
    server.setPort(TestPortProvider.getPort());
    server.setRootResourcePath(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>);
    server.setSecurityDomain(<span class="predefined-constant">null</span>);
    server.start();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Include this archive to use the Vertx feature</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-vertx<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The server will bootstrap its own Vert.x instance and Http server.</p>
</div>
<div class="paragraph">
<p>When a resource is called, it is done with the Vert.x Event Loop thread, keep in mind not block this thread and respect the Vert.x programming model, see the related Vert.x <a href="http://vertx.io/docs/vertx-core/java/#_don_t_block_me">manual page</a>.</p>
</div>
<div class="paragraph">
<p>Vert.x extends the RESTEasy registry to  provide a new binding scope that creates resources per Event Loop:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">VertxResteasyDeployment deployment = <span class="keyword">new</span> VertxResteasyDeployment();
<span class="comment">// Create an instance of resource per Event Loop</span>
deployment.getRegistry().addPerInstanceResource(Resource.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The per instance binding scope caches the same resource instance for each event loop providing the same concurrency model than a verticle deployed multiple times.</p>
</div>
<div class="paragraph">
<p>Vert.x can also embed a RESTEasy deployment, making it easy to use Jakarta RESTful Web Services annotated controller in Vert.x applications:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="directive">final</span> <span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    Vertx vertx = Vertx.vertx();
    HttpServer server = vertx.createHttpServer();

    <span class="comment">// Set an handler calling Resteasy</span>
    server.requestHandler(<span class="keyword">new</span> VertxRequestHandler(vertx, deployment));

    <span class="comment">// Start the server</span>
    server.listen(<span class="integer">8080</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Vert.x objects can be injected in annotated resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/somepath</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> context(
        <span class="annotation">@Context</span> io.vertx.core.Context context,
        <span class="annotation">@Context</span> io.vertx.core.Vertx vertx,
        <span class="annotation">@Context</span> io.vertx.core.http.HttpServerRequest req,
        <span class="annotation">@Context</span> io.vertx.core.http.HttpServerResponse resp) {
    <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">the-response</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_embeddedjaxrsserver"><a class="anchor" href="#_embeddedjaxrsserver"></a>43.6. EmbeddedJaxrsServer</h3>
<div class="paragraph">
<p><code>EmbeddedJaxrsServer</code> is a deprecated interface provided to enable each embedded container wrapper class to configure, start and stop its container in a standard fashion.
Each server <code>UndertowJaxrsServer</code>, <code>SunHttpJaxrsServer</code>, <code>NettyJaxrsServer</code>, and <code>VertxJaxrsServer</code> implements <code>EmbeddedJaxrsServer</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">EmbeddedJaxrsServer</span>&lt;T&gt; {
    T deploy();
    T start();
    <span class="type">void</span> stop();
    ResteasyDeployment getDeployment();
    T setDeployment(ResteasyDeployment deployment);
    T setPort(<span class="type">int</span> port);
    T setHostname(<span class="predefined-type">String</span> hostname);
    T setRootResourcePath(<span class="predefined-type">String</span> rootResourcePath);
    T setSecurityDomain(SecurityDomain sc);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resteasy_server_side_mock_framework"><a class="anchor" href="#_resteasy_server_side_mock_framework"></a>44. Server-side Mock Framework</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although RESTEasy has an Embeddable Container, you may not be comfortable with the idea of starting and stopping a web server within unit tests.
In reality, the embedded container starts in milliseconds.
You might not like the idea of using Apache HTTP Client or <code>java.net.URL</code> to test your code.
RESTEasy provides a mock framework so that you can invoke on your resource directly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> testMocking() <span class="directive">throws</span> <span class="exception">Exception</span> {

    Dispatcher dispatcher = MockDispatcherFactory.createDispatcher();

    POJOResourceFactory noDefaults = <span class="keyword">new</span> POJOResourceFactory(LocatingResource.class);
    dispatcher.getRegistry().addResourceFactory(noDefaults);
    MockHttpRequest request = MockHttpRequest.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">/locating/basic</span><span class="delimiter">&quot;</span></span>);
    MockHttpResponse response = <span class="keyword">new</span> MockHttpResponse();

    dispatcher.invoke(request, response);

    Assertions.assertEquals(HttpServletResponse.SC_OK, response.getStatus());
    Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span>, response.getContentAsString());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the RESTEasy Javadoc for all the ease-of-use methods associated with <code>MockHttpRequest</code>, and <code>MockHttpResponse</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_securing_jakarta_rest_and_resteasy"><a class="anchor" href="#_securing_jakarta_rest_and_resteasy"></a>45. Securing Jakarta RESTful Web Services and RESTEasy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because RESTEasy is deployed as a servlet, standard web.xml constraints must be used to enable authentication and authorization.</p>
</div>
<div class="paragraph">
<p>Unfortunately, web.xml constraints do not mesh very well with Jakarta RESTful Web Services in some situations.
The problem is that web.xml URL pattern matching is limited.
URL patterns in web.xml only support simple wildcards, so Jakarta RESTful Web Services resources such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>/{pathparam1}/foo/bar/{pathparam2}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cannot be mapped as a web.xml URL pattern like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>/*/foo/bar/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>To resolve this issue, use the security annotations defined below on your Jakarta RESTful Web Services methods.
Some general security constraint elements will still need to be declared in web.xml to turn on authentication.</p>
</div>
<div class="paragraph">
<p>RESTEasy supports the <code>@RolesAllowed</code>, <code>@PermitAll</code> and <code>@DenyAll</code> annotations on Jakarta RESTful Web Services methods.
By default, RESTEasy does not recognize these annotations.
RESTEasy must be configured to turn on role-based security by setting the appropriate parameter.
The code fragment below show how to enable security.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Do not turn on this switch if using Jakarta Enterprise Beans.  The Jakarta Enterprise Beans container will provide this functionality instead of RESTEasy.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
   <span class="tag">&lt;context-param&gt;</span>
      <span class="tag">&lt;param-name&gt;</span>resteasy.role.based.security<span class="tag">&lt;/param-name&gt;</span>
      <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
   <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.</p>
</div>
<div class="paragraph">
<p>RESTEasy requires that all roles used within the application be declared in the war&#8217;s web.xml file.
A security constraint that permits all of those roles access to every URL handled by the Jakarta RESTful Web Services runtime must also be declared in the web.xml.</p>
</div>
<div class="paragraph">
<p>RESTEasy performs authorization by checking the method annotations.
If a method is annotated with @RolesAllowed.
It calls HttpServletRequest.isUserInRole.
If one of the @RolesAllowed passes, the request is processed, otherwise, a response is returned with a 401 (Unauthorized) response code.</p>
</div>
<div class="paragraph">
<p>Here is an example of a modified RESTEasy WAR file.
Notice that every role declared is allowed access to every URL controlled by the RESTEasy servlet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
   <span class="tag">&lt;context-param&gt;</span>
      <span class="tag">&lt;param-name&gt;</span>resteasy.role.based.security<span class="tag">&lt;/param-name&gt;</span>
      <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
   <span class="tag">&lt;/context-param&gt;</span>

   <span class="tag">&lt;security-constraint&gt;</span>
      <span class="tag">&lt;web-resource-collection&gt;</span>
         <span class="tag">&lt;web-resource-name&gt;</span>Resteasy<span class="tag">&lt;/web-resource-name&gt;</span>
         <span class="tag">&lt;url-pattern&gt;</span>/security<span class="tag">&lt;/url-pattern&gt;</span>
      <span class="tag">&lt;/web-resource-collection&gt;</span>
       <span class="tag">&lt;auth-constraint&gt;</span>
         <span class="tag">&lt;role-name&gt;</span>admin<span class="tag">&lt;/role-name&gt;</span>
         <span class="tag">&lt;role-name&gt;</span>user<span class="tag">&lt;/role-name&gt;</span>
      <span class="tag">&lt;/auth-constraint&gt;</span>
  <span class="tag">&lt;/security-constraint&gt;</span>

   <span class="tag">&lt;login-config&gt;</span>
      <span class="tag">&lt;auth-method&gt;</span>BASIC<span class="tag">&lt;/auth-method&gt;</span>
      <span class="tag">&lt;realm-name&gt;</span>Test<span class="tag">&lt;/realm-name&gt;</span>
   <span class="tag">&lt;/login-config&gt;</span>

   <span class="tag">&lt;security-role&gt;</span>
      <span class="tag">&lt;role-name&gt;</span>admin<span class="tag">&lt;/role-name&gt;</span>
   <span class="tag">&lt;/security-role&gt;</span>
   <span class="tag">&lt;security-role&gt;</span>
      <span class="tag">&lt;role-name&gt;</span>user<span class="tag">&lt;/role-name&gt;</span>
   <span class="tag">&lt;/security-role&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_json_web_signature_and_encryption_jose_jwt"><a class="anchor" href="#_json_web_signature_and_encryption_jose_jwt"></a>46. JSON Web Signature and Encryption (JOSE-JWT)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JSON Web Signature and Encryption (JOSE JWT) specification, <a href="https://datatracker.ietf.org/doc/html/rfc7517">rfc7517</a>,
defines how to encode content as a string and either digitally sign or encrypt it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_json_web_signature_jws"><a class="anchor" href="#_json_web_signature_jws"></a>47. JSON Web Signature (JWS)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To digitally sign content using JWS, use the <code>org.jboss.resteasy.jose.jws.JWSBuilder</code> class.
To unpack and verify a JWS, use the <code>org.jboss.resteasy.jose.jws.JWSInput</code> class.
Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testRSAWithContentType() <span class="directive">throws</span> <span class="exception">Exception</span> {
  <span class="predefined-type">KeyPair</span> keyPair = <span class="predefined-type">KeyPairGenerator</span>.getInstance(<span class="string"><span class="delimiter">&quot;</span><span class="content">RSA</span><span class="delimiter">&quot;</span></span>).generateKeyPair();

  <span class="predefined-type">String</span> encoded = <span class="keyword">new</span> JWSBuilder()
          .contentType(MediaType.TEXT_PLAIN_TYPE)
          .content(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>, MediaType.TEXT_PLAIN_TYPE)
          .rsa256(keyPair.getPrivate());

  <span class="predefined-type">System</span>.out.println(encoded);

  JWSInput input = <span class="keyword">new</span> JWSInput(encoded, ResteasyProviderFactory.getInstance());
  <span class="predefined-type">System</span>.out.println(input.getHeader());
  <span class="predefined-type">String</span> msg = (<span class="predefined-type">String</span>)input.readContent(<span class="predefined-type">String</span>.class);
  Assert.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>, msg);
  Assert.assertTrue(RSAProvider.verify(input, keyPair.getPublic()));

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_json_web_encryption_jwe"><a class="anchor" href="#_json_web_encryption_jwe"></a>48. JSON Web Encryption (JWE)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To encrypt content using JWE, use the <code>org.jboss.resteasy.jose.jwe.JWEBuilder</code> class.
To decrypt content using JWE, use the <code>org.jboss.resteasy.jose.jwe.JWEInput</code> class.
Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testRSA() <span class="directive">throws</span> <span class="exception">Exception</span> {
  <span class="predefined-type">KeyPair</span> keyPair = <span class="predefined-type">KeyPairGenerator</span>.getInstance(<span class="string"><span class="delimiter">&quot;</span><span class="content">RSA</span><span class="delimiter">&quot;</span></span>).generateKeyPair();

  <span class="predefined-type">String</span> content = <span class="string"><span class="delimiter">&quot;</span><span class="content">Live long and prosper.</span><span class="delimiter">&quot;</span></span>;

  {
      <span class="predefined-type">String</span> encoded = <span class="keyword">new</span> JWEBuilder().contentBytes(content.getBytes()).RSA1_5((<span class="predefined-type">RSAPublicKey</span>)keyPair.getPublic());
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">encoded: </span><span class="delimiter">&quot;</span></span> + encoded);
      <span class="type">byte</span><span class="type">[]</span> raw = <span class="keyword">new</span> JWEInput(encoded).decrypt((<span class="predefined-type">RSAPrivateKey</span>)keyPair.getPrivate()).getRawContent();
      <span class="predefined-type">String</span> from = <span class="keyword">new</span> <span class="predefined-type">String</span>(raw);
      Assert.assertEquals(content, from);
  }
  {
     <span class="predefined-type">String</span> encoded = <span class="keyword">new</span> JWEBuilder().contentBytes(content.getBytes()).RSA_OAEP((<span class="predefined-type">RSAPublicKey</span>)keyPair.getPublic());
     <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">encoded: </span><span class="delimiter">&quot;</span></span> + encoded);
     <span class="type">byte</span><span class="type">[]</span> raw = <span class="keyword">new</span> JWEInput(encoded).decrypt((<span class="predefined-type">RSAPrivateKey</span>)keyPair.getPrivate()).getRawContent();
     <span class="predefined-type">String</span> from = <span class="keyword">new</span> <span class="predefined-type">String</span>(raw);
     Assert.assertEquals(content, from);
  }
  {
     <span class="predefined-type">String</span> encoded = <span class="keyword">new</span> JWEBuilder().contentBytes(content.getBytes()).A128CBC_HS256().RSA1_5((<span class="predefined-type">RSAPublicKey</span>)keyPair.getPublic());
     <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">encoded: </span><span class="delimiter">&quot;</span></span> + encoded);
     <span class="type">byte</span><span class="type">[]</span> raw = <span class="keyword">new</span> JWEInput(encoded).decrypt((<span class="predefined-type">RSAPrivateKey</span>)keyPair.getPrivate()).getRawContent();
     <span class="predefined-type">String</span> from = <span class="keyword">new</span> <span class="predefined-type">String</span>(raw);
     Assert.assertEquals(content, from);
  }
  {
     <span class="predefined-type">String</span> encoded = <span class="keyword">new</span> JWEBuilder().contentBytes(content.getBytes()).A128CBC_HS256().RSA_OAEP((<span class="predefined-type">RSAPublicKey</span>)keyPair.getPublic());
     <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">encoded: </span><span class="delimiter">&quot;</span></span> + encoded);
     <span class="type">byte</span><span class="type">[]</span> raw = <span class="keyword">new</span> JWEInput(encoded).decrypt((<span class="predefined-type">RSAPrivateKey</span>)keyPair.getPrivate()).getRawContent();
     <span class="predefined-type">String</span> from = <span class="keyword">new</span> <span class="predefined-type">String</span>(raw);
     Assert.assertEquals(content, from);
  }
}

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testDirect() <span class="directive">throws</span> <span class="exception">Exception</span> {
  <span class="predefined-type">String</span> content = <span class="string"><span class="delimiter">&quot;</span><span class="content">Live long and prosper.</span><span class="delimiter">&quot;</span></span>;
  <span class="predefined-type">String</span> encoded = <span class="keyword">new</span> JWEBuilder().contentBytes(content.getBytes()).dir(<span class="string"><span class="delimiter">&quot;</span><span class="content">geheim</span><span class="delimiter">&quot;</span></span>);
  <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">encoded: </span><span class="delimiter">&quot;</span></span> + encoded);
  <span class="type">byte</span><span class="type">[]</span> raw = <span class="keyword">new</span> JWEInput(encoded).decrypt(<span class="string"><span class="delimiter">&quot;</span><span class="content">geheim</span><span class="delimiter">&quot;</span></span>).getRawContent();
  <span class="predefined-type">String</span> from = <span class="keyword">new</span> <span class="predefined-type">String</span>(raw);
  Assert.assertEquals(content, from);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_signature"><a class="anchor" href="#_signature"></a>49. Doseta Digital Signature Framework</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Digital signatures allow the protection of the integrity of a message.
They are used to verify that a transmitted message was sent by the actual user and the sent message was not modified in transit.
Most web applications handle message integrity by using TLS, like HTTPS, to secure the connection between the client and server.
Sometimes there will be representations that are going to be forwarded to more than one recipient.
Some representations may hop around from server to server.
In this case, TLS is not enough.
There needs to be a mechanism to verify who sent the original representation and that they actually sent that message.
This is where digital signatures come in.</p>
</div>
<div class="paragraph">
<p>While the mime type multiple/signed exists, it does have drawbacks.
Most importantly it requires the receiver of the message body to understand how to unpack it.
A receiver may not understand this mime type.
A better approach would be to put signatures in an HTTP header so that receivers that don&#8217;t need to worry about the digital signature, don&#8217;t have to.</p>
</div>
<div class="paragraph">
<p>The email world has a protocol called <a href="http://dkim.org">Domain Keys Identified Mail</a> (DKIM). Work is underway to apply this header to protocols other than email (i.e.
HTTP) through the <a href="https://tools.ietf.org/html/draft-crocker-doseta-base-02">DOSETA
  specifications</a>.
It allows the user to sign a message body and attach the signature via a DKIM-Signature header.
Signatures are calculated by first hashing the message body then combining this hash with an arbitrary set of metadata included within the DKIM-Signature header.
Other request or response headers can be added to the calculation of the signature.
Adding metadata to the signature calculation gives a lot of flexibility to piggyback various features like expiration and authorization.
Here&#8217;s what an example DKIM-Signature header might look like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>DKIM-Signature: v=1;
                a=rsa-sha256;
                d=example.com;
                s=burke;
                c=simple/simple;
                h=Content-Type;
                x=0023423111111;
                bh=2342322111;
                b=M232234=</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see it is a set of name value pairs delimited by a ';'. While it is not THAT important to know the structure of the header, here&#8217;s an explanation of each parameter:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">v</dt>
<dd>
<p>Protocol version.
Always 1.</p>
</dd>
<dt class="hdlist1">a</dt>
<dd>
<p>Algorithm used to hash and sign the message.
RSA signing and SHA256 hashing is the only supported algorithm at the moment by RESTEasy.</p>
</dd>
<dt class="hdlist1">d</dt>
<dd>
<p>Domain of the signer.
This is used to identify the signer as well as discover the public key to use to verify the signature.</p>
</dd>
<dt class="hdlist1">s</dt>
<dd>
<p>Selector of the domain.
Also used to identify the signer and discover the public key.</p>
</dd>
<dt class="hdlist1">c</dt>
<dd>
<p>Canonical algorithm.
Only simple/simple is supported at the moment.
This allows the transform of the message body before calculating the hash</p>
</dd>
<dt class="hdlist1">h</dt>
<dd>
<p>Semi-colon delimited list of headers that are included in the signature calculation.</p>
</dd>
<dt class="hdlist1">x</dt>
<dd>
<p>Signature expiration.
This is a numeric long value of the time in seconds since epoch.
Allows signer to control when a signed message&#8217;s signature expires</p>
</dd>
<dt class="hdlist1">t</dt>
<dd>
<p>Signature timestamp.
Numeric long value of the time in seconds since epoch.
Allows the verifier to control when a signature expires.</p>
</dd>
<dt class="hdlist1">bh</dt>
<dd>
<p>Base 64 encoded hash of the message body.</p>
</dd>
<dt class="hdlist1">b</dt>
<dd>
<p>Base 64 encoded signature.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>To verify a signature a public key is needed.
DKIM uses DNS text records to discover a public key.
To find a public key, the verifier concatenates the Selector (s parameter) with the domain (d parameter)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>&lt;selector&gt;._domainKey.&lt;domain&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It then takes that string and does a DNS request to retrieve a TXT record under that entry.
In the above example burke._domainKey.example.com would be used as a string.
This is an interesting way to publish public keys.
For one, it becomes very easy for verifiers to find public keys.
There&#8217;s no real central store that is needed.
DNS is an infrastructure IT knows how to deploy.
Verifiers can choose which domains they allow requests from.
RESTEasy supports discovering public keys via DNS.
It also allows the discovery of public keys within a local Java KeyStore if you do not want to use DNS.
It also allows the user to plug in their own mechanism to discover keys.</p>
</div>
<div class="paragraph">
<p>If interested in learning the possible use cases for digital signatures, here&#8217;s an informative <a href="http://bill.burkecentral.com/2011/02/21/multiple-uses-for-content-signature/">blog</a>.</p>
</div>
<div class="sect2">
<h3 id="_maven_settings"><a class="anchor" href="#_maven_settings"></a>49.1. Maven settings</h3>
<div class="paragraph">
<p>Archive, resteasy-crypto must include the project to use the digital signature framework.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-crypto<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_signing_api"><a class="anchor" href="#_signing_api"></a>49.2. Signing API</h3>
<div class="paragraph">
<p>To sign a request or response using the RESTEasy client or server framework create an instance of <code>org.jboss.resteasy.security.doseta.DKIMSignature</code>.
This class represents the DKIM-Signature header.
Instantiate the DKIMSignature object and then set the "DKIM-Signature" header of the request or response.
Here&#8217;s an example of using it on the server-side:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.security.doseta.DKIMSignature</span>;
<span class="keyword">import</span> <span class="include">java.security.PrivateKey</span>;


<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/signed</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">SignedResource</span> {
   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">manual</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> Response getManual() {
      <span class="predefined-type">PrivateKey</span> privateKey = getKey(); <span class="comment">// get the private key to sign message</span>

      DKIMSignature signature = <span class="keyword">new</span> DKIMSignature();
      signature.setSelector(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>);
      signature.setDomain(<span class="string"><span class="delimiter">&quot;</span><span class="content">samplezone.org</span><span class="delimiter">&quot;</span></span>);
      signature.setPrivateKey(privateKey);

      Response.ResponseBuilder builder = Response.ok(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>);
      builder.header(DKIMSignature.DKIM_SIGNATURE, signature);
      <span class="keyword">return</span> builder.build();
   }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="directive">final</span> <span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="comment">// client example</span>
    DKIMSignature signature = <span class="keyword">new</span> DKIMSignature();
    <span class="predefined-type">PrivateKey</span> privateKey = getKey(); <span class="comment">// go find it</span>
    signature.setSelector(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>);
    signature.setDomain(<span class="string"><span class="delimiter">&quot;</span><span class="content">samplezone.org</span><span class="delimiter">&quot;</span></span>);
    signature.setPrivateKey(privateKey);

    ClientRequest request = <span class="keyword">new</span> ClientRequest(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://...</span><span class="delimiter">&quot;</span></span>);
    request.header(<span class="string"><span class="delimiter">&quot;</span><span class="content">DKIM-Signature</span><span class="delimiter">&quot;</span></span>, signature);
    request.body(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">some body to sign</span><span class="delimiter">&quot;</span></span>);
    ClientResponse response = request.put();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To sign a message a PrivateKey is needed.
This can be generated by KeyTool or manually using regular, standard JDK Signature APIs.
RESTEasy currently only supports RSA key pairs.
The DKIMSignature class allows the user to add and control how various pieces of metadata are added to the DKIM-Signature header and the signature calculation.
See the javadoc for more details.</p>
</div>
<div class="paragraph">
<p>If including more than one signature, then add additional DKIMSignature instances to the headers of the request or response.</p>
</div>
<div class="sect3">
<h4 id="_signed_annotation"><a class="anchor" href="#_signed_annotation"></a>49.2.1. <code>@Signed</code> annotation</h4>
<div class="paragraph">
<p>Instead of using the API, RESTEasy provides an annotation alternative to the manual way of signing using a DKIMSignature instances.
RESTEasy provides annotation @org.jboss.resteasy.annotations.security.doseta.Signed.
It is required that a KeyRepository be configured as described later in this chapter.
Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">signedresource</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Signed</span>(selector=<span class="string"><span class="delimiter">&quot;</span><span class="content">burke</span><span class="delimiter">&quot;</span></span>, domain=<span class="string"><span class="delimiter">&quot;</span><span class="content">sample.com</span><span class="delimiter">&quot;</span></span>, timestamped=<span class="predefined-constant">true</span>, expires=<span class="annotation">@After</span>(hours=<span class="integer">24</span>))
<span class="directive">public</span> <span class="predefined-type">String</span> getSigned() {
  <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example uses optional annotation attributes of @Signed to create the following Content-Signature header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>DKIM-Signature: v=1;
                a=rsa-sha256;
                c=simple/simple;
                domain=sample.com;
                s=burke;
                t=02342342341;
                x=02342342322;
                bh=m0234fsefasf==;
                b=mababaddbb==</code></pre>
</div>
</div>
<div class="paragraph">
<p>This annotation also works with the client proxy framework.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_signature_verification_api"><a class="anchor" href="#_signature_verification_api"></a>49.3. Signature Verification API</h3>
<div class="paragraph">
<p>RESTEasy supports fine grain control over verification with an API to verify signatures manually.
To verify the signature the raw bytes of the HTTP message body are needed.
Using org.jboss.resteasy.spi.MarshalledEntity injection will provide access to the unmarshalled message body and the underlying raw bytes.
Here is an example of doing this on the server side:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.spi.MarshalledEntity</span>;

<span class="annotation">@POST</span>
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">verify-manual</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">void</span> verifyManual(<span class="annotation">@HeaderParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Signature</span><span class="delimiter">&quot;</span></span>) DKIMSignature signature,
                         <span class="annotation">@Context</span> KeyRepository repository,
                         <span class="annotation">@Context</span> HttpHeaders headers,
                         MarshalledEntity&lt;<span class="predefined-type">String</span>&gt; input) <span class="directive">throws</span> <span class="exception">Exception</span> {
      Verifier verifier = <span class="keyword">new</span> Verifier();
      Verification verification = verifier.addNew();
      verification.setRepository(repository);
      verification.setStaleCheck(<span class="predefined-constant">true</span>);
      verification.setStaleSeconds(<span class="integer">100</span>);
      <span class="keyword">try</span> {
          verifier.verifySignature(headers.getRequestHeaders(), input.getMarshalledBytes, signature);
      } <span class="keyword">catch</span> (<span class="exception">SignatureException</span> ex) {
      }
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">The text message posted is: </span><span class="delimiter">&quot;</span></span> + input.getEntity());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>MarshalledEntity is a generic interface.
The template parameter should be the Java type of the message body to be converted into.
A KeyRepository will have to be configured.
This is described later in this chapter.</p>
</div>
<div class="paragraph">
<p>The client side is a little different:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ClientRequest request = <span class="keyword">new</span> ClientRequest(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:9095/signed</span><span class="delimiter">&quot;</span></span>));

ClientResponse&lt;<span class="predefined-type">String</span>&gt; response = request.get(<span class="predefined-type">String</span>.class);
Verifier verifier = <span class="keyword">new</span> Verifier();
Verification verification = verifier.addNew();
verification.setRepository(repository);
response.getProperties().put(Verifier.class.getName(), verifier);

<span class="comment">// signature verification happens when you get the entity</span>
<span class="predefined-type">String</span> entity = response.getEntity();</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the client side, create a verifier and add it as a property to the ClientResponse. This will trigger the verification
interceptors.</p>
</div>
<div class="sect3">
<h4 id="_annotation_based_verification"><a class="anchor" href="#_annotation_based_verification"></a>49.3.1. Annotation-based verification</h4>
<div class="paragraph">
<p>The easiest way to verify a signature sent in an HTTP request on the server side is to use the @@org.jboss.resteasy.annotations.security.doseta.Verify (or @Verifications which is used to verify multiple signatures). Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Verify</span>
<span class="directive">public</span> <span class="type">void</span> post(<span class="predefined-type">String</span> input) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, any DKIM-Signature headers attached to the posted message body will be verified.
The public key to verify is discovered using the configured KeyRepository (discussed later in this chapter). The user can specify which specific signatures to be verified as well as define multiple verifications want via the @Verifications annotation.
Here&#8217;s a complex example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Verifications</span>({
   <span class="annotation">@Verify</span>(identifierName=<span class="string"><span class="delimiter">&quot;</span><span class="content">d</span><span class="delimiter">&quot;</span></span>, identiferValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">inventory.com</span><span class="delimiter">&quot;</span></span>, stale=<span class="annotation">@After</span>(days=<span class="integer">2</span>)),
   <span class="annotation">@Verify</span>(identifierName=<span class="string"><span class="delimiter">&quot;</span><span class="content">d</span><span class="delimiter">&quot;</span></span>, identiferValue=<span class="string"><span class="delimiter">&quot;</span><span class="content">bill.com</span><span class="delimiter">&quot;</span></span>)
})
<span class="directive">public</span> <span class="type">void</span> post(<span class="predefined-type">String</span> input) {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above is expecting 2 different signature to be included within the DKIM-Signature header.</p>
</div>
<div class="paragraph">
<p>Failed verifications will throw an <code>org.jboss.resteasy.security.doseta.UnauthorizedSignatureException</code>.
This causes a 401 error code to be sent back to the client.
Catching this exception using an ExceptionHandler allows the user to browse the failure results.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_managing_keys_via_a_keyrepository"><a class="anchor" href="#_managing_keys_via_a_keyrepository"></a>49.4. Managing Keys via a KeyRepository</h3>
<div class="paragraph">
<p>RESTEasy manages keys through an <code>org.jboss.resteasy.security.doseta.KeyRepository</code>.
By default, the KeyRepository is backed by a Java KeyStore.
Private keys are always discovered by looking into this KeyStore.
Public keys may also be discovered via a DNS text (TXT) record lookup if configured to do so.
The user can also implement and plug in their own implementation of KeyRepository.</p>
</div>
<div class="sect3">
<h4 id="_create_a_keystore"><a class="anchor" href="#_create_a_keystore"></a>49.4.1. Create a KeyStore</h4>
<div class="paragraph">
<p>Use the Java keytool to generate RSA key pairs.
Key aliases MUST HAVE the form of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;selector&gt;._domainKey.&lt;domain&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ keytool -genkeypair -alias burke._domainKey.example.com -keyalg RSA -keysize 1024 -keystore my-apps.jks</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can always import your own official certificates too.
See the JDK documentation for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configure_resteasy_to_use_the_keyrepository"><a class="anchor" href="#_configure_resteasy_to_use_the_keyrepository"></a>49.4.2. Configure RESTEasy to use the KeyRepository</h4>
<div class="paragraph">
<p>Three <code>context-param</code> elements must be declared in the application&#8217;s web.xml in order for RESTEasy to properly be configured to use the KeyRepository.
This information enables the KeyRepository to be created and made available to RESTEasy, which will use it to discover private and public keys.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;context-param&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="tag">&lt;param-name&gt;</span>resteasy.doseta.keystore.classpath<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>test.jks<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
    <span class="tag">&lt;context-param&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="tag">&lt;param-name&gt;</span>resteasy.doseta.keystore.password<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>geheim<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
    <span class="tag">&lt;context-param&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;param-name&gt;</span>resteasy.context.objects<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>org.jboss.resteasy.security.doseta.KeyRepository : org.jboss.resteasy.security.doseta.ConfiguredDosetaKeyRepository<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The Java key store to be referenced by the Resteasy signature framework must be identified using either <code>resteasy.keystore.classpath</code> or <code>resteasy.keystore.filename</code> context parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The password must be specified using the <code>resteasy.keystore.password</code> context parameter. Unfortunately the password must be in clear text.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>resteasy.context.objects parameter</code> is used to identify the classes used in creating the repository</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The user can manually register their own instance of a KeyRepository within an Application class.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.core.Dispatcher</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.security.doseta.KeyRepository</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.security.doseta.DosetaKeyRepository</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Application</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Context</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">SignatureApplication</span> <span class="directive">extends</span> Application {
   <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">HashSet</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; classes;
   <span class="directive">private</span> <span class="directive">final</span> KeyRepository repository;

   <span class="directive">public</span> SignatureApplication(<span class="annotation">@Context</span> Dispatcher dispatcher) {
      classes = <span class="predefined-type">Set</span>.of(SignedResource.class);

      repository = <span class="keyword">new</span> DosetaKeyRepository();
      repository.setKeyStorePath(<span class="string"><span class="delimiter">&quot;</span><span class="content">test.jks</span><span class="delimiter">&quot;</span></span>);
      repository.setKeyStorePassword(<span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>);
      repository.setUseDns(<span class="predefined-constant">false</span>);
      repository.start();

      dispatcher.getDefaultContextObjects().put(KeyRepository.class, repository);
   }

   <span class="annotation">@Override</span>
   <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; getClasses() {
      <span class="keyword">return</span> classes;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the client side, a KeyStore can be loaded manually, by instantiating an instance of org.jboss.resteasy.security.doseta.DosetaKeyRepository.
Then set a request attribute, "org.jboss.resteasy.security.doseta.KeyRepository", with the value of the created instance.
Use the ClientRequest.getAttributes() method to do this.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DosetaKeyRepository keyRepository = <span class="keyword">new</span> DoestaKeyRepository();
repository.setKeyStorePath(<span class="string"><span class="delimiter">&quot;</span><span class="content">test.jks</span><span class="delimiter">&quot;</span></span>);
repository.setKeyStorePassword(<span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>);
repository.setUseDns(<span class="predefined-constant">false</span>);
repository.start();

DKIMSignature signature = <span class="keyword">new</span> DKIMSignature();
signature.setDomain(<span class="string"><span class="delimiter">&quot;</span><span class="content">example.com</span><span class="delimiter">&quot;</span></span>);

ClientRequest request = <span class="keyword">new</span> ClientRequest(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://...</span><span class="delimiter">&quot;</span></span>);
request.getAttributes().put(KeyRepository.class.getName(), repository);
request.header(<span class="string"><span class="delimiter">&quot;</span><span class="content">DKIM-Signature</span><span class="delimiter">&quot;</span></span>, signatures);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_dns_to_discover_public_keys"><a class="anchor" href="#_using_dns_to_discover_public_keys"></a>49.4.3. Using DNS to Discover Public Keys</h4>
<div class="paragraph">
<p>Public keys can be discovered by a DNS text record lookup.
The web.xml must be configured to enable this feature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.doseta.use.dns<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.doseta.dns.uri<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>dns://localhost:9095<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The resteasy.doseta.dns.uri context-param is optional and allows pointing to a specific DNS server to locate text records.</p>
</div>
<div class="sect4">
<h5 id="_configuring_dns_txt_records"><a class="anchor" href="#_configuring_dns_txt_records"></a>Configuring DNS TXT Records</h5>
<div class="paragraph">
<p>DNS TXT Records are stored via a format described by the DOSETA specification.
The public key is defined via a base 64 encoding.
Text encoding can be obtained by exporting the public keys from your keystore and then using a tool like openssl to get the text-based format.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ keytool -export -alias bill._domainKey.client.com -keystore client.jks -file bill.der
$ openssl x509 -noout -pubkey -in bill.der -inform der &gt; bill.pem</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will look something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCKxct5GHz8dFw0mzAMfvNju2b3
oeAv/EOPfVb9mD73Wn+CJYXvnryhqo99Y/q47urWYWAF/bqH9AMyMfibPr6IlP8m
O9pNYf/Zsqup/7oJxrvzJU7T0IGdLN1hHcC+qRnwkKddNmD8UPEQ4BXiX4xFxbTj
NvKWLZVKGQMyy6EFVQIDAQAB
-----END PUBLIC KEY-----</code></pre>
</div>
</div>
<div class="paragraph">
<p>The DNS text record entry would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>test2._domainKey        IN      TXT     &quot;v=DKIM1; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCIKFLFWuQfDfBug688BJ0dazQ/x+GEnH443KpnBK8agpJXSgFAPhlRvf0yhqHeuI+J5onsSOo9Rn4fKaFQaQNBfCQpHSMnZpBC3X0G5Bc1HWq1AtBl6Z1rbyFen4CmGYOyRzDBUOIW6n8QK47bf3hvoSxqpY1pHdgYoVK0YdIP+wIDAQAB; t=s&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the newlines are take out.
Also, notice that the text record is a name value ';' delimited list of parameters.
The p field contains the public key.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_body_encryption_and_signing_via_smime"><a class="anchor" href="#_body_encryption_and_signing_via_smime"></a>50. Body Encryption and Signing via SMIME</h2>
<div class="sectionbody">
<div class="paragraph">
<p>S/MIME (Secure/Multipurpose Internet Mail Extensions) is a standard for public key encryption and signing of MIME data.
MIME data being a set of headers and a message body.
Its most often seen in the email world when somebody wants to encrypt and/or sign an email message they are sending across the internet.
It can also be used for HTTP requests as well which is what the RESTEasy integration with S/MIME is all about.
RESTEasy allows you to easily encrypt and/or sign an email message using the S/MIME standard.</p>
</div>
<div class="sect2">
<h3 id="_maven_settings_2"><a class="anchor" href="#_maven_settings_2"></a>50.1. Maven settings</h3>
<div class="paragraph">
<p>Reference the resteasy-crypto archive to use the smime framework.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-crypto<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_message_body_encryption"><a class="anchor" href="#_message_body_encryption"></a>50.2. Message Body Encryption</h3>
<div class="paragraph">
<p>While HTTPS is used to encrypt the entire HTTP message, S/MIME encryption is used solely for the message body of the HTTP request or response.
This is very useful if there is a representation that may be forwarded by multiple parties (for example, HornetQ&#8217;s REST Messaging integration!) and the message needed to be protected from prying eyes as it travels across the network.
RESTEasy has two different interfaces for encrypting message bodies.
One for output, one for input.
If the client or server wants to send an HTTP request or response with an encrypted body, it uses the <code>org.jboss.resteasy.security.smime.EnvelopedOutput</code> type.
Encrypting a body also requires an X509 certificate which can be generated by the Java keytool command-line interface, or the openssl tool that comes installed on many OS&#8217;s.
Here&#8217;s an example of using the <code>EnvelopedOutput</code> interface:</p>
</div>
<div class="listingblock">
<div class="title">Server Side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">encrypted</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@GET</span>
<span class="directive">public</span> EnvelopedOutput getEncrypted(){
   Customer cust = <span class="keyword">new</span> Customer();
   cust.setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>);

   <span class="predefined-type">X509Certificate</span> certificate = createCert();
   EnvelopedOutput output = <span class="keyword">new</span> EnvelopedOutput(cust, MediaType.APPLICATION_XML_TYPE);
   output.setCertificate(certificate);
   <span class="keyword">return</span> output;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Client Side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// client side</span>
<span class="predefined-type">X509Certificate</span> cert = createCert();
Customer cust = <span class="keyword">new</span> Customer();
cust.setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>);
EnvelopedOutput output = <span class="keyword">new</span> EnvelopedOutput(cust, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>);
output.setCertificate(cert);
Response res = target.request().post(<span class="predefined-type">Entity</span>.entity(output, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/pkcs7-mime</span><span class="delimiter">&quot;</span></span>).post();</code></pre>
</div>
</div>
<div class="paragraph">
<p>An EnvelopedOutput instance is created passing in the entity to be marshaled and the media type to marshal into.
In this example, a Customer class is being marshaled into XML before it is encrypted.
RESTEasy will then encrypt the EnvelopedOutput using the BouncyCastle framework&#8217;s SMIME integration.
The output is a Base64 encoding and would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>Content-Type: application/pkcs7-mime; smime-type=enveloped-data; name=&quot;smime.p7m&quot;
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename=&quot;smime.p7m&quot;

MIAGCSqGSIb3DQEHA6CAMIACAQAxgewwgekCAQAwUjBFMQswCQYDVQQGEwJBVTETMBEGA1UECBMK
U29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkAgkA7oW81OriflAw
DQYJKoZIhvcNAQEBBQAEgYCfnqPK/O34DFl2p2zm+xZQ6R+94BqZHdtEWQN2evrcgtAng+f2ltIL
xr/PiK+8bE8wDO5GuCg+k92uYp2rLKlZ5BxCGb8tRM4kYC9sHbH2dPaqzUBhMxjgWdMCX6Q7E130
u9MdGcP74Ogwj8fNl3lD4sx/0k02/QwgaukeY7uNHzCABgkqhkiG9w0BBwEwFAYIKoZIhvcNAwcE
CDRozFLsPnSgoIAEQHmqjSKAWlQbuGQL9w4nKw4l+44WgTjKf7mGWZvYY8tOCcdmhDxRSM1Ly682
Imt+LTZf0LXzuFGTsCGOUo742N8AAAAAAAAAAAAA</code></pre>
</div>
</div>
<div class="paragraph">
<p>Decrypting an S/MIME encrypted message requires using the org.jboss.resteasy.security.smime.EnvelopedInput interface.
Both the private key and X509Certificate used to encrypt the message are also needed.
Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="title">Server Side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">encrypted</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@POST</span>
<span class="directive">public</span> <span class="type">void</span> postEncrypted(EnvelopedInput&lt;Customer&gt; input) {
   <span class="predefined-type">PrivateKey</span> privateKey = createKey();
   <span class="predefined-type">X509Certificate</span> certificate = createCert();
   Customer cust = input.getEntity(privateKey, certificate);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Client Side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ClientRequest request = <span class="keyword">new</span> ClientRequest(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:9095/smime/encrypted</span><span class="delimiter">&quot;</span></span>);
EnvelopedInput input = request.getTarget(EnvelopedInput.class);
Customer cust = (Customer)input.getEntity(Customer.class, privateKey, cert);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both examples simply call the <code>getEntity()</code> method passing in the <code>PrivateKey</code> and <code>X509Certificate</code> instances requires to decrypt the message.
On the server side, a generic is used with <code>EnvelopedInput</code> to specify the type to marshal to.
On the server side this information is passed as a parameter to <code>getEntity()</code>. The message is in MIME format: a
Content-Type header and body, so the <code>EnvelopedInput</code> class has everything it needs to both decrypt and unmarshall the entity.</p>
</div>
</div>
<div class="sect2">
<h3 id="_message_body_signing"><a class="anchor" href="#_message_body_signing"></a>50.3. Message Body Signing</h3>
<div class="paragraph">
<p>S/MIME allows the user to digitally sign a message.
It is different than the Doseta Digital Signing Framework.
Doseta is an HTTP header that contains the signature.
S/MIME uses the multipart/signed data format which is a multipart message that contains the entity and the digital signature.
Doseta is a header, S/MIME is its own media type.
S/MIME signatures require the client to know how to parse a multipart message and Doseta doesn&#8217;t.
It is left to the user to select the method to use.</p>
</div>
<div class="paragraph">
<p>RESTEasy has two different interfaces for creating a multipart/signed message.
One for input, one for output.
If the client or server is to send an HTTP request or response with a multipart/signed body, it uses the <code>org.jboss.resteasy.security.smime.SignedOutput</code> type.
This type requires both the PrivateKey and X509Certificate to create the signature.
Here&#8217;s an example of signing an entity and sending a multipart/signed entity.</p>
</div>
<div class="listingblock">
<div class="title">Server Side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">signed</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@GET</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/signed</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> SignedOutput getSigned() {
    Customer cust = <span class="keyword">new</span> Customer();
    cust.setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>);

    SignedOutput output = <span class="keyword">new</span> SignedOutput(cust, MediaType.APPLICATION_XML_TYPE);
    output.setPrivateKey(privateKey);
    output.setCertificate(certificate);
    <span class="keyword">return</span> output;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Client Side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newClient();
WebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:9095/smime/signed</span><span class="delimiter">&quot;</span></span>);
Customer cust = <span class="keyword">new</span> Customer();
cust.setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bill</span><span class="delimiter">&quot;</span></span>);
SignedOutput output = <span class="keyword">new</span> SignedOutput(cust, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>);
output.setPrivateKey(privateKey);
output.setCertificate(cert);
Response res = target.request().post(<span class="predefined-type">Entity</span>.entity(output, <span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/signed</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>An SignedOutput instance is created passing in the entity wanted to be marshaled and the media type to marshal into.
In this example, a Customer class is marshaled into XML before it is sign.
RESTEasy will then sign the SignedOutput using the BouncyCastle framework&#8217;s SMIME integration.
The output would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>Content-Type: multipart/signed; protocol=&quot;application/pkcs7-signature&quot;; micalg=sha1;  boundary=&quot;----=_Part_0_1083228271.1313024422098&quot;

------=_Part_0_1083228271.1313024422098
Content-Type: application/xml
Content-Transfer-Encoding: 7bit

&lt;customer name=&quot;bill&quot;/&gt;
------=_Part_0_1083228271.1313024422098
Content-Type: application/pkcs7-signature; name=smime.p7s; smime-type=signed-data
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename=&quot;smime.p7s&quot;
Content-Description: S/MIME Cryptographic Signature

MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAQAAMYIBVzCCAVMC
AQEwUjBFMQswCQYDVQQGEwJBVTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJu
ZXQgV2lkZ2l0cyBQdHkgTHRkAgkA7oW81OriflAwCQYFKw4DAhoFAKBdMBgGCSqGSIb3DQEJAzEL
BgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTExMDgxMTAxMDAyMlowIwYJKoZIhvcNAQkEMRYE
FH32BfR1l1vzDshtQvJrgvpGvjADMA0GCSqGSIb3DQEBAQUABIGAL3KVi3ul9cPRUMYcGgQmWtsZ
0bLbAldO+okrt8mQ87SrUv2LGkIJbEhGHsOlsgSU80/YumP+Q4lYsVanVfoI8GgQH3Iztp+Rce2c
y42f86ZypE7ueynI4HTPNHfr78EpyKGzWuZHW4yMo70LpXhk5RqfM9a/n4TEa9QuTU76atAAAAAA
AAA=
------=_Part_0_1083228271.1313024422098--</code></pre>
</div>
</div>
<div class="paragraph">
<p>To unmarshal and verify a signed message requires using the <code>org.jboss.resteasy.security.smime.SignedInput</code> interface.
Only the X509Certificate is needed to verify the message.
Here&#8217;s an example of unmarshalling and verifying a multipart/signed entity.</p>
</div>
<div class="listingblock">
<div class="title">Server Side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">signed</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@POST</span>
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">multipart/signed</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">void</span> postSigned(SignedInput&lt;Customer&gt; input) <span class="directive">throws</span> <span class="exception">Exception</span> {
    Customer cust = input.getEntity();
    <span class="keyword">if</span> (!input.verify(certificate)) {
        <span class="keyword">throw</span> <span class="keyword">new</span> WebApplicationException(<span class="integer">500</span>);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Client Side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newClient();
WebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:9095/smime/signed</span><span class="delimiter">&quot;</span></span>);
SignedInput input = target.request().get(SignedInput.class);
Customer cust = (Customer)input.getEntity(Customer.class)
input.verify(cert);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_applicationpkcs7_signature"><a class="anchor" href="#_applicationpkcs7_signature"></a>50.4. application/pkcs7-signature</h3>
<div class="paragraph">
<p>application/pkcs7-signature is a data format that includes both the data and the signature in one ASN.1 binary encoding.</p>
</div>
<div class="paragraph">
<p>SignedOutput and SignedInput can be used to return application/pkcs7-signature format in binary form.
Just change the @Produces or @Consumes to that media type to send back that format.</p>
</div>
<div class="paragraph">
<p>Also, if the @Produces or @Consumes is text/plain instead, SignedOutput will be base64 encoded and sent as a string.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resteasy_enterprise_bean_integration"><a class="anchor" href="#_resteasy_enterprise_bean_integration"></a>51. Jakarta Enterprise Beans Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy currently only has simple integration with Jakarta Enterprise Beans. To make a bean a Jakarta RESTful Web Services resource, an SLSB&#8217;s
<code>@Remote</code> or <code>@Local</code> interface must be annotated with Jakarta RESTful Web Services annotations. Also, the application&#8217;s beans must be
configured in web.xml.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Local</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/Library</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Library</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/books/{isbn}</span><span class="delimiter">&quot;</span></span>)
   <span class="predefined-type">String</span> getBook(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">isbn</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> isbn);
}

<span class="annotation">@Stateless</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">LibraryBean</span> <span class="directive">implements</span> Library {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, in RESTEasy&#8217;s web.xml file manually register the bean with RESTEasy using the <code>resteasy.jndi.resources</code> context-param</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
   <span class="tag">&lt;display-name&gt;</span>Example EJB<span class="tag">&lt;/display-name&gt;</span>
   <span class="tag">&lt;context-param&gt;</span>
      <span class="tag">&lt;param-name&gt;</span>resteasy.jndi.resources<span class="tag">&lt;/param-name&gt;</span>
      <span class="tag">&lt;param-value&gt;</span>LibraryBean/local<span class="tag">&lt;/param-value&gt;</span>
   <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the only portable way RESTEasy offers Jakarta Enterprise Beans integration.
Future versions of RESTEasy will have tighter integration with Wildfly, thus eliminating manual registrations or modifications to web.xml.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re using RESTEasy with an EAR and Jakarta Enterprise Beans, a good structure to have is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>my-ear.ear
|------myejb.jar
|------resteasy-jaxrs.war
       |
       ----WEB-INF/web.xml
       ----WEB-INF/lib (nothing)
|------lib/
       |
       ----All RESTEasy jar files</code></pre>
</div>
</div>
<div class="paragraph">
<p>From the distribution, remove all libraries from <code>WEB-INF/lib</code> and place them in a common EAR lib or place the RESTEasy
jar dependencies in the application server&#8217;s system classpath.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resteasy_spring_integration"><a class="anchor" href="#_resteasy_spring_integration"></a>52. Spring Integration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_integration_overview"><a class="anchor" href="#_integration_overview"></a>52.1. Overview</h3>
<div class="paragraph">
<p>There are three RESTEasy GitHub projects that provide components for RESTEasy&#8217;s Spring Framework support.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/resteasy/resteasy.git">RESTEasy</a> provides core components for Spring Framework integration.</p>
</li>
<li>
<p><a href="https://github.com/resteasy/resteasy-spring.git">RESTEasy Spring</a>: This project has been created to separate RESTEasy&#8217;s
Spring integration extensions from RESTEasy&#8217;s core code. It contains RESTEasy&#8217;s modules <code>resteasy-spring-web</code>,
<code>resteasy-spring</code>, <code>resteasy-undertow-spring</code> and related tests. These modules were moved out of the RESTEasy project
as of version 5.0.0. In maven the GAV groupId is now <code>org.jboss.resteasy.spring</code>. The artifactIds remain the same.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy.spring<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-spring<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${version.org.jboss.resteasy.spring}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</li>
<li>
<p><a href="https://github.com/resteasy/resteasy-spring-boot.git">resteasy-spring-boot</a>: provides two Spring Boot starters.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-spring-boot-starter<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${version.org.jboss.resteasy.spring.boot}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
RESTEasy currently supports Spring version 6.1
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>RESTEasy provides integrated support for Spring Framework.
It supplies a default <code>org.springframework.web.context.ContextLoaderListener</code> and
<code>org.springframework.beans.factory.config.BeanPostProcessor</code> implementation that is used to run Spring applications.
Alternatively RESTEasy provides support for registering a custom
<code>org.springframework.beans.factory.config.BeanFactoryPostProcessor</code> thus enabling the user to create their own bean factories.</p>
</div>
<div class="paragraph">
<p>Spring MVC Framework support is provided in RESTEasy.
A default implementation of Spring&#8217;s <code>org.springframework.web.servlet.DispatcherServlet</code> is supplied.</p>
</div>
<div class="paragraph">
<p>RESTEasy furnishes an Undertow based embedded Spring container in which Spring applications can run.
It supplies class <code>org.jboss.resteasy.plugins.server.undertow.spring.UndertowJaxrsSpringServer</code> which accepts a Spring context configuration file and preforms the appropriate wiring of Spring to RESTEasy.</p>
</div>
<div class="paragraph">
<p>Two types of Spring Boot starters are provided by resteasy-spring-boot.
These can be used by any regular Spring Boot application that wants to have REST endpoints and prefers RESTEasy as the JAX-RS implementation.
The starters integrate with Spring, thus Spring beans will be automatically auto-scanned, integrated, and available.
Two types of starters are available, one Servlet based for Tomcat and one for Reactor Netty.</p>
</div>
<div class="paragraph">
<p>RESTEasy supports Spring&#8217;s singleton and prototype scopes and Spring Web REST annotations.</p>
</div>
<div class="paragraph">
<p>The following subsections discuss ways of configuring these features for use in RESTEasy.
Code examples can be found in project <a href="https://github.com/resteasy/resteasy-examples.git">resteasy-examples</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_basicintegration"><a class="anchor" href="#_basicintegration"></a>52.2. Basic Integration</h3>
<div class="paragraph">
<p>Basic integration makes use of RESTEasy&#8217;s default implementations of interface <code>jakarta.servlet.ServletContextListener</code>, and classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.springframework.web.context.ContextLoaderListener</code></p>
</li>
<li>
<p><code>org.springframework.beans.factory.config.BeanPostProcessor</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.plugins.spring.SpringContextLoaderListener</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.plugins.spring.ResteasyBeanPostProcessor</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use this feature the user must add the maven resteasy-spring dependency to their project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy.spring<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-spring<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${version.org.jboss.resteasy.spring}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>RESTEasy&#8217;s <code>SpringContextLoaderListener</code> registers its <code>ResteasyBeanPostProcessor</code>.
It processes Jakarta RESTful Web Services annotations when a bean is created by a <code>BeanFactory</code>.
It automatically scans for @Provider and Jakarta RESTful Web Services resource annotations on bean classes and registers them as Jakarta RESTful Web Services resources.</p>
</div>
<div class="paragraph">
<p>A user&#8217;s application must be configured via a <code>web.xml</code> and optionally a <code>bean.xml</code> file to use these classes.
The configuration files discussed below can be found in example, <a href="https://github.com/resteasy/resteasy-spring-examples/tree/main/resteasy-spring-basic">Basic Example</a></p>
</div>
<div class="paragraph">
<p>Optionally Spring Framework can be configured to scan for the Jakarta RESTful Web Services resources and beans with a Spring configuration file.
Here is an example bean.xml that declares component scanning.
In the example code this file is named, <code>resteasy-spring-basic.xml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/beans</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:p</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/p</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:context</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/context</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span>

    <span class="content">http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;context:component-scan</span> <span class="attribute-name">base-package</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.examples.springbasic</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;context:include-filter</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">annotation</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">expression</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jakarta.ws.rs.Path</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/context:component-scan&gt;</span>
    <span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>
<span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Two or three elements will need to be added to the application&#8217;s <code>web.xml</code>.
Two listener classes must be declared.
The RESTEasy servlet must be identified.
If the user provided an optional bean.xml file, that needs to be referenced also.</p>
</div>
<div class="paragraph">
<p>Here is the content that should add into the <code>web.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;listener&gt;</span>
        <span class="tag">&lt;listener-class&gt;</span>org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap<span class="tag">&lt;/listener-class&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;/listener&gt;</span>

    <span class="tag">&lt;listener&gt;</span>
        <span class="tag">&lt;listener-class&gt;</span>org.jboss.resteasy.plugins.spring.SpringContextLoaderListener<span class="tag">&lt;/listener-class&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;/listener&gt;</span>

    <span class="tag">&lt;servlet&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>resteasy-dispatcher<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;servlet-class&gt;</span>org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher<span class="tag">&lt;/servlet-class&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tag">&lt;/servlet&gt;</span>

    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>classpath:resteasy-spring-basic.xml<span class="tag">&lt;/param-value&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Two listener classes must be declared, <code>ResteasyBootstrap</code> and <code>SpringContextLoaderListener</code>. The declaration order is critical.  ResteasyBootstrap must be declared first because <code>SpringContextLoaderListener</code> relies on <code>ServletContext</code> attributes initialized by it.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The RESTEasy servlet is declared.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>A reference to the bean.xml file must be added if the application provides one.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An alternative for using <code>HttpServletDispatcher</code> for deployment, a <code>FilterDispatcher</code> can be declared instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>resteasy-filter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>
        org.jboss.resteasy.plugins.server.servlet.FilterDispatcher
    <span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_customizedconfiguration"><a class="anchor" href="#_customizedconfiguration"></a>52.3. Customized Configuration</h3>
<div class="paragraph">
<p>The user is not limited to using RESTEasy&#8217;s <code>ContextLoaderListener</code> implementation.
The user may provide their own implementation, however such a customization will require the creation of two additional custom classes, to facilitate the wiring of needed RESTEasy classes into the Spring configuration.
An implementation of <code>org.springframework.web.WebApplicationInitializer</code> and a class that provides an instance of
<code>org.jboss.resteasy.plugins.spring.SpringBeanProcessorServletAware</code> will be needed.
<a href="https://github.com/resteasy/resteasy-spring-examples/tree/main/resteasy-spring-customized">Spring and  Resteasy Customized Example</a>
provides an example of the wiring that is required.</p>
</div>
<div class="paragraph">
<p>There are four RESTEasy classes that must be registered with Spring in the implementation of <code>WebApplicationInitializer</code>,
<code>ResteasyBootstrap</code>, <code>HttpServletDispatcher</code>, <code>ResteasyDeployment</code>, and <code>SpringBeanProcessorServletAware</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">public</span> <span class="type">void</span> onStartup(ServletContext servletContext) <span class="directive">throws</span> ServletException {
    servletContext.addListener(ResteasyBootstrap.class); <i class="conum" data-value="1"></i><b>(1)</b>
    AnnotationConfigWebApplicationContext context = <span class="keyword">new</span> AnnotationConfigWebApplicationContext();
    context.register(MyConfig.class); <i class="conum" data-value="2"></i><b>(2)</b>
    servletContext.addListener(<span class="keyword">new</span> MyContextLoaderListener(context)); <i class="conum" data-value="3"></i><b>(3)</b>
    ServletRegistration.Dynamic dispatcher = servletContext.addServlet(<span class="string"><span class="delimiter">&quot;</span><span class="content">resteasy-dispatcher</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> HttpServletDispatcher()); <i class="conum" data-value="4"></i><b>(4)</b>
    dispatcher.setLoadOnStartup(<span class="integer">1</span>);
    dispatcher.addMapping(<span class="string"><span class="delimiter">&quot;</span><span class="content">/rest/*</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>ResteasyBootstrap</code> needs to be registered in the <code>servletContext</code> so that the RESTEasy container can gain access to it.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The user&#8217;s <code>MyConfig</code> class provides RESTEasy&#8217;s implementation of <code>BeanProcessorServletAware</code> as a @Bean to the Spring container.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The user&#8217;s implementation of <code>ContextLoaderListener</code> is registered in <code>servletContext</code> so that the RESTEasy container can gain access to it.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>RESTEasy&#8217;s servlet, <code>HttpServletDispatcher</code> is registered in <code>servletContext</code> so that the RESTEasy container can gain access to it.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The user&#8217;s implementation of <code>ContextLoaderListener</code> performs two important actions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> customizeContext(ServletContext servletContext, ConfigurableWebApplicationContext configurableWebApplicationContext) {
        <span class="local-variable">super</span>.customizeContext(servletContext, configurableWebApplicationContext);

        ResteasyDeployment deployment = (ResteasyDeployment) servletContext.getAttribute(ResteasyDeployment.class.getName()); <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="keyword">if</span> (deployment == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(Messages.MESSAGES.deploymentIsNull());
        }
        SpringBeanProcessor processor = <span class="keyword">new</span> SpringBeanProcessor(deployment); <i class="conum" data-value="2"></i><b>(2)</b>
        configurableWebApplicationContext.addBeanFactoryPostProcessor(processor);
        configurableWebApplicationContext.addApplicationListener(processor);
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>an instance of RESTEasy&#8217;s <code>ResteasyDeployment</code> must be retrieved from the <code>servletContext</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>and register with Spring</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>RESTEasy&#8217;s Spring integration supports both singleton and prototype scope.
It handles injecting <code>@Context</code> references.
Constructor injection is not supported.
With the prototype scope RESTEasy will inject any <code>@*Param</code> annotated fields or setters before the request is dispatched.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only auto-proxied beans can be used with RESTEasy&#8217;s Spring integration.
There will be undesirable affects if you use hardcoded proxying with Spring, i.e., with <code>ProxyFactoryBean</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_springmvc"><a class="anchor" href="#_springmvc"></a>52.4. Spring MVC Integration</h3>
<div class="paragraph">
<p>RESTEasy can be integrated with the Spring MVC Framework.
Generally speaking, Jakarta RESTful Web Services can be combined with a Spring <code>org.springframework.web.servlet.DispatcherServlet</code> and used in the same web application.
An application combined in this way allows the application to dispatch to either the Spring controller or the Jakarta RESTful Web Services resource using the same base URL.
In addition Spring <code>ModelAndView</code> objects can be returned as arguments from <code>@GET</code> resource methods.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/resteasy/resteasy-spring-examples/tree/main/resteasy-spring-mvc">Spring MVC Integration Example</a>
demonstrates how to configure an application using Spring MVC.</p>
</div>
<div class="paragraph">
<p><code>resteasy-spring</code> provides bean xml file, <code>springmvc-resteasy.xml</code>.
It resides in the <code>org.jboss.resteasy.spring:resteasy-spring</code> archive.
The file defines the beans for the Spring MVC/RESTEasy integration.
The file is required to be imported into the user&#8217;s MVC application.
This bean file can be used as a template to define more advanced functionality, such as configuring multiple RESTEasy factories, dispatchers and registries.</p>
</div>
<div class="paragraph">
<p>In the example, the reference to <code>springmvc-resteasy.xml</code> is declared in an application provided bean xml named, <code>resteasy-spring-mvc-servlet.xml</code>.
This file imports <code>springmvc-resteasy.xml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/beans</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:context</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/context</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span>
        <span class="content">http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span>
        <span class="content">http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span>
    <span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
       <span class="tag">&lt;context:component-scan</span> <span class="attribute-name">base-package</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.examples.springmvc</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
       <span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>
       <span class="tag">&lt;import</span> <span class="attribute-name">resource</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">classpath:springmvc-resteasy.xml</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
....
<span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The application must tell Spring the package to scan for its Jakarta RESTful Web Services resource classes</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A reference to resteasy-spring project&#8217;s <code>springmvc-resteasy.xml</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The setup requires the application to provide a <code>web.xml</code> file in which a Spring <code>DispatcherServlet</code> implementation is declared.
Project resteasy-spring provides a default Spring <code>DispatcherServlet</code> implementation, <code>org.jboss.resteasy.springmvc.ResteasySpringDispatcherServlet</code>.
This is the <code>DispatcherServlet</code> used in the example code.</p>
</div>
<div class="paragraph">
<p>The <code>DispatcherServlet</code> takes as an input parameter a reference to the application&#8217;s bean file.
This reference is declared as an <code>init-param</code> to the <code>servlet</code>.</p>
</div>
<div class="paragraph">
<p>The application&#8217;s web.xml should define the servlet as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd</span><span class="delimiter">&quot;</span></span>
   <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;display-name&gt;</span>resteasy-spring-mvc<span class="tag">&lt;/display-name&gt;</span>

    <span class="tag">&lt;servlet&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>resteasy-spring-mvc<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;servlet-class&gt;</span>org.jboss.resteasy.springmvc.ResteasySpringDispatcherServlet<span class="tag">&lt;/servlet-class&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="tag">&lt;init-param&gt;</span>
            <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
            <span class="tag">&lt;param-value&gt;</span>classpath:resteasy-spring-mvc-servlet.xml<span class="tag">&lt;/param-value&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="tag">&lt;/init-param&gt;</span>
    <span class="tag">&lt;/servlet&gt;</span>
    ....
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>An implementation of Spring&#8217;s <code>DispatcherServlet</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The application&#8217;s bean xml file that imports <code>org.jboss.resteasy.spring:resteasy-spring</code> archive&#8217;s <code>springmvc-resteasy.xml</code> file.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>jakarta.ws.rs.core.Application</code> subclass can be combined with a Spring <code>DispatcherServlet</code> and used in the same web application.
In this scenario a servlet declaration is required for the Spring <code>DispatcherServlet</code> and the <code>jakarta.ws.rs.core.Application</code> subclass.
A RESTEasy Configuration Switch, <code>resteasy.scan.resources</code> must be declared as a context-param in the <code>web.xml</code>.
Here is an example of the minimum configuration information needed in the <code>web.xml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;servlet&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>mySpring<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/servlet-class&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;/servlet&gt;</span>
    <span class="tag">&lt;servlet-mapping&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>mySpring<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;/servlet-mapping&gt;</span>

    <span class="tag">&lt;servlet&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>myAppSubclass<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;servlet-class&gt;</span>org.my.app.EntryApplicationSubclass<span class="tag">&lt;/servlet-class&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tag">&lt;/servlet&gt;</span>
    <span class="tag">&lt;servlet-mapping&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>myAppSubclass<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;/servlet-mapping&gt;</span>

    <span class="comment">&lt;!-- required RESTEasy Configuration Switch directs auto scanning
         of the archive for Jakarta RESTful Web Services resource files
    --&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.scan.resources<span class="tag">&lt;/param-name&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>DispatcherServlet</code> declaration</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>Application</code> declaration</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>scanning configuration switch</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
RESTEasy parameters like <code>resteasy.scan.resources</code> may be set in a variety of ways.
See <a href="#_microprofile_config">Configuration</a> for more information about application configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the web application contains Jakarta RESTful Web Services provider classes the RESTEasy Configuration Switch, <code>resteasy.scan.providers</code>, will also be needed.
If the url-pattern for the Jakarta RESTful Web Services <code>Application</code> subclass is other than <code>/<strong></code> a declaration of RESTEasy Configuration Switch, <code>resteasy.servlet.mapping.prefix</code> will be required.
This switch can be declared either as a <code>context-param</code> or as a servlet <code>init-param</code>.
It&#8217;s value must be the text that precedes the <code>/</strong></code>.
Here is an example of such a <code>web.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;servlet&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>myAppSubclass<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;servlet-class&gt;</span>org.my.app.EntryApplicationSubclass<span class="tag">&lt;/servlet-class&gt;</span>

        <span class="tag">&lt;init-param&gt;</span>
            <span class="tag">&lt;param-name&gt;</span>resteasy.servlet.mapping.prefix<span class="tag">&lt;/param-name&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="tag">&lt;param-value&gt;</span>/resources<span class="tag">&lt;/param-value&gt;</span>
        <span class="tag">&lt;/init-param&gt;</span>
    <span class="tag">&lt;/servlet&gt;</span>
    <span class="tag">&lt;servlet-mapping&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>myAppSubclass<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;url-pattern&gt;</span>/resources/*<span class="tag">&lt;/url-pattern&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tag">&lt;/servlet-mapping&gt;</span>

    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.scan.resources<span class="tag">&lt;/param-name&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.scan.providers<span class="tag">&lt;/param-name&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Configuration switch, resteasy.servlet.mapping.prefix, specified in an init-param</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The url-pattern <code>/*</code> is preceded by /resources.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Configuration switches specified as context-params</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_springundertow"><a class="anchor" href="#_springundertow"></a>52.5. Undertow Embedded Spring Container</h3>
<div class="paragraph">
<p>Project <code>resteasy-spring</code> provides an Undertow based embedded Spring container module, <code>resteasy-undertow-spring</code>.
It provides class, <code>org.jboss.resteasy.plugins.server.undertow.spring.UndertowJaxrsSpringServer</code>.
This class has a single method, <code>undertowDeployment</code> which requires an input parameter that references a Spring context configuration file.
The Spring context configuration data is used to wire Spring into Undertow.</p>
</div>
<div class="paragraph">
<p>An example of setting up the Undertow embedded Spring container can be found in example,
<a href="https://github.com/resteasy/resteasy-spring-examples/tree/main/resteasy-spring-undertow">resteasy-spring-undertow</a></p>
</div>
<div class="paragraph">
<p>To use this container the user must add the following two archives to their maven project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>resteasy-undertow<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>resteasy-undertow-spring<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The user&#8217;s application must provide a bean xml file that imports a reference to the <code>org.jboss.resteasy.spring:resteasy-spring</code> archive&#8217;s bean file, <code>springmvc-resteasy.xml</code>.
In the example code the user&#8217;s provided file is named, <code>spring-servlet.xml</code> Here is the information needed in this file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/beans</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:p</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/p</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:context</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/context</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:util</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/util</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span>
        <span class="content">http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span>
        <span class="content">http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd</span>
        <span class="content">http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;context:component-scan</span> <span class="attribute-name">base-package</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.springmvc.test</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;import</span> <span class="attribute-name">resource</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">classpath:springmvc-resteasy.xml</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Below is a code snippet that shows the creation and configuration of the Undertow embedded Spring container.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="directive">final</span> <span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    UndertowJaxrsSpringServer server = <span class="keyword">new</span> UndertowJaxrsSpringServer(); <i class="conum" data-value="1"></i><b>(1)</b>
    server.start();

    DeploymentInfo deployment = server.undertowDeployment(<span class="string"><span class="delimiter">&quot;</span><span class="content">classpath:spring-servlet.xml</span><span class="delimiter">&quot;</span></span>, <span class="predefined-constant">null</span>); <i class="conum" data-value="2"></i><b>(2)</b>
    deployment.setDeploymentName(BasicSpringTest.class.getName());
    deployment.setContextPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>);
    deployment.setClassLoader(BasicSpringTest.class.getClassLoader());
    server.deploy(deployment);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create an instance of the Undertow Spring server</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Provide the server a reference to the user&#8217;s application bean.xml</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_springwebannotation"><a class="anchor" href="#_springwebannotation"></a>52.6. Processing Spring Web REST annotations in RESTEasy</h3>
<div class="paragraph">
<p>RESTEasy also provides the ability to process Spring Web REST annotations (i.e.
Spring classes annotated with <code>@RestController</code>) and handle related REST requests without delegating to Spring MVC.
This functionality is currently experimental.</p>
</div>
<div class="paragraph">
<p>In order for RESTEasy to be able to process Spring <code>@RestController</code>, the user must include the following maven dependency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy.spring<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-spring-web<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${version.org.jboss.resteasy.spring}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>RESTEasy does not auto-scan for <code>@RestController</code> annotated classes, so all <code>@RestController</code> annotated classes need to be declared in the application&#8217;s <code>web.xml</code> file as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"> <span class="tag">&lt;web-app&gt;</span>
   <span class="tag">&lt;display-name&gt;</span>RESTEasy application using Spring REST annotations<span class="tag">&lt;/display-name&gt;</span>

    <span class="tag">&lt;context-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>resteasy.scanned.resource.classes.with.builder<span class="tag">&lt;/param-name&gt;</span>
        <span class="tag">&lt;param-value&gt;</span>org.jboss.resteasy.spi.metadata.SpringResourceBuilder:org.example.Controller1,org.example.Controller2<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, <code>Controller1</code> and <code>Controller2</code> are registered and expected to be annotated with <code>@RestController</code>.</p>
</div>
<div class="paragraph">
<p>Currently supported annotations:</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Annotation</th>
<th class="tableblock halign-left valign-top">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RestController</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestMapping</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@GetMapping</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@PostMapping</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@PutMapping</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DeleteMapping</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@PatchMapping</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestParam</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestHeader</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@MatrixVariable</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@PathVariable</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CookieValue</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestBody</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ResponseStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only supported as a method annotation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestParam</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The use of <code>org.springframework.http.ResponseEntity</code>, <code>jakarta.servlet.http.HttpServletRequest</code> and <code>jakarta.servlet.http.HttpServletResponse</code> are supported as return values of method parameters.</p>
</div>
<div class="paragraph">
<p>A usage example can be found in sample project <a href="https://github.com/resteasy/resteasy-spring-examples/tree/main/resteasy-spring-rest">resteasy-spring-rest</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_springbootstarter"><a class="anchor" href="#_springbootstarter"></a>52.7. Spring Boot starter</h3>
<div class="paragraph">
<p>RESTEasy supports Spring Boot integration.
The code was developed by PayPal and donated to the RESTEasy community.
The project is maintained in the <a href="https://github.com/resteasy/resteasy-spring-boot">RESTEasy Spring Boot Starter Project</a>.</p>
</div>
<div class="paragraph">
<p>Here is the usage in brief:</p>
</div>
<div class="paragraph">
<p>Add this maven dependency to the Spring Boot application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
   <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
   <span class="tag">&lt;artifactId&gt;</span>resteasy-spring-boot-starter<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;version&gt;</span>${latest_version_of_restesy_spring_boot}<span class="tag">&lt;/version&gt;</span>
   <span class="tag">&lt;scope&gt;</span>runtime<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use Spring annotation <code>@Component</code> to register a Jakarta RESTful Web Services <code>Application</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.sample.app</span>;

<span class="keyword">import</span> <span class="include">org.springframework.stereotype.Component</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.ApplicationPath</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Application</span>;

<span class="annotation">@Component</span>
<span class="annotation">@ApplicationPath</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/sample-app/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">JaxrsApplication</span> <span class="directive">extends</span> Application {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To register Jakarta RESTful Web Services resources and providers, define them as Spring beans.
They will be automatically registered.
Notice that Jakarta RESTful Web Services resources can be singleton or request scoped, while Jakarta RESTful Web Services providers must be singletons.</p>
</div>
<div class="paragraph">
<p>To see an example, please check the <a href="https://github.com/resteasy/resteasy-spring-boot/tree/master/sample-app">sample-app</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_springupgradeinwildfly"><a class="anchor" href="#_springupgradeinwildfly"></a>52.8. Upgrading in Wildfly</h3>
<div class="paragraph">
<p>As noted in <a href="#_upgrading_wildfly">Upgrading RESTEasy within WildFly</a>, Galleon is used in updating RESTEasy distributions in Wildfly.
RESTEasy Spring also uses Galleon for the same task.
Follow the directions in that section to install Galleon, then run command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>galleon.sh install org.jboss.resteasy.spring:galleon-feature-pack:{CURRENT-VERSION} --dir=${WILDFLY-HOME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note Installing resteasy-spring feature pack, also installs the corresponding RESTEasy archives do to transitive dependencies.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cdi"><a class="anchor" href="#_cdi"></a>53. CDI Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This module provides integration with <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta-cdi-spec-4.1">(Contexts and Dependency Injection for the Jakarta EE platform)</a></p>
</div>
<div class="sect2">
<h3 id="_using_cdi_beans_as_jakarta_restful_web_services_components"><a class="anchor" href="#_using_cdi_beans_as_jakarta_restful_web_services_components"></a>53.1. Using CDI beans as Jakarta RESTful Web Services components</h3>
<div class="paragraph">
<p>Both the Jakarta RESTful Web Services and CDI specifications introduce their own component model.
On the one hand, every class placed in a CDI archive that fulfills a set of basic constraints is implicitly a CDI bean.
On the other hand, explicit decoration of a Java class with <code>@Path</code> or <code>@Provider</code> is required for it to become a Jakarta RESTful Web Services component.
Without the integration code, annotating a class suitable for being a CDI bean with annotations leads into a faulty result (Jakarta RESTful Web Services component not managed by CDI). Jakarta RESTful Web Services The resteasy-cdi module is a bridge that allows RESTEasy to work with class instances obtained from the CDI container.</p>
</div>
<div class="paragraph">
<p>During a web service invocation, resteasy-cdi asks the CDI container for the managed instance of a Jakarta RESTful Web Services component.
Then, this instance is passed to RESTEasy.
If a managed instance is not available for some reason (the class is placed in a jar which is not a bean deployment archive), RESTEasy falls back to instantiating the class itself.</p>
</div>
<div class="paragraph">
<p>As a result, CDI services like injection, lifecycle management, events, decoration and interceptor bindings can be used in Jakarta RESTful Web Services components.</p>
</div>
</div>
<div class="sect2">
<h3 id="_default_scopes"><a class="anchor" href="#_default_scopes"></a>53.2. Default scopes</h3>
<div class="paragraph">
<p>A CDI bean that does not explicitly define a scope is <code>@Dependent</code> scoped by default.
This pseudo scope means that the bean adapts to the lifecycle of the bean it is injected into.
Normal scopes (request, session, application) are more suitable for Jakarta RESTful Web Services components as they designate component&#8217;s lifecycle boundaries explicitly.
Therefore, the resteasy-cdi module alters the default scoping in the following way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a Jakarta RESTful Web Services root resource does not define a scope explicitly, it is bound to the Request scope.</p>
</li>
<li>
<p>If a Jakarta RESTful Web Services Provider or <code>jakarta.ws.rs.Application</code> subclass does not define a scope explicitly, it is bound to the Application scope.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the scope of all beans that do not declare a scope is modified by resteasy-cdi, this affects session beans as well.
As a result, a conflict occurs if the scope of a stateless session bean or singleton is changed automatically as the spec prohibits these components to be @RequestScoped.
Therefore, you need to explicitly define a scope when using stateless session beans or singletons.
This requirement is likely to be removed in future releases.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_within_wildfly"><a class="anchor" href="#_configuration_within_wildfly"></a>53.3. Configuration within WildFly</h3>
<div class="paragraph">
<p>CDI integration is provided with no additional configuration with WildFly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_with_different_distributions"><a class="anchor" href="#_configuration_with_different_distributions"></a>53.4. Configuration with different distributions</h3>
<div class="paragraph">
<p>Provided there is an existing RESTEasy application, all that needs to be done is to add the resteasy-cdi jar into the project&#8217;s <code>WEB-INF/lib</code> directory.
When using maven, this can be achieved by defining the following dependency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-cdi<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${project.version}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, when running a pre-Servlet 3 container, the following context parameter needs to be specified in web.xml.
(This is done automatically via web-fragment in a Servlet 3 environment)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>resteasy.injector.factory<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>org.jboss.resteasy.cdi.CdiInjectorFactory<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When deploying an application to a Servlet container that does not support CDI out of the box (Tomcat, Jetty, Google App Engine), a CDI implementation needs to be added first. <a href="http://docs.jboss.org/weld/reference/latest/en-US/html/environments.html">Weld-servlet module
            </a> can be used for this purpose.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resteasy_client_framework"><a class="anchor" href="#_resteasy_client_framework"></a>54. RESTEasy Client API</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_jakarta_restful_web_services_client_api"><a class="anchor" href="#_jakarta_restful_web_services_client_api"></a>54.1. Jakarta RESTful Web Services Client API</h3>
<div class="paragraph">
<p>The Jakarta RESTful Web Services includes a client API so the user can make http requests to remote RESTful web services.
It is a 'fluent' request building API with really 3 main classes: <code>Client</code>, <code>WebTarget</code>, and <code>Response</code>.
The <code>Client</code> interface is a builder of <code>WebTarget</code> instances.
<code>WebTarget</code> represents a distinct URL or URL template from which the user can build more sub-resource WebTargets or invoke requests on.</p>
</div>
<div class="paragraph">
<p>There are really two ways to create a <code>Client</code>.
Standard way, or to use the <code>ResteasyClientBuilder</code> class.
The advantage of the latter is that it provides a few more helper methods to configure the client.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newClient();
<span class="comment">// or</span>
client = ClientBuilder.newBuilder().build();
WebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://foo.com/resource</span><span class="delimiter">&quot;</span></span>);
Response response = target.request().get();
<span class="predefined-type">String</span> value = response.readEntity(<span class="predefined-type">String</span>.class);
response.close();  <span class="comment">// You should close connections!</span>

Client client = ClientBuilder.newClient();
WebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://foo.com/resource</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>RESTEasy will automatically load a set of default providers.
(Basically all classes listed in all <code>META-INF/services/jakarta.ws.rs.ext.Providers</code> files). Additionally, other providers, filters, and interceptors can be manually registered through the Configuration object provided by the method call <code>Client.configuration()</code>. Configuration also lets the user set various configuration properties that may be needed.</p>
</div>
<div class="paragraph">
<p>Each WebTarget has its own Configuration instance which inherits the components and properties registered with its parent.
This allows the user to set specific configuration options per target resource.
For example, username and password.</p>
</div>
<div class="paragraph">
<p>One RESTEasy extension to the client API is the ability to specify that requests should be sent in "chunked" transfer mode.
There are two ways of doing that.
One is to configure an <code>org.jboss.resteasy.client.jaxrs.ResteasyWebTarget</code> so that all requests to that target are sent in chunked mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResteasyClient client = (ResteasyClient)ClientBuilder.newClient();
ResteasyWebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/test</span><span class="delimiter">&quot;</span></span>);
target.setChunked(b.booleanValue());
Invocation.Builder request = target.request();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, it is possible to configure a particular request to be sent in chunked mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResteasyClient client = (ResteasyClient)ClientBuilder.newClient();
ResteasyWebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/test</span><span class="delimiter">&quot;</span></span>);
ClientInvocationBuilder request = (ClientInvocationBuilder) target.request();
request.setChunked(b);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>org.jboss.resteasy.client.jaxrs.internal.ClientInvocationBuilder</code>, unlike <code>jakarta.ws.rs.client.Invocation.Builder</code>, is a RESTEasy class.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The ability to send in chunked mode depends on the underlying transport layer; in particular, it depends on which implementation of <code>org.jboss.resteasy.client.jaxrs.ClientHttpEngine</code> is being used.
Currently, only the default implementation, <code>ApacheHttpClient43Engine</code>, supports chunked mode.
See Section <a href="#_transport_layer">Apache HTTP Client 4.x and other backends</a> for more information.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To follow REST principles and avoid introducing state management in applications, <code>jakarta.ws.rs.client.Client</code> instances do not provide support for cookie management by default.
However, the user can enable it if necessary using <code>ResteasyClientBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>Client client = ((ResteasyClientBuilder) ClientBuilder.newBuilder()).enableCookieManagement().build();</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_client_proxies"><a class="anchor" href="#_client_proxies"></a>54.2. RESTEasy Proxy Framework</h3>
<div class="paragraph">
<p>The RESTEasy Proxy Framework is the mirror opposite of the Jakarta RESTful Web Services server-side specification.
Instead of using Jakarta RESTful Web Services annotations to map an incoming request to Jakarta RESTful Web Services methods, the client framework builds
an HTTP request that it uses to invoke a remote Jakarta RESTful Web Services.
This remote service does not have to be a Jakarta RESTful Web Services service and can be any web resource that accepts HTTP requests.</p>
</div>
<div class="paragraph">
<p>RESTEasy has a client proxy framework that allows the use of Jakarta RESTful Web Services annotations to invoke a remote HTTP resource.
Write a Java interface and use Jakarta RESTful Web Services annotations on methods and the interface.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">SimpleClient</span> {
   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="predefined-type">String</span> getBasic();

   <span class="annotation">@PUT</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">basic</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="type">void</span> putBasic(<span class="predefined-type">String</span> body);

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">queryParam</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="predefined-type">String</span> getQueryParam(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">param</span><span class="delimiter">&quot;</span></span>)<span class="predefined-type">String</span> param);

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">matrixParam</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="predefined-type">String</span> getMatrixParam(<span class="annotation">@MatrixParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">param</span><span class="delimiter">&quot;</span></span>)<span class="predefined-type">String</span> param);

   <span class="annotation">@GET</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">uriParam/{param}</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="type">int</span> getUriParam(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">param</span><span class="delimiter">&quot;</span></span>)<span class="type">int</span> param);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>RESTEasy has a simple API to generate a proxy, then invoke methods on the proxy.
The invoked method gets translated to an HTTP request based on how the method was annotated and posted to the server.
Here&#8217;s how to set this up:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> invokeClient() {
    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
          WebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://example.com/base/uri</span><span class="delimiter">&quot;</span></span>);
          ResteasyWebTarget rtarget = (ResteasyWebTarget)target;

          SimpleClient simple = rtarget.proxy(SimpleClient.class);
          simple.putBasic(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively use the RESTEasy client extension interfaces directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> invokeClient() {
    <span class="keyword">try</span> (ResteasyClient client = (ResteasyClient)ClientBuilder.newClient()) {
        ResteasyWebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://example.com/base/uri</span><span class="delimiter">&quot;</span></span>);

        SimpleClient simple = target.proxy(SimpleClient.class);
        simple.putBasic(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello world</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@CookieParam</code> works the mirror opposite of its server-side counterpart and creates a cookie header to send to the server.
It is not needed to use <code>@CookieParam</code> if you allocate your own <code>jakarta.ws.rs.core.Cookie</code> object and pass it as a parameter to a client proxy method.
The client framework understands the cookie is being passed to the server so no extra metadata is needed.</p>
</div>
<div class="paragraph">
<p>The framework supports the Jakarta RESTful Web Services locator pattern, but on the client side.
So, if there is a method annotated only with @Path, that proxy method will return a new proxy of the interface returned by that method.</p>
</div>
<div class="sect3">
<h4 id="_custom_client_side_responses"><a class="anchor" href="#_custom_client_side_responses"></a>54.2.1. Abstract Responses</h4>
<div class="paragraph">
<p>Sometimes there is interest in viewing the response status code and/or the response headers in addition to the response body of the client request.
The Client-Proxy framework has two ways to get at this information</p>
</div>
<div class="paragraph">
<p>A <code>jakarta.ws.rs.core.Response.Status</code> enumeration can be returned from the method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">MyProxy</span> {
   <span class="annotation">@POST</span>
   Response.Status updateSite(MyPojo pojo);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Internally, after invoking the server, the client proxy internals will convert the HTTP response code into a <code>Response.Status</code> enum.</p>
</div>
<div class="paragraph">
<p>The <code>jakarta.ws.rs.core.Response</code> class provides all accessible information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">LibraryService</span> {

   <span class="annotation">@GET</span>
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
   Response getAllBooks();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_response_proxies"><a class="anchor" href="#_response_proxies"></a>54.2.2. Response proxies</h4>
<div class="paragraph">
<p>A further extension implemented by the RESTEasy client proxy framework is the "response proxy facility", where a client proxy method returns an interface that represents the information contained in a <code>jakarta.ws.rs.core.Response</code>.
Such an interface must be annotated with <code>@ResponseObject</code> from package <code>org.jboss.resteasy.annotations</code>, and its methods may be further annotated with <code>@Body</code>, <code>@LinkHeaderParam</code>, and <code>@Status</code> from the same package,  as well as <code>jakarta.ws.rs.HeaderParam</code>.
Consider the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="annotation">@ResponseObject</span>
 <span class="directive">public</span> <span class="type">interface</span> <span class="class">TestResponseObject</span> {

    <span class="annotation">@Status</span>
    <span class="type">int</span> status();

    <span class="annotation">@Body</span>
    <span class="predefined-type">String</span> body();

    <span class="annotation">@HeaderParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> contentType();

    ClientResponse response();
 }

 <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
 <span class="directive">public</span> <span class="type">interface</span> <span class="class">TestClient</span> {

    <span class="annotation">@GET</span>
    TestResponseObject get();
 }

 <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
 <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResource</span> {

    <span class="annotation">@GET</span>
    <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> get() {
       <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">ABC</span><span class="delimiter">&quot;</span></span>;
    }
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, <code>TestClient</code> will define the client side proxy for <code>TestResource</code>.
Note that <code>TestResource.get()</code> returns a <code>String</code> but the proxy based on <code>TestClient</code> will return a <code>TestResponseObject</code> on a  call to <code>get()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newClient();
TestClient ClientInterface = ProxyBuilder.builder(TestClient.class, client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081</span><span class="delimiter">&quot;</span></span>)).build();
TestResponseObject tro = ClientInterface.get();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The methods of <code>TestResponseObject</code> provide access to various pieces of information about the response received from <code>TestResponse.get()</code>.
This is where the annotations on those methods come into play. <code>status()</code> is annotated with <code>@Status</code>, and a call to <code>status()</code> returns the HTTP status.
Similarly, <code>body()</code> returns the returned entity, and <code>contentType()</code> returns the value of the response header Content-Type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>System.out.printf(&quot;status: %s&quot;, tro.status());
System.out.printf(&quot;entity: %s%n&quot;, tro.body());
System.out.printf(&quot;Content-Type: %s%n&quot;, tro.contentType());</code></pre>
</div>
</div>
<div class="paragraph">
<p>will yield</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>status: 200
entity: ABC
Content-Type: text/plain;charset=UTF-8</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that there is one other method in <code>TestResponseObject</code>, <code>response()</code>, that has no annotation.
When RESTEasy sees a method in an interface annotated with <code>@ResponseObject</code> that returns a <code>jakarta.ws.rs.core.Response</code> (or a subclass thereof), it will return a <code>org.jboss.resteasy.client.jaxrs.internal.ClientResponse</code>.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ClientResponse clientResponse =  tro.response();
<span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Length: %d%n</span><span class="delimiter">&quot;</span></span>, clientResponse.getLength());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Perhaps the most interesting piece of the response proxy facility is the treatment of methods  annotated with <code>@LinkHeaderParam</code>.
Its simplest use is to assist in  accessing a <code>jakarta.ws.rs.core.Link</code> returned by a resource method.
For example, let&#8217;s add</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/link-header</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> Response getWithHeader(<span class="annotation">@Context</span> UriInfo uri) {
   <span class="predefined-type">URI</span> subUri = uri.getAbsolutePathBuilder().path(<span class="string"><span class="delimiter">&quot;</span><span class="content">next-link</span><span class="delimiter">&quot;</span></span>).build();
   Link link = <span class="keyword">new</span> LinkBuilderImpl().uri(subUri).rel(<span class="string"><span class="delimiter">&quot;</span><span class="content">nextLink</span><span class="delimiter">&quot;</span></span>).build();
   <span class="keyword">return</span> Response.noContent().header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Link</span><span class="delimiter">&quot;</span></span>, link.toString()).build();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>to <code>TestResource</code>, add</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">link-header</span><span class="delimiter">&quot;</span></span>)
ResponseObjectInterface performGetBasedOnHeader();</code></pre>
</div>
</div>
<div class="paragraph">
<p>to <code>ClientInterface</code>, and add</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@LinkHeaderParam</span>(rel = <span class="string"><span class="delimiter">&quot;</span><span class="content">nextLink</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">URI</span> nextLink();</code></pre>
</div>
</div>
<div class="paragraph">
<p>to <code>ResponseObjectInterface</code>.
Then calling</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResponseObjectInterface obj = ClientInterface.performGetBasedOnHeader();
<span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">nextLink(): %s%n</span><span class="delimiter">&quot;</span></span>, obj.nextLink());</code></pre>
</div>
</div>
<div class="paragraph">
<p>will access the <code>LinkHeader</code> returned by <code>TestResource.getWithHeader()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>nextlink: http://localhost:8081/test/link-header/next-link</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last but not least, let&#8217;s add</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/link-header/next-link</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> getHeaderForward() {
   <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">forwarded</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>to <code>TestResource</code> and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GET</span>
<span class="annotation">@LinkHeaderParam</span>(rel = <span class="string"><span class="delimiter">&quot;</span><span class="content">nextLink</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">String</span> followNextLink();</code></pre>
</div>
</div>
<div class="paragraph">
<p>to <code>ResponseObjectInterface</code>.
Note that, unlike <code>ResponseObjectInterface.nextLink()</code>, <code>followNextLink()</code> is annotated with <code>@GET</code>; that is, it qualifies as (the client proxy to) a resource method.
When executing <code>followNextLink()</code>, RESTEasy will retrieve the value of the <code>Link</code> returned by <code>TestResource.getWithHeader()</code> and then will make a GET invocation on the <code>URL</code> in that <code>Link</code>.
Calling</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">followNextLink(): %s%n</span><span class="delimiter">&quot;</span></span>, obj.followNextLink());</code></pre>
</div>
</div>
<div class="paragraph">
<p>causes RESTEasy to retrieve the <code>URL</code> <a href="http://localhost:8081/test/link-header/next-link" class="bare">http://localhost:8081/test/link-header/next-link</a> from the call to <code>TestResource.getWithHeader()</code> and then perform a GET on it, invoking <code>TestResource.getHeaderForward()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>followNextLink(): forwarded</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This facility for extracting a <code>URL</code> and following it is a step toward supporting the Representation State Transfer principle of HATEOAS.
For more information, see <a href="http://shop.oreilly.com/product/0636920028925.do">RESTful Java with JAX-RS 2.0, 2nd Edition</a> by Bill Burke.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_clienturi"><a class="anchor" href="#_clienturi"></a>54.2.3. Giving client proxy an ad hoc URI</h4>
<div class="paragraph">
<p>Client proxies figure out appropriate URIs for targeting resource methods by looking at <code>@Path</code>  annotations in the client side interface, but it is also possible to pass URIs explicitly to the proxy through the use of the <code>org.jboss.resteasy.annotations.ClientURI</code> annotation.
For example, let <code>TestResource</code> be a client side interface and <code>TestResourceImpl</code> a server resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TestResource</span> {

  <span class="annotation">@GET</span>
  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">dispatch</span><span class="delimiter">&quot;</span></span>)
  <span class="predefined-type">String</span> dispatch(<span class="annotation">@ClientURI</span> <span class="predefined-type">String</span> uri);
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResourceImpl</span> {

  <span class="annotation">@GET</span>
  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>)
  <span class="directive">public</span> <span class="predefined-type">String</span> a() {
     <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>;
  }

  <span class="annotation">@GET</span>
  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>)
  <span class="directive">public</span> <span class="predefined-type">String</span> b() {
     <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calling <code>TestResource.dispatch()</code> allows specifying a specific URI for accessing a resource method.
In the following, let BASE_URL be the address of the <code>TestResourceImpl</code> resource.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> BASE_URL = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/</span><span class="delimiter">&quot;</span></span>;

 <span class="directive">public</span> <span class="type">void</span> test() <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="keyword">try</span> (ResteasyClient client = (ResteasyClient)ClientBuilder.newClient()) {
        TestResource proxy = client.target(BASE_URL).proxy(TestResource.class);
        <span class="predefined-type">String</span> name = proxy.dispatch(BASE_URL + <span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">name: %s%n</span><span class="delimiter">&quot;</span></span>, name);
        name = proxy.dispatch(BASE_URL + <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">name: %s%n</span><span class="delimiter">&quot;</span></span>, name);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then passing "http://localhost:8081/a" and "http://localhost/b" to <code>dispatch()</code> invokes <code>TestResourceImp.a()</code> and <code>TestResourceImpl.b()</code> respectively, yielding the output</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>name: a
name: b</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sharing_interfaces"><a class="anchor" href="#_sharing_interfaces"></a>54.2.4. Sharing an interface between client and server</h4>
<div class="paragraph">
<p>It is generally possible to share an interface between the client and server.
In this scenario, just have the Jakarta RESTful Web Services services implement an annotated interface and then reuse that same interface to create client proxies to invoke on the client-side.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transport_layer"><a class="anchor" href="#_transport_layer"></a>54.3. Apache HTTP Client 4.x and other backends</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Apache HTTP Client support is deprecated in RESTEasy. The exposed API&#8217;s will eventually be removed. However, it&#8217;s
still the default client implementation as we prepare for a replacement backing HTTP client.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Network communication between the client and server is handled by default in RESTEasy.
The interface between the RESTEasy Client Framework and the network is defined by RESTEasy&#8217;s <code>ClientHttpEngine</code> interface.
RESTEasy ships with multiple implementations of this interface.</p>
</div>
<div class="paragraph">
<p>The default implementation is <code>ApacheHttpClient43Engine</code>, which uses version 4.3 of the <code>HttpClient</code> from the Apache <code>HttpComponents</code> project.</p>
</div>
<div class="paragraph">
<p><code>ApacheHttpAsyncClient4Engine</code>, instead, is built on top of <em>HttpAsyncClient</em> (still from the Apache <em>HttpComponents</em> project) with internally dispatches requests using a non-blocking IO model.</p>
</div>
<div class="paragraph">
<p><code>JettyClientEngine</code> is built on top of <em>Eclipse Jetty</em> HTTP engine, which is possibly an interesting option for those already running on the Jetty server.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This project has moved to a new repository <a href="https://github.com/resteasy/resteasy-jetty" class="bare">https://github.com/resteasy/resteasy-jetty</a>. The dependency GAV and
           package names have changed, but it should still operate the same.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>VertxClientHttpEngine</code> is built on top of <em>Eclipse Vert.x</em>, which provides a non-blocking HTTP client based on Vert.x framework.</p>
</div>
<div class="paragraph">
<p><code>ReactorNettyClientHttpEngine</code> is built on top of <em>Reactor Netty</em>, which provides a non-blocking HTTP client based on Netty framework.</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">RESTEasy ClientHttpEngine implementations</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ApacheHttpClient43Engine (deprecated)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses HttpComponents HttpClient 4.3+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ApacheHttpAsyncClient4Engine (deprecated)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses HttpComponents HttpAsyncClient</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JettyClientEngine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses Eclipse Jetty</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ReactorNettyClientHttpEngine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses Reactor Netty</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VertxClientHttpEngine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses Eclipse Vert.x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">URLConnectionEngine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses java.net.HttpURLConnection</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The RESTEasy Client Framework can also be customized.
The user can provide their own implementations of <code>ClientHttpEngine</code> to the <code>ResteasyClient</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ClientHttpEngine myEngine = <span class="keyword">new</span> ClientHttpEngine() {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> ClientResponse invoke(ClientInvocation request) {
        <span class="comment">// implement your processing code and return a</span>
        <span class="comment">// org.jboss.resteasy.client.jaxrs.internal.ClientResponse</span>
        <span class="comment">// object.</span>
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">SSLContext</span> getSslContext() {
       <span class="keyword">return</span> sslContext;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">HostnameVerifier</span> getHostnameVerifier() {
       <span class="keyword">return</span> hostnameVerifier;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> close() {
       <span class="comment">// do nothing</span>
    }
};

Client client = ClientBuilder.newBuilder().register(myEngine).build();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you include a <code>META-INF/services/org.jboss.resteasy.client.jaxrs.engine.ClientHttpEngineFactory</code> and an implementation
      of the interface, you do not need to register your engine in the <code>ClientBuilder</code>. You can simply do
      <code>Client client = ClientBuilder.newClient()</code> and your backing engine will be used.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can also add a <code>jakarta.annotations.Priority</code> annotation on your <code>org.jboss.resteasy.client.jaxrs.engine.ClientHttpEngineFactory</code> implementation to rank the priorities.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>RESTEasy and <code>HttpClient</code> make reasonable default decisions so that it is possible to use the client framework without ever referencing <code>HttpClient</code>.
For some applications it may be necessary to drill down into the <code>HttpClient</code> details. <code>ApacheHttpClient43Engine</code> can be supplied with an instance of <code>org.apache.http.client.HttpClient</code> and an instance of <code>org.apache.http.protocol.HttpContext</code>, which can carry additional configuration details into the <code>HttpClient</code> layer.</p>
</div>
<div class="paragraph">
<p><code>HttpContextProvider</code> is a RESTEasy provided interface through which a custom <code>HttpContext</code> is supplied to <code>ApacheHttpClient43Engine</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.jboss.resteasy.client.jaxrs.engines</span>;

<span class="keyword">import</span> <span class="include">org.apache.http.protocol.HttpContext</span>;

<span class="directive">public</span> <span class="type">interface</span> <span class="class">HttpContextProvider</span> {
   HttpContext getContext();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is an example of providing a custom HttpContext</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DefaultHttpClient httpClient = <span class="keyword">new</span> DefaultHttpClient();
ApacheHttpClient43Engine engine = <span class="keyword">new</span> ApacheHttpClient43Engine(httpClient,
   <span class="keyword">new</span> HttpContextProvider() {
           <span class="annotation">@Override</span>
           <span class="directive">public</span> HttpContext getContext() {
              <span class="comment">// Configure HttpClient to authenticate preemptively</span>
              <span class="comment">// by prepopulating the authentication data cache.</span>
              <span class="comment">// 1. Create AuthCache instance</span>
              AuthCache authCache = <span class="keyword">new</span> BasicAuthCache();
              <span class="comment">// 2. Generate BASIC scheme object and add it to the local auth cache</span>
              BasicScheme basicAuth = <span class="keyword">new</span> BasicScheme();
              authCache.put(getHttpHost(url), basicAuth);
              <span class="comment">// 3. Add AuthCache to the execution context</span>
              BasicHttpContext localContext = <span class="keyword">new</span> BasicHttpContext();
              localContext.setAttribute(ClientContext.AUTH_CACHE, authCache);
              <span class="keyword">return</span> localContext;
           }
});</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_http_redirect"><a class="anchor" href="#_http_redirect"></a>54.3.1. HTTP redirect</h4>
<div class="paragraph">
<p>The <code>ClientHttpEngine</code> implementations based on Apache <code>HttpClient</code> support HTTP redirection.
The feature is disabled by default and has to be enabled by users explicitly.
Either by setting up the following property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dev.resteasy.client.follow.redirects</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newBuilder().property(<span class="string"><span class="delimiter">&quot;</span><span class="content">dev.resteasy.client.follow.redirects</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>).build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>or by explicitly calling the API method as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApacheHttpClient43Engine engine = <span class="keyword">new</span> ApacheHttpClient43Engine();
engine.setFollowRedirects(<span class="predefined-constant">true</span>);
Client client = ((ResteasyClientBuilder)ClientBuilder.newBuilder()).httpEngine(engine).build();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_https"><a class="anchor" href="#_https"></a>54.3.2. Configuring SSL</h4>
<div class="paragraph">
<p>To enable SSL on client, a <code>ClientHttpEngine</code> containing a SSLContext can be created to build client as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> Client createClient() {
  ClientHttpEngine myEngine = <span class="keyword">new</span> ClientHttpEngine() {
     <span class="directive">public</span> <span class="type">void</span> setSslContext(<span class="predefined-type">SSLContext</span> sslContext) {
        <span class="local-variable">this</span>.sslContext = sslContext;
     }

     <span class="annotation">@Override</span>
     <span class="directive">public</span> <span class="predefined-type">HostnameVerifier</span> getHostnameVerifier() {
        <span class="keyword">return</span> hostnameVerifier;
     }
  };
  myEngine.setSslContext(mySslContext);
  <span class="keyword">return</span> ((ResteasyClientBuilder)ClientBuilder.newBuilder()).httpEngine(myEngine).build();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An alternative is to set up a keystore and truststore and pass a custom SslContext to ClientBuilder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client sslClient = ClientBuilder.newBuilder().sslContext(mySslContext).build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you don&#8217;t want to create a SSLContext, you can build client with a keystore and truststore.
Note if both SSLContext and keystore/truststore are configured, the later will be ignored by Resteasy ClientBuilder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client sslClient = ClientBuilder.newBuilder().keystore(keystore,mypassword).
                      trustKeystore(trustStore).build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>During handshaking, a custom HostNameVerifier can be called to allow the connection if URL&#8217;s hostname and the server&#8217;s identification hostname match.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client sslClient =  ((ResteasyClientBuilder)ClientBuilder.newBuilder()).sslContext(mysslContext)
                       .hostnameVerifier(myhostnameVerifier).build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resteasy provides another simple way to set up a <code>HostnameVerifier</code>.
It allows configuring <code>ResteasyClientBuilder</code> with a <code>HostnameVerificationPolicy</code> without creating a custom <code>HostNameVerifier</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client sslClient =  ((ResteasyClientBuilder)ClientBuilder.newBuilder()).sslContext(mysslContext)
                       .hostnameVerification(ResteasyClientBuilder.HostnameVerificationPolicy.ANY).build();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting <code>HostnameVerificationPolicy.ANY</code> will allow all connections without a check.</p>
</li>
<li>
<p><code>HostnameVerificationPolicy.WILDCARD</code> only allows wildcards in subdomain names i.e. *.foo.com.</p>
</li>
<li>
<p><code>HostnameVerificationPolicy.STRICT</code> checks if DNS names match the content of the Public Suffix List
(<a href="https://publicsuffix.org/list/public_suffix_list.dat" class="bare">https://publicsuffix.org/list/public_suffix_list.dat</a>). Please note if this public suffix list isn&#8217;t the check
wanted, create your own <code>HostNameVerifier</code> instead of this policy setting.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_http_proxy"><a class="anchor" href="#_http_proxy"></a>54.3.3. HTTP proxy</h4>
<div class="paragraph">
<p>The <code>ClientHttpEngine</code> implementations based on Apache <code>HttpClient</code> support HTTP proxy.
This feature can be enabled by setting specific properties on the builder:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.jboss.resteasy.jaxrs.client.proxy.host</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.jaxrs.client.proxy.port</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.jaxrs.client.proxy.scheme</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newBuilder().property(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.jaxrs.client.proxy.host</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">someproxy.com</span><span class="delimiter">&quot;</span></span>).property(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.jaxrs.client.proxy.port</span><span class="delimiter">&quot;</span></span>, <span class="integer">8080</span>).build();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_apache_4_3"><a class="anchor" href="#_apache_4_3"></a>54.3.4. Apache HTTP Client 4.3 APIs</h4>
<div class="paragraph">
<p>The RESTEasy Client framework automatically creates and properly configures the underlying Apache HTTP Client engine.
When the <code>ApacheHttpClient43Engine</code> is manually created, though, the user can either let it build and use a default <code>HttpClient</code> instance or provide a custom one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> ApacheHttpClient43Engine() {
}

<span class="directive">public</span> ApacheHttpClient43Engine(HttpClient httpClient) {
}

<span class="directive">public</span> ApacheHttpClient43Engine(HttpClient httpClient, <span class="type">boolean</span> closeHttpClient) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>closeHttpClient</em> parameter on the last constructor above allows controlling whether the Apache <code>HttpClient</code> is to be closed upon engine finalization.
The default value is <em>true</em>.
When a custom <code>HttpClient</code> instance is not provided, the default instance will always be closed together with the engine.</p>
</div>
<div class="paragraph">
<p>For more information about HttpClient (4.x), see the documentation at <a href="https://hc.apache.org/index.html">
         https://hc.apache.org/index.html/</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is important to understand the difference between "releasing" a connection and "closing" a connection.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Releasing a connection makes it available for reuse.</p>
</li>
<li>
<p>Closing a connection frees its resources and makes it unusable.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If an execution of a request or a call on a proxy returns a class other than <code>Response</code>, then RESTEasy will take care of releasing the connection.
For example, in the fragments</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">WebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/customer/123</span><span class="delimiter">&quot;</span></span>);
<span class="predefined-type">String</span> answer = target.request().get(<span class="predefined-type">String</span>.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResteasyWebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/customer/123</span><span class="delimiter">&quot;</span></span>);
RegistryStats stats = target.proxy(RegistryStats.class);
RegistryData data = stats.get();</code></pre>
</div>
</div>
<div class="paragraph">
<p>RESTEasy will release the connection under the covers.
The only counterexample is the case in which the response is an instance of <code>InputStream</code>, which must be closed explicitly.</p>
</div>
<div class="paragraph">
<p>On the other hand, if the result of an invocation is an instance of <code>Response</code>, then the Response.close() method must be used to release the connection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">WebTarget target = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/customer/123</span><span class="delimiter">&quot;</span></span>);
Response response = target.request().get();
<span class="predefined-type">System</span>.out.println(response.getStatus());
response.close();</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is advisable to execute this in a try-with-resources block.
Again, releasing a connection only makes it available for another use. <strong>It does not normally close the socket.</strong></p>
</div>
<div class="paragraph">
<p>On the other hand, <code>ApacheHttpClient43Engine.finalize()</code> will close any open sockets, unless the user set <em>closeHttpClient</em> as <em>false</em> when building the engine, in which case he is responsible for closing the connections.</p>
</div>
<div class="paragraph">
<p>Note that if <code>ApacheHttpClient43Engine</code> has created its own instance of <code>HttpClient</code>, it is not necessary to wait for <code>finalize()</code> to close open sockets.
The <code>ClientHttpEngine</code> interface has a <code>close()</code> method for this purpose.</p>
</div>
<div class="paragraph">
<p>If the user&#8217;s <code>jakarta.ws.rs.client.Client</code> class has created the engine automatically, the user should call <code>Client.close()</code> and this will clean up any socket connections.</p>
</div>
<div class="paragraph">
<p>Finally, having explicit <code>finalize()</code> methods can badly affect performances, the <code>org.jboss.resteasy.client.jaxrs.engines.ManualClosingApacheHttpClient43Engine</code> flavour of <code>org.jboss.resteasy.client.jaxrs.engines.ApacheHttpClient43Engine</code> can be used.
With that the user is always responsible for calling <code>close()</code> as no <code>finalize()</code> is there to do that before object garbage collection.</p>
</div>
</div>
<div class="sect3">
<h4 id="_apache_asynch"><a class="anchor" href="#_apache_asynch"></a>54.3.5. Asynchronous HTTP Request Processing</h4>
<div class="paragraph">
<p>RESTEasy&#8217;s default async engine implementation class is <code>ApacheHttpAsyncClient4Engine</code>.
It can be set as the active engine by calling method <code>useAsyncHttpEngine</code> in <code>ResteasyClientBuilder</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> doTest() {
    Client asyncClient = ((ResteasyClientBuilder)ClientBuilder.newBuilder()).useAsyncHttpEngine()
                             .build();
    FutureResponse future = asyncClient
                             .target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://locahost:8080/test</span><span class="delimiter">&quot;</span></span>).request()
                             .async().get();
    Response res = future.get();
    Assertions.assertEquals(HttpResponseCodes.SC_OK, res.getStatus());
    <span class="predefined-type">String</span> entity = res.readEntity(<span class="predefined-type">String</span>.class);
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_invocationcallbacks"><a class="anchor" href="#_invocationcallbacks"></a>InvocationCallbacks</h5>
<div class="paragraph">
<p>InvocationCallbacks are called from within the io-threads and thus must not block or else the application may slow down to a halt.
Reading the response is safe because the response is buffered in memory, as are other async and in-memory client-invocations that submit-calls returning a future not containing Response, InputStream or Reader.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> doTest() {
   <span class="directive">final</span> <span class="predefined-type">CountDownLatch</span> latch = <span class="keyword">new</span> <span class="predefined-type">CountDownLatch</span>(<span class="integer">1</span>);
   FutureString future = nioClient.target(generateURL(<span class="string"><span class="delimiter">&quot;</span><span class="content">/test</span><span class="delimiter">&quot;</span></span>)).request()
         .async().get(<span class="keyword">new</span> InvocationCallbackString()
                {
                   <span class="annotation">@Override</span>
                   <span class="directive">public</span> <span class="type">void</span> completed(<span class="predefined-type">String</span> s)
                   {
                      Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">get</span><span class="delimiter">&quot;</span></span>, s);
                      latch.countDown();
                      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">for the test of it</span><span class="delimiter">&quot;</span></span>);
                   }

                   <span class="annotation">@Override</span>
                   <span class="directive">public</span> <span class="type">void</span> failed(<span class="predefined-type">Throwable</span> error)
                   {
                   }
                });
   <span class="predefined-type">String</span> entity = future.get();
   Assertions.assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">get</span><span class="delimiter">&quot;</span></span>, entity);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>InvocationCallbacks may be called seemingly "after" the future-object returns.
Thus, responses should be handled solely in the InvocationCallback.</p>
</div>
<div class="paragraph">
<p>InvocationCallbacks will see the same result as the future-object and vice versa.
Thus, if the invocationcallback throws an exception, the future-object will not see it.
This is the reason to handle responses only in the InvocationCallback.</p>
</div>
</div>
<div class="sect4">
<h5 id="_async_engine_usage_considerations"><a class="anchor" href="#_async_engine_usage_considerations"></a>Async Engine Usage Considerations</h5>
<div class="paragraph">
<p>Asynchronous IO means non-blocking IO utilizing few threads, typically at most as many threads as number of cores.
As such, performance may profit from fewer thread switches and less memory usage due to fewer thread-stacks.
But doing synchronous, blocking IO (the invoke-methods not returning a future) may suffer, because the data has to be transferred piecewise to/from the io-threads.</p>
</div>
<div class="paragraph">
<p>Request-Entities are fully buffered in memory, thus <code>HttpAsyncClient</code> is unsuitable for very large uploads.
Response-Entities are buffered in memory, except if requesting a Response, InputStream or Reader as Result.
For large downloads or COMET, one of these three return types must be requested, but there may be a performance penalty because the response-body is transferred piecewise from the io-threads.
When using InvocationCallbacks, the response is always fully buffered in memory.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jetty_client"><a class="anchor" href="#_jetty_client"></a>54.3.6. Jetty Client Engine</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This project has moved to a new repository <a href="https://github.com/resteasy/resteasy-jetty" class="bare">https://github.com/resteasy/resteasy-jetty</a>. The dependency GAV and
package names have changed, but it should still operate the same.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a drop in replacement, RESTEasy allows selecting a Jetty 11 based HTTP engine.
The Jetty implementation is newer and less tested, but it may end up being a good choice when relying on Jetty as server side already.
The Jetty Server can even share execution resources with Client libraries if configured to use e.g.
the same QueuedThreadPool.</p>
</div>
<div class="paragraph">
<p>The Jetty engine is enabled by adding a dependency to the <code>dev.resteasy.jetty:resteasy-client-jetty</code> artifact to your runtime environment.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vertx_client"><a class="anchor" href="#_vertx_client"></a>54.3.7. Vertx Client Engine</h4>
<div class="paragraph">
<p>Still as a drop in replacement, RESTEasy allows selecting a Vert.x-based HTTP engine.
The Vert.x implementation can perform asynchronous client invocations.
It provides the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTTP/1.1</p>
</li>
<li>
<p>HTTP/2</p>
</li>
<li>
<p>SSL/TLS (including native SSL engine)</p>
</li>
<li>
<p>Efficient client connection pooling</p>
</li>
<li>
<p>Optional native IO on Linux and BSD for greater performance</p>
</li>
<li>
<p>Domain sockets</p>
</li>
<li>
<p>HTTP Metrics with Dropwizard or Micrometer</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Vert.x engine is enabled by adding a dependency to the <code>org.jboss.resteasy:resteasy-client-vertx</code> artifact to your runtime environment.</p>
</div>
<div class="paragraph">
<p>A Vert.x instance can also be provided when creating the client engine, as well as options configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> HttpEngine createVertxEngine() {
  HttpClientOptions options = <span class="keyword">new</span> HttpClientOptions()
   .setSsl(<span class="predefined-constant">true</span>)
   .setTrustStoreOptions(<span class="keyword">new</span> JksOptions()
     .setPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">/path/to/your/truststore.jks</span><span class="delimiter">&quot;</span></span>)
     .setPassword(<span class="string"><span class="delimiter">&quot;</span><span class="content">password-of-your-truststore</span><span class="delimiter">&quot;</span></span>)
  );
  <span class="keyword">return</span> <span class="keyword">new</span> VertxClientHttpEngine(vertx, options);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can read more about HttpClient configuration <a href="https://vertx.io/docs/vertx-core/java/#_making_requests">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reactor_netty_client"><a class="anchor" href="#_reactor_netty_client"></a>54.3.8. Reactor Netty Client Engine</h4>
<div class="paragraph">
<p>Still as a drop in replacement, RESTEasy allows selecting a Reactor Netty based HTTP engine.
The Reactor Netty implementation is newer and less tested, but can be a good choice if the user application is already depending on Netty and performs asynchronous client invocations.</p>
</div>
<div class="paragraph">
<p>The Reactor Netty engine is enabled by adding a dependency to the <code>org.jboss.resteasy:resteasy-client-reactor-netty</code> artifact to the Maven project; then the client can be built as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ReactorNettyClientHttpEngine engine = <span class="keyword">new</span> ReactorNettyClientHttpEngine(
   HttpClient.create(),
   <span class="keyword">new</span> DefaultChannelGroup(<span class="keyword">new</span> DefaultEventExecutor()),
   HttpResources.get());
ResteasyClient client = ((ResteasyClientBuilder)ClientBuilder.newBuilder())
   .clientEngine(engine).build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>When coupled with the MonoRxInvoker, this has several benefits.
It supports things like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>webTarget.path(&quot;/foo&quot;).get().rx(MonoRxInvoker.class).map(...).subscribe()</code></pre>
</div>
</div>
<div class="paragraph">
<p>in order to achieve non-blocking HTTP client calls.
This allows leveraging some reactor features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the ability for a <code>Mono#timeout</code> set on the response to aggressively terminate the HTTP request;</p>
</li>
<li>
<p>the ability to pass a (reactor) context from client calls into <code>ReactorNettyClientHttpEngine</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For some sample code, see <code>org.jboss.resteasy.reactor.ReactorTest</code> in the RESTEasy module resteasy-reactor.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_client_utilities"><a class="anchor" href="#_client_utilities"></a>54.4. Client Utilities</h3>
<div class="paragraph">
<p>The client utilities contain various client side helpers that can be registered on a client.
These utilities do not require RESTEasy and can be used with any Jakarta RESTful Web Services implementation.</p>
</div>
<div class="sect3">
<h4 id="_client_utilities_auth"><a class="anchor" href="#_client_utilities_auth"></a>54.4.1. Client Authentication</h4>
<div class="paragraph">
<p>The client authentication utilities can be used on a client when an endpoint requires authentication.
Currently, BASIC and DIGEST authentication are supported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> Response invoke() {
  <span class="keyword">try</span> (
          Client client = ClientBuilder.newBuilder()
                  .register(HttpAuthenticators.basic(UserCredentials.clear(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> <span class="type">char</span><span class="type">[]</span> {<span class="string"><span class="delimiter">'</span><span class="content">p</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">s</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">s</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">o</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">r</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">d</span><span class="delimiter">'</span></span>})))
                  .build()
      ) {
      <span class="keyword">return</span> client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://example.com/api/info</span><span class="delimiter">&quot;</span></span>)
              .request(MediaType.APPLICATION_JSON_TYPE)
              .get();
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">final</span> Response response = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://example.com/api/info</span><span class="delimiter">&quot;</span></span>)
        .register(HttpAuthenticators.digest(UserCredentials.clear(<span class="string"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> <span class="type">char</span><span class="type">[]</span> {<span class="string"><span class="delimiter">'</span><span class="content">p</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">s</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">s</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">o</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">r</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">d</span><span class="delimiter">'</span></span>})))
        .request(MediaType.APPLICATION_JSON_TYPE)
        .get();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_microprofile_rest_client"><a class="anchor" href="#_microprofile_rest_client"></a>55. MicroProfile Rest Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As the microservices style of system architecture (see, for example, <a href="https://martinfowler.com/articles/microservices.html">Microservices</a> by Martin Fowler) gains increasing traction, new API standards are coming along to support it.
One set of such standards comes from the <a href="https://microprofile.io/">Microprofile Project</a> supported by the Eclipse
Foundation, and among Jakarta RESTful Web Services those is one, <a href="https://microprofile.io/project/eclipse/microprofile-rest-client">MicroProfile Rest Client</a>,
of particular interest to RESTEasy and . In fact, it is intended to be based on, and consistent with, Jakarta RESTful Web Services, and
it includes ideas already implemented in RESTEasy. For a more detailed description of MicroProfile Rest Client,
see <a href="https://github.com/eclipse/microprofile-rest-client" class="bare">https://github.com/eclipse/microprofile-rest-client</a>. In particular, the API code is in
<a href="https://github.com/eclipse/microprofile-rest-client/tree/master/api" class="bare">https://github.com/eclipse/microprofile-rest-client/tree/master/api</a>. and the specification is in <a href="https://github.com/eclipse/microprofile-rest-client/tree/master/spec" class="bare">https://github.com/eclipse/microprofile-rest-client/tree/master/spec</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
As of RESTEasy 5.0.0 the MicroProfile integration has moved to a new project, group id, artifact id and version.
The new group id is <code>org.jboss.resteasy.microprofile</code>.The artifact id for the client is now <code>microprofile-client</code>.
To use the MicroProfile Config sources the artifact id is <code>microprofile-config</code>.
Finally, for context propagation the new artifact is is <code>microprofile-context-propagation</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You could also use the RESTEasy MicroProfile BOM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy.microprofile<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-microprofile-bom<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${version.org.jboss.resteasy.microprofile}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_client_proxies_2"><a class="anchor" href="#_client_proxies_2"></a>55.1. Client proxies</h3>
<div class="paragraph">
<p>One of the central ideas in MicroProfile Rest Client is a version of <em>distributed object communication</em>, a concept
implemented in, among other places, <a href="http://www.corba.org/orb_basics.htm">CORBA</a>, Java RMI, the JBoss Remoting project,
and RESTEasy. Consider the resource</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">resource</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TestResource</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@GET</span>
   <span class="predefined-type">String</span> test() {
      <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Jakarta RESTful Web Services native way of accessing <code>TestResource</code> looks like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">String</span> checkResponse() {
    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        <span class="keyword">return</span> client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/test</span><span class="delimiter">&quot;</span></span>).request().get(<span class="predefined-type">String</span>.class);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The call to <code>TestResource.test()</code> is not particularly onerous, but calling <code>test()</code> directly allows a more natural syntax.
That is exactly what Microprofile Rest Client supports:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">resource</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TestResourceClient</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@GET</span>
   <span class="predefined-type">String</span> test();
}

TestResourceClient service = RestClientBuilder.newBuilder()
                              .baseUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/</span><span class="delimiter">&quot;</span></span>)
                              .build(TestResourceClient.class);
<span class="predefined-type">String</span> s = service.test();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first four lines of executable code are spent creating a proxy, <code>service</code>, that implements <code>TestResourceIntf</code>, but once that is done, calls on <code>TestResource</code> can be made very naturally in terms of <code>TestResourceIntf</code>, as illustrated by the call <code>service.test()</code>.</p>
</div>
<div class="paragraph">
<p>Beyond the natural syntax, another advantage of proxies is the way the proxy construction process quietly gathers useful information from the implemented interface and makes it available for remote invocations.
Consider a more elaborate version of <code>TestResourceIntf</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">resource</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TestResourceClient</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test/{path}</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@POST</span>
   <span class="predefined-type">String</span> test(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> path, <span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> query, <span class="predefined-type">String</span> entity);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calling <code>service.test("p", "q", "e")</code> results in an HTTP message that looks like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>POST /resource/test/p/?query=q HTTP/1.1
Accept: text/html
Content-Type: text/plain
Content-Length: 1

e</code></pre>
</div>
</div>
<div class="paragraph">
<p>The HTTP verb is derived from the <code>@POST</code> annotation, the request URI is derived from the two instances of the <code>@Path</code>
annotation (one on the class, one on the method) plus the first and second parameters of <code>test()</code>, the Accept header
is derived from the <code>@Produces</code> annotation, and the Content-Type header is derived from the <code>@Consumes</code> annotation,</p>
</div>
<div class="paragraph">
<p>Using the Jakarta RESTful Web Services API, <code>service.test("p", "q", "e")</code> would look like the more verbose</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">String</span> checkResponse() {
    <span class="keyword">try</span> (Client client = ClientBuilder.newClient()) {
        <span class="keyword">return</span> client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/resource/test/p</span><span class="delimiter">&quot;</span></span>)
                             .queryParam(<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">q</span><span class="delimiter">&quot;</span></span>)
                             .request()
                             .accept(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>)
                             .post(<span class="predefined-type">Entity</span>.entity(<span class="string"><span class="delimiter">&quot;</span><span class="content">e</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>), <span class="predefined-type">String</span>.class);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>One other basic facility offered by MicroProfile Rest Client is the ability to configure the client environment by registering providers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TestResourceClient service = RestClientBuilder.newBuilder()
                              .baseUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/</span><span class="delimiter">&quot;</span></span>)
                              .register(MyClientResponseFilter.class)
                              .register(MyMessageBodyReader.class)
                              .build(TestResourceClient.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Naturally, the registered providers should be relevant to the client environment, rather than, say, a <code>ContainerResponseFilter</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>So far, the MicroProfile Rest Client should look familiar to anyone who has used the RESTEasy client proxy facility
(<a href="#_client_proxies">Section "RESTEasy Proxy Framework"</a>). The construction in  the previous listing would look like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ResteasyClient client = (ResteasyClient) ResteasyClientBuilder.newClient();
TestResourceClient service = client.target(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/</span><span class="delimiter">&quot;</span></span>)
                              .register(MyClientResponseFilter.class)
                              .register(MyMessageBodyReader.class)
                              .proxy(TestResourceClient.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>in RESTEasy.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_concepts_imported_from_jakarta_restful_web_services"><a class="anchor" href="#_concepts_imported_from_jakarta_restful_web_services"></a>55.2. Concepts imported from Jakarta RESTful Web Services</h3>
<div class="paragraph">
<p>Beyond the central concept of the client proxy, some basic concepts in MicroProfile Client originate in Jakarta RESTful Web Services.
Some of these have already been introduced in the previous section, since the interface implemented by a client proxy
represents the facilities provided by a Jakarta RESTful Web Services server. For example, the HTTP verb annotations and the <code>@Consumes</code>
and <code>@Produces</code> annotations originate on the Jakarta RESTful Web Services server side. Injectable parameters annotated with
<code>@PathParameter</code>, <code>@QueryParameter</code>, etc., also come from Jakarta RESTful Web Services.</p>
</div>
<div class="paragraph">
<p>Nearly all of the provider concepts supported by MicroProfile Client also originate in Jakarta RESTful Web Services. These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jakarta.ws.rs.client.ClientRequestFilter</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.client.ClientResponseFilter</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.ext.MessageBodyReader</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.ext.MessageBodyWriter</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.ext.ParamConverter</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.ext.ReaderInterceptor</code></p>
</li>
<li>
<p><code>jakarta.ws.rs.ext.WriterInterceptor</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Like Jakarta RESTful Web Services, MicroProfile Client also has the concept of mandated providers.
These are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JSON-P <code>MessageBodyReader</code> and <code>MessageBodyWriter</code> must be provided.</p>
</li>
<li>
<p>JSON-B <code>MessageBodyReader</code> and <code>MessageBodyWriter</code> must be provided if the implementation supports JSON-B.</p>
</li>
<li>
<p><code>MessageBodyReader</code> and <code>MessageBodyWriter</code>  must be provided for the following types:</p>
<div class="ulist">
<ul>
<li>
<p><code>byte[]</code></p>
</li>
<li>
<p><code>String</code></p>
</li>
<li>
<p><code>InputStream</code></p>
</li>
<li>
<p><code>Reader</code></p>
</li>
<li>
<p><code>File</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_beyond_jakarta_restful_web_services_and_resteasy"><a class="anchor" href="#_beyond_jakarta_restful_web_services_and_resteasy"></a>55.3. Beyond Jakarta RESTful Web Services and RESTEasy</h3>
<div class="paragraph">
<p>Some concepts in MicroProfile Rest Client do not appear in either Jakarta RESTful Web Services or RESTEasy.</p>
</div>
<div class="sect3">
<h4 id="_default_media_type"><a class="anchor" href="#_default_media_type"></a>55.3.1. Default media type</h4>
<div class="paragraph">
<p>Whenever no media type is specified by, for example, <code>@Consumes</code> or <code>@Produces</code> annotations, the media type of a request
entity or response entity is "application/json". This is different than Jakarta RESTful Web Services, where the media type defaults to
"application/octet-stream".</p>
</div>
</div>
<div class="sect3">
<h4 id="_declarative_registration_of_providers"><a class="anchor" href="#_declarative_registration_of_providers"></a>55.3.2. Declarative registration of providers</h4>
<div class="paragraph">
<p>In addition to programmatic registration of providers as illustrated above, it is also possible to register providers declaratively with annotations introduced in MicroProfile Rest Client.
In particular, providers can be registered by adding the <code>org.eclipse.microprofile.rest.client.annotation.RegisterProvider</code> annotation to the target interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">resource</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RegisterProvider</span>(MyClientResponseFilter.class)
<span class="annotation">@RegisterProvider</span>(MyMessageBodyReader.class)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TestResourceClient</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test/{path}</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@POST</span>
   <span class="predefined-type">String</span> test(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> path, <span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> query, <span class="predefined-type">String</span> entity);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Declaring <code>MyClientResponseFilter</code> and <code>MyMessageBodyReader</code> with annotations eliminates the need to call <code>RestClientBuilder.register()</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_global_registration_of_providers"><a class="anchor" href="#_global_registration_of_providers"></a>55.3.3. Global registration of providers</h4>
<div class="paragraph">
<p>One more way to register providers is by implementing one or both of the listeners in package <code>org.eclipse.microprofile.rest.client.spi</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">RestClientBuilderListener</span> {

    <span class="type">void</span> onNewBuilder(RestClientBuilder builder);
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">RestClientListener</span> {

    <span class="type">void</span> onNewClient(<span class="predefined-type">Class</span>&lt;?&gt; serviceInterface, RestClientBuilder builder);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>which can access a <code>RestClientBuilder</code> upon creation of a new <code>RestClientBuilder</code> or upon the execution of <code>RestClientBuilder.build()</code>, respectively.
Implementations must be declared in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>META-INF/services/org.eclipse.microprofile.rest.client.spi.RestClientBuilderListener</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>META-INF/services/org.eclipse.microprofile.rest.client.spi.RestClientListener</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_declarative_specification_of_headers"><a class="anchor" href="#_declarative_specification_of_headers"></a>55.3.4. Declarative specification of headers</h4>
<div class="paragraph">
<p>One way of declaring a header to be included in a request is by annotating one of the resource method parameters with <code>@HeaderValue</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
<span class="annotation">@Consumes</span>(MediaType.TEXT_PLAIN)
<span class="predefined-type">String</span> contentLang(<span class="annotation">@HeaderParam</span>(HttpHeaders.CONTENT_LANGUAGE) <span class="predefined-type">String</span> contentLanguage, <span class="predefined-type">String</span> subject);</code></pre>
</div>
</div>
<div class="paragraph">
<p>That option is available with RESTEasy client proxies as well, but in case it is inconvenient or otherwise inappropriate to include the necessary parameter, MicroProfile Client makes a declarative alternative available through the use of the <code>org.eclipse.microprofile.rest.client.annotation.ClientHeaderParam</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
<span class="annotation">@Consumes</span>(MediaType.TEXT_PLAIN)
<span class="annotation">@ClientHeaderParam</span>(name=HttpHeaders.CONTENT_LANGUAGE, value=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">String</span> contentLang(<span class="predefined-type">String</span> subject);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the header value is hardcoded, but it is also possible to compute a value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@POST</span>
<span class="annotation">@Produces</span>(MediaType.TEXT_PLAIN)
<span class="annotation">@Consumes</span>(MediaType.TEXT_PLAIN)
<span class="annotation">@ClientHeaderParam</span>(name=HttpHeaders.CONTENT_LANGUAGE, value=<span class="string"><span class="delimiter">&quot;</span><span class="content">{getLanguage}</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">String</span> contentLang(<span class="predefined-type">String</span> subject);

<span class="keyword">default</span> <span class="predefined-type">String</span> getLanguage() {
   <span class="keyword">return</span> headers.getFirst(HttpHeaders.CONTENT_LANGUAGE);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_propagating_headers_on_the_server"><a class="anchor" href="#_propagating_headers_on_the_server"></a>55.3.5. Propagating headers on the server</h4>
<div class="paragraph">
<p>An instance of <code>org.eclipse.microprofile.rest.client.ext.ClientHeadersFactory</code>,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ClientHeadersFactory</span> {

<span class="comment">/**
 * Updates the HTTP headers to send to the remote service. Note that providers
 * on the outbound processing chain could further update the headers.
 *
 * @param incomingHeaders - the map of headers from the inbound Jakarta RESTful Web Services request. This will
 * be an empty map if the associated client interface is not part of a Jakarta RESTful Web Services request.
 * @param clientOutgoingHeaders - the read-only map of header parameters specified on the
 * client interface.
 * @return a map of HTTP headers to merge with the clientOutgoingHeaders to be sent to
 * the remote service.
 */</span>
MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; update(MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; incomingHeaders,
                                      MultivaluedMap&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; clientOutgoingHeaders);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>if activated, can do a bulk transfer of incoming headers to an outgoing request.
The default instance <code>org.eclipse.microprofile.rest.client.ext.DefaultClientHeadersFactoryImpl</code> will return a map consisting of those incoming headers listed in the comma separated configuration property</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>org.eclipse.microprofile.rest.client.propagateHeaders</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order for an instance of <code>ClientHeadersFactory</code> to be activated, the interface must be annotated with <code>org.eclipse.microprofile.rest.client.annotation.RegisterClientHeaders</code>.
Optionally, the annotation may include a value field set to an implementation class; without an explicit value, the default instance will be used.</p>
</div>
<div class="paragraph">
<p>Although a <code>ClientHeadersFactory</code> is not officially designated as a provider, it is now (as of MicroProfile REST Client specification 1.4) subject to injection.
In particular, when an instance of <code>ClientHeadersFactory</code> is managed by CDI, then CDI injection is mandatory.
When a REST Client is executing in the context of a Jakarta RESTful Web Services implementation, then <code>@Context</code> injection into a <code>ClientHeadersFactory</code> is currently optional.
RESTEasy supports CDI injection and does not currently support @Context injection.</p>
</div>
</div>
<div class="sect3">
<h4 id="_responseexceptionmapper"><a class="anchor" href="#_responseexceptionmapper"></a>55.3.6. ResponseExceptionMapper</h4>
<div class="paragraph">
<p>The <code>org.eclipse.microprofile.rest.client.ext.ResponseExceptionMapper</code> is the client side inverse of the
<code>jakarta.ws.rs.ext.ExceptionMapper</code> defined in Jakarta RESTful Web Services. That is, where <code>ExceptionMapper.toResponse()</code> turns an
<code>Exception</code> thrown during server side processing into a <code>Response</code>, <code>ResponseExceptionMapper.toThrowable()</code> turns a
<code>Response</code> received on the client side with an HTTP error status into an <code>Exception</code>. <code>ResponseExceptionMapper</code> can be
registered in the same manner as other providers, that is, either programmatically or declaratively.
In the absence of a registered <code>ResponseExceptionMapper</code>, a default <code>ResponseExceptionMapper</code> will map any response with status &gt;= 400 to a <code>WebApplicationException</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_proxy_injection_by_cdi"><a class="anchor" href="#_proxy_injection_by_cdi"></a>55.3.7. Proxy injection by CDI</h4>
<div class="paragraph">
<p>MicroProfile Rest Client mandates that implementations must support CDI injection of proxies.
At first, the concept might seem odd in that CDI is more commonly available on the server side.
However, the idea is very consistent with the microservices philosophy.
If an application is composed of a number of small services, then it is to be expected that services will often act as clients to other services.</p>
</div>
<div class="paragraph">
<p>CDI (Contexts and Dependency Injection) is a fairly rich subject and beyond the scope of this Guide.
For more information, see <a href="https://jakarta.ee/specifications/cdi/3.0/jakarta-cdi-spec-3.0.html">Jakarta Contexts and Dependency Injection</a> (the specification), <a href="https://eclipse-ee4j.github.io/jakartaee-tutorial/">Jakarta EE Tutorial</a>, or <a href="https://docs.jboss.org/weld/reference/latest-3.1/en-US/html_single/">WELD - CDI Reference Implementation</a>.</p>
</div>
<div class="paragraph">
<p>The fundamental thing to know about CDI injection is that annotating a variable with <code>jakarta.inject.Inject</code> will lead the CDI runtime (if it is present and enabled) to create an object of the appropriate type and assign it to the variable.
For example, in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">   <span class="directive">public</span> <span class="type">interface</span> <span class="class">Book</span> {
      <span class="predefined-type">String</span> getTitle();
       <span class="type">void</span> setTitle(<span class="predefined-type">String</span> title);
   }

   <span class="annotation">@Dependent</span>
   <span class="directive">public</span> <span class="type">class</span> <span class="class">BookImpl</span> <span class="directive">implements</span> <span class="predefined-type">Book</span> {

      <span class="directive">private</span> <span class="predefined-type">String</span> title;

      <span class="annotation">@Override</span>
      <span class="directive">public</span> <span class="predefined-type">String</span> getTitle() {
         <span class="keyword">return</span> title;
      }

      <span class="annotation">@Override</span>
      <span class="directive">public</span> <span class="type">void</span> setTitle(<span class="predefined-type">String</span> title) {
         <span class="local-variable">this</span>.title = title;
      }
   }

   <span class="directive">public</span> <span class="type">class</span> <span class="class">Author</span> {

      <span class="annotation">@Inject</span>
      <span class="directive">private</span> <span class="predefined-type">Book</span> book;

      <span class="directive">public</span> <span class="predefined-type">Book</span> getBook() {
         <span class="keyword">return</span> book;
      }
   }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CDI runtime will create an instance of <code>BookImpl</code> and assign it to the private field <code>book</code> when an instance of <code>Author</code> is created;</p>
</div>
<div class="paragraph">
<p>In this example, the injection is done because <code>BookImpl</code> is assignable to <code>book</code>, but greater discrimination can be imposed by annotating the interface and the field with <strong>qualifier</strong> annotations.
For the injection to be legal, every qualifier on the field must be present on the injected interface.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Qualifier</span>
<span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD, <span class="predefined-type">ElementType</span>.PARAMETER, <span class="predefined-type">ElementType</span>.FIELD})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Text {}

<span class="annotation">@Qualifier</span>
<span class="annotation">@Target</span>({<span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD, <span class="predefined-type">ElementType</span>.PARAMETER, <span class="predefined-type">ElementType</span>.FIELD})
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> Graphic {}

<span class="annotation">@Text</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TextBookImpl</span> <span class="directive">extends</span> BookImpl { }

<span class="annotation">@Graphic</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">GraphicNovelImpl</span> <span class="directive">extends</span> BookImpl { }

<span class="directive">public</span> <span class="type">class</span> <span class="class">Genius</span> {

  <span class="annotation">@Inject</span> <span class="annotation">@Graphic</span>
  <span class="predefined-type">Book</span> book;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the class <code>TextBookImpl</code> is annotated with the <code>@Text</code> qualifier and <code>GraphicNovelImpl</code> is annotated with <code>@Graphic</code>.
It follows that an instance of <code>GraphicNovelImpl</code> is eligible for assignment to the field <code>book</code> in the <code>Genius</code> class, but an instance of <code>TextBookImpl</code> is not.</p>
</div>
<div class="paragraph">
<p>Now, in MicroProfile Rest Client, any interface that is to be managed as a CDI bean must be annotated with <code>@RegisterRestClient</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">resource</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RegisterProvider</span>(MyClientResponseFilter.class)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestResourceImpl</span> {

  <span class="annotation">@Inject</span> TestDataBase db;

  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test/{path}</span><span class="delimiter">&quot;</span></span>)
  <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/plain</span><span class="delimiter">&quot;</span></span>)
  <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>)
  <span class="annotation">@POST</span>
  <span class="directive">public</span> <span class="predefined-type">String</span> test(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> path, <span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">query</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> query, <span class="predefined-type">String</span> entity) {
     <span class="keyword">return</span> db.getByName(query);
  }
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">database</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RegisterRestClient</span>
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TestDataBase</span> {

  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
  <span class="annotation">@POST</span>
  <span class="directive">public</span> <span class="predefined-type">String</span> getByName(<span class="predefined-type">String</span> name);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the MicroProfile Rest Client implementation creates a proxy for a <code>TestDataBase</code> service, allowing easy access by <code>TestResourceImpl</code>.
Notice, though, that there&#8217;s no indication of where the <code>TestDataBase</code> implementation lives.
That information can be supplied by the optional <code>@RegisterProvider</code> parameter <code>baseUri</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">database</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RegisterRestClient</span>(baseUri=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://localhost:8080/webapp</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TestDataBase</span> {

  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
  <span class="annotation">@POST</span>
  <span class="predefined-type">String</span> getByName(<span class="predefined-type">String</span> name);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>which indicates that an implementation of <code>TestDatabase</code> can be accessed at <a href="https://localhost:8080/webapp" class="bare">https://localhost:8080/webapp</a>.
The same information can be supplied externally with the system variable</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>fqn of TestDataBase/mp-rest/uri=URL</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>fqn of TestDataBase/mp-rest/url=URL</code></pre>
</div>
</div>
<div class="paragraph">
<p>which will override the value hardcoded in <code>@RegisterRestClient</code>.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>com.bluemonkeydiamond.TestDatabase/mp-rest/url=https://localhost:8080/webapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>A number of other properties will be examined in the course of creating the proxy, including, for example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>com.bluemonkeydiamond.TestDatabase/mp-rest/providers</code></pre>
</div>
</div>
<div class="paragraph">
<p>a comma separated list of provider classes to be registered with the proxy.
See the MicroProfile Client documentation for more such properties.</p>
</div>
<div class="paragraph">
<p>These properties can be simplified through the use of the <code>configKey</code> field in <code>@RegisterRestClient</code>.
For example, setting the <code>configKey</code> as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">database</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RegisterRestClient</span>(configKey=<span class="string"><span class="delimiter">&quot;</span><span class="content">bmd</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TestDataBase</span> {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>allows the use of properties like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>bmd/mp-rest/url=https://localhost:8080/webapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that, since the configKey is not tied to a particular interface name, multiple proxies can be configured with the same properties.</p>
</div>
</div>
<div class="sect3">
<h4 id="_proxy_lifecycle"><a class="anchor" href="#_proxy_lifecycle"></a>55.3.8. Proxy lifecycle</h4>
<div class="paragraph">
<p>Proxies should be closed so that any resources they hold can be released.
Every proxy created by <code>RestClientBuilder</code> implements the <code>java.io.Closeable</code> interface, so it is always possible to cast a proxy to <code>Closeable</code> and call <code>close()</code>.
A nice trick to have the proxy interface explicitly extend <code>Closeable</code>, which not only avoids the need for a cast but also makes the proxy eligible to use in a try-with-resources block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">resource</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">TestResourceIntf</span> <span class="directive">extends</span> <span class="predefined-type">Closeable</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@GET</span>
   <span class="predefined-type">String</span> test();
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">String</span> checkResponse() {
    TestResourceClient service = RestClientBuilder.newBuilder()
                                  .baseUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/</span><span class="delimiter">&quot;</span></span>)
                                  .build(TestResourceClient.class);
    <span class="keyword">try</span> (TestResourceClient tr = service) {
       <span class="keyword">return</span> service.test();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_asynchronous_support"><a class="anchor" href="#_asynchronous_support"></a>55.3.9. Asynchronous support</h4>
<div class="paragraph">
<p>An interface method can be designated as asynchronous by having it return a <code>java.util.concurrent.CompletionStage</code>.
For example, in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">TestResourceClient</span> <span class="directive">extends</span> <span class="predefined-type">Closeable</span> {

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@GET</span>
   <span class="predefined-type">String</span> test();

   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">testasync</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@GET</span>
   CompletionStageString testAsync();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the <code>test()</code> method can be turned into the asynchronous method <code>testAsync()</code> by having it return a <code>CompletionStageString</code> instead of a <code>String</code>.</p>
</div>
<div class="paragraph">
<p>Asynchronous methods are made to be asynchronous by scheduling their execution on a thread distinct from the calling thread.
The MicroProfile Client implementation will have a default means of doing that, but <code>RestClientBuilder.executorService(ExecutorService)</code> provides a way of substituting an application specific <code>ExecutorService</code>.</p>
</div>
<div class="paragraph">
<p>The classes <code>AsyncInvocationInterceptorFactory</code> and <code>AsyncInvocationInterceptor</code> in package <code>org.eclipse.microprofile.rest.client.ext</code> provides a means of communication between the calling thread and the asynchronous thread:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">AsyncInvocationInterceptorFactory</span> {

    <span class="comment">/**
     * Implementations of this method should return an implementation of the
     * AsyncInvocationInterceptor interface.  The MP Rest Client
     * implementation runtime will invoke this method, and then invoke the
     * prepareContext and applyContext methods of the
     * returned interceptor when performing an asynchronous method invocation.
     * Null return values will be ignored.
     *
     * @return Non-null instance of AsyncInvocationInterceptor
     */</span>
    AsyncInvocationInterceptor newInterceptor();
}

<span class="directive">public</span> <span class="type">interface</span> <span class="class">AsyncInvocationInterceptor</span> {

    <span class="comment">/**
     * This method will be invoked by the MP Rest Client runtime on the &quot;main&quot;
     * thread (i.e. the thread calling the async Rest Client interface method)
     * prior to returning control to the calling method.
     */</span>
    <span class="type">void</span> prepareContext();

    <span class="comment">/**
     * This method will be invoked by the MP Rest Client runtime on the &quot;async&quot;
     * thread (i.e. the thread used to actually invoke the remote service and
     * wait for the response) prior to sending the request.
     */</span>
    <span class="type">void</span> applyContext();

    <span class="comment">/**
     * This method will be invoked by the MP Rest Client runtime on the &quot;async&quot;
     * thread (i.e. the thread used to actually invoke the remote service and
     * wait for the response) after all providers on the inbound response flow
     * have been invoked.
     *
     * @since 1.2
     */</span>
     <span class="type">void</span> removeContext();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following sequence of events occurs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>AsyncInvocationInterceptorFactory.newInterceptor()</code> is called on the calling thread to get an instance of the <code>AsyncInvocationInterceptor</code>.</p>
</li>
<li>
<p><code>AsyncInvocationInterceptor.prepareContext()</code> is executed on the calling thread to store information to be used by the request execution.</p>
</li>
<li>
<p><code>AsyncInvocationInterceptor.applyContext()</code> is executed on the  asynchronous thread.</p>
</li>
<li>
<p>All relevant outbound providers such as interceptors and filters are executed on the asynchronous thread, followed by the request invocation.</p>
</li>
<li>
<p>All relevant inbound providers are executed on the asynchronous thread, followed by executing <code>AsyncInvocationInterceptor.removeContext()</code></p>
</li>
<li>
<p>The asynchronous thread returns.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An <code>AsyncInvocationInterceptorFactory</code> class is enabled by registering it on the client interface with <code>@RegisterProvider</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ssl"><a class="anchor" href="#_ssl"></a>55.3.10. SSL</h4>
<div class="paragraph">
<p>The MicroProfile Client <code>RestClientBuilder</code> interface includes a number of methods that support the use of SSL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>RestClientBuilder hostnameVerifier(HostnameVerifier hostnameVerifier);
RestClientBuilder keyStore(KeyStore keyStore, String keystorePassword);
RestClientBuilder sslContext(SSLContext sslContext);
RestClientBuilder trustStore(KeyStore trustStore);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">KeyStore</span> trustStore = createTrustStore() ;
<span class="predefined-type">HostnameVerifier</span> verifier = createHostnameVerifier();
TestResourceIntf service = RestClientBuilder.newBuilder()
                              .baseUrl(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8081/</span><span class="delimiter">&quot;</span></span>)
                              .trustStore(trustStore)
                              .hostnameVerifier(verifier)
                              .build(TestResourceIntf.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to configure `HostnameVerifier`s, `KeyStore`s, and `TrustStore`s using configuration properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>com.bluemonkeydiamond.TestResourceIntf/mp-rest/hostnameVerifier</p>
</li>
<li>
<p>com.bluemonkeydiamond.TestResourceIntf/mp-rest/keyStore</p>
</li>
<li>
<p>com.bluemonkeydiamond.TestResourceIntf/mp-rest/keyStorePassword</p>
</li>
<li>
<p>com.bluemonkeydiamond.TestResourceIntf/mp-rest/keyStoreType</p>
</li>
<li>
<p>com.bluemonkeydiamond.TestResourceIntf/mp-rest/trustStore</p>
</li>
<li>
<p>com.bluemonkeydiamond.TestResourceIntf/mp-rest/trustStorePassword</p>
</li>
<li>
<p>com.bluemonkeydiamond.TestResourceIntf/mp-rest/trustStoreType</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The values of the "&#8230;&#8203;/mp-rest/keyStore" and "../mp-rest/trustStore" parameters can be either classpath resources (e.g., "classpath:/client-keystore.jks") or files (e.g., "file:/home/user/client-keystore.jks").</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ajax_client"><a class="anchor" href="#_ajax_client"></a>56. AJAX Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy resources can be accessed in JavaScript using AJAX using a proxy API generated by RESTEasy.</p>
</div>
<div class="sect2">
<h3 id="_generated_javascript_api"><a class="anchor" href="#_generated_javascript_api"></a>56.1. Generated JavaScript API</h3>
<div class="paragraph">
<p>RESTEasy can generate a JavaScript API that uses AJAX calls to invoke Jakarta RESTful Web Services operations.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. First Jakarta RESTful Web Services JavaScript API example</div>
<div class="content">
<div class="paragraph">
<p>Let&#8217;s take a simple Jakarta RESTful Web Services API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Orders</span> {
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getOrder(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id) {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="delimiter">&quot;</span></span>+id;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding API would be accessible using the following JavaScript code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="keyword">var</span> order = Orders.getOrder({<span class="key">id</span>: <span class="integer">23</span>});</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_javascript_api_servlet"><a class="anchor" href="#_javascript_api_servlet"></a>56.1.1. JavaScript API servlet</h4>
<div class="paragraph">
<p>In order to enable the JavaScript API servlet the user must configure it in the web.xml file as such:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;servlet&gt;</span>
     <span class="tag">&lt;servlet-name&gt;</span>RESTEasy JSAPI<span class="tag">&lt;/servlet-name&gt;</span>
     <span class="tag">&lt;servlet-class&gt;</span>org.jboss.resteasy.jsapi.JSAPIServlet<span class="tag">&lt;/servlet-class&gt;</span>
    <span class="tag">&lt;/servlet&gt;</span>

    <span class="tag">&lt;servlet-mapping&gt;</span>
     <span class="tag">&lt;servlet-name&gt;</span>RESTEasy JSAPI<span class="tag">&lt;/servlet-name&gt;</span>
     <span class="tag">&lt;url-pattern&gt;</span>/rest-js<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_javascript_api_usage"><a class="anchor" href="#_javascript_api_usage"></a>56.1.2. JavaScript API usage</h4>
<div class="paragraph">
<p>Each Jakarta RESTful Web Services resource class will generate a JavaScript object of the same name as the declaring class (or interface), which will contain every Jakarta RESTful Web Services method as properties.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Structure of Jakarta RESTful Web Services generated JavaScript</div>
<div class="content">
<div class="paragraph">
<p>For example, if the  resource X defines methods Y and Z:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">X</span>{
    <span class="annotation">@GET</span>
    <span class="predefined-type">String</span> Y();
    <span class="annotation">@PUT</span>
    <span class="type">void</span> Z(<span class="predefined-type">String</span> entity);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then the JavaScript API will define the following functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="keyword">var</span> X = {
 <span class="function">Y</span> : <span class="keyword">function</span>(params){},
 <span class="function">Z</span> : <span class="keyword">function</span>(params){}
};</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Each JavaScript API method takes an optional object as single parameter where each property is a cookie, header, path, query or form parameter as identified by their name, or the following special parameters:</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following special parameter names are subject to change.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$entity</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The entity to send as a PUT, POST request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$contentType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">As determined by <code>@Consumes</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The MIME type of the body entity sent as the Content-Type header.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$accepts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determined by <code>@Provides</code>, defaults to <strong>/</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The accepted MIME types sent as the Accept header.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$callback</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to a function(httpCode, xmlHttpRequest, value) for an asynchronous call. If not present, the call will be synchronous and return the value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$apiURL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determined by container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to the base URI of your Jakarta RESTful Web Services endpoint, not including the last slash.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$username</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If username and password are set, they will be used for credentials for the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$password</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If username and password are set, they will be used for credentials for the request.</p></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="title">Example 3. Using the API</div>
<div class="content">
<div class="paragraph">
<p>Here is an example of Jakarta RESTful Web Services API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Foo</span>{
    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@GET</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> get(<span class="annotation">@QueryParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">order</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> order, <span class="annotation">@HeaderParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">X-Foo</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> header,
                   <span class="annotation">@MatrixParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">colour</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> colour, <span class="annotation">@CookieParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Foo-Cookie</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> cookie){
    }
    <span class="annotation">@POST</span>
    <span class="directive">public</span> <span class="type">void</span> post(<span class="predefined-type">String</span> text){
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can use the previous Jakarta RESTful Web Services API in JavaScript using the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="keyword">var</span> text = Foo.get({<span class="key">order</span>: <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>, <span class="key"><span class="delimiter">'</span><span class="content">X-Foo</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>,
                    <span class="key">colour</span>: <span class="string"><span class="delimiter">'</span><span class="content">blue</span><span class="delimiter">'</span></span>, <span class="key"><span class="delimiter">'</span><span class="content">Foo-Cookie</span><span class="delimiter">'</span></span>: <span class="integer">123987235444</span>});
Foo.put({<span class="predefined">$entity</span>: text});</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_work_with_form"><a class="anchor" href="#_work_with_form"></a>56.1.3. Work with @Form</h4>
<div class="paragraph">
<p><code>@Form</code> is a RESTEasy specific annotation that allows the user to re-use any <code>@*Param</code> annotation within an injected class.
The generated JavaScript API will expand the parameters for use automatically.
Support we have the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MyForm</span> {
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">stuff</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> stuff;

    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">number</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="type">int</span> number;

    <span class="annotation">@HeaderParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">myHeader</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> <span class="predefined-type">String</span> header;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the resource is like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyResource</span> {

    <span class="annotation">@POST</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> postForm(<span class="annotation">@Form</span> MyForm myForm) {}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then the method can be called from JavaScript API like following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">MyResource.postForm({<span class="key">stuff</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>, <span class="key">myHeader</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">B</span><span class="delimiter">&quot;</span></span>, <span class="key">number</span>:<span class="integer">1</span>});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, <code>@Form</code> supports prefix mappings for lists and maps:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Person</span> {
    <span class="annotation">@Form</span>(prefix=<span class="string"><span class="delimiter">&quot;</span><span class="content">telephoneNumbers</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">List</span>&lt;TelephoneNumber&gt; telephoneNumbers;
    <span class="annotation">@Form</span>(prefix=<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Address&gt; addresses;
}

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TelephoneNumber</span> {
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">countryCode</span><span class="delimiter">&quot;</span></span>) <span class="directive">private</span> <span class="predefined-type">String</span> countryCode;
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">number</span><span class="delimiter">&quot;</span></span>) <span class="directive">private</span> <span class="predefined-type">String</span> number;
}

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Address</span> {
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">street</span><span class="delimiter">&quot;</span></span>) <span class="directive">private</span> <span class="predefined-type">String</span> street;
    <span class="annotation">@FormParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">houseNumber</span><span class="delimiter">&quot;</span></span>) <span class="directive">private</span> <span class="predefined-type">String</span> houseNumber;
}

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MyResource</span> {
    <span class="annotation">@POST</span>
    <span class="directive">public</span> <span class="type">void</span> postForm(<span class="annotation">@Form</span> Person p) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>From JavaScript the API could be called like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">MyResource.postForm({
    <span class="key">telephoneNumbers</span>:[
        {<span class="key"><span class="delimiter">&quot;</span><span class="content">telephoneNumbers[0].countryCode</span><span class="delimiter">&quot;</span></span>:<span class="integer">31</span>},
        {<span class="key"><span class="delimiter">&quot;</span><span class="content">telephoneNumbers[0].number</span><span class="delimiter">&quot;</span></span>:<span class="integer">12345678</span>},
        {<span class="key"><span class="delimiter">&quot;</span><span class="content">telephoneNumbers[1].countryCode</span><span class="delimiter">&quot;</span></span>:<span class="integer">91</span>},
        {<span class="key"><span class="delimiter">&quot;</span><span class="content">telephoneNumbers[1].number</span><span class="delimiter">&quot;</span></span>:<span class="integer">9717738723</span>}
    ],
    <span class="key">address</span>:[
        {<span class="key"><span class="delimiter">&quot;</span><span class="content">address[INVOICE].street</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Main Street</span><span class="delimiter">&quot;</span></span>},
        {<span class="key"><span class="delimiter">&quot;</span><span class="content">address[INVOICE].houseNumber</span><span class="delimiter">&quot;</span></span>:<span class="integer">2</span>},
        {<span class="key"><span class="delimiter">&quot;</span><span class="content">address[SHIPPING].street</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Square One</span><span class="delimiter">&quot;</span></span>},
        {<span class="key"><span class="delimiter">&quot;</span><span class="content">address[SHIPPING].houseNumber</span><span class="delimiter">&quot;</span></span>:<span class="integer">13</span>}
    ]
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mime_types_and_unmarshalling"><a class="anchor" href="#_mime_types_and_unmarshalling"></a>56.1.4. MIME types and unmarshalling.</h4>
<div class="paragraph">
<p>The Accept header sent by any client JavaScript function is controlled by the $accepts parameter, which overrides the @Produces annotation on the Jakarta RESTful Web Services endpoint.
The returned value however is controlled by the Content-Type header sent in the response as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MIME</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">text/xml,application/xml,application/*+xml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response entity is parsed as XML before being returned. The return value is thus a DOM Document.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/json</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response entity is parsed as JSON before being returned. The return value is thus a JavaScript Object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Anything else</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The response entity is returned raw.</p></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="title">Example 4. Unmarshalling example</div>
<div class="content">
<div class="paragraph">
<p>The RESTEasy JavaScript client API can automatically unmarshall JSON and XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Orders</span> {

    <span class="annotation">@XmlRootElement</span>
    <span class="type">class</span> <span class="class">Order</span> {
        <span class="annotation">@XmlElement</span>
        <span class="directive">private</span> <span class="predefined-type">String</span> id;

        <span class="directive">public</span> Order(){}

        <span class="directive">public</span> Order(<span class="predefined-type">String</span> id){
            <span class="local-variable">this</span>.id = id;
        }
        <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{id}/xml</span><span class="delimiter">&quot;</span></span>)
        <span class="annotation">@GET</span>
        <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">public</span> Order getOrderXML(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id){
            <span class="keyword">return</span> <span class="keyword">new</span> Order(id);
        }

        <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{id}/json</span><span class="delimiter">&quot;</span></span>)
        <span class="annotation">@GET</span>
        <span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">public</span> Order getOrderJSON(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> id){
            <span class="keyword">return</span> <span class="keyword">new</span> Order(id);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s look at what the preceding Jakarta RESTful Web Services API would give on the client side:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// this returns a JSON object</span>
<span class="keyword">var</span> orderJSON = Orders.getOrderJSON({<span class="key">id</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">23</span><span class="delimiter">&quot;</span></span>});
orderJSON.id == <span class="string"><span class="delimiter">&quot;</span><span class="content">23</span><span class="delimiter">&quot;</span></span>;

<span class="comment">// this one returns a DOM Document whose root element is the order, with one child (id)</span>
<span class="comment">// whose child is the text node value</span>
<span class="keyword">var</span> orderXML = Orders.getOrderXML({<span class="key">id</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">23</span><span class="delimiter">&quot;</span></span>});
orderXML.documentElement.childNodes[<span class="integer">0</span>].childNodes[<span class="integer">0</span>].nodeValue == <span class="string"><span class="delimiter">&quot;</span><span class="content">23</span><span class="delimiter">&quot;</span></span>;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mime_types_and_marshalling"><a class="anchor" href="#_mime_types_and_marshalling"></a>56.1.5. MIME types and marshalling.</h4>
<div class="paragraph">
<p>The Content-Type header sent in the request is controlled by the $contentType parameter which overrides the @Consumes annotation on the Jakarta RESTful Web Services endpoint.
The value passed as entity body using the $entity parameter is marshalled according to both its type and content type:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">MIME</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOM Element</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Empty or text/xml,application/xml,application/*+xml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The DOM Element is marshalled to XML before being sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaScript Object (JSON)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Empty or application/json</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The JSON object is marshalled to a JSON string before being sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Anything else</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Anything else</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The entity is sent as is.</p></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="title">Example 5. Marshalling example</div>
<div class="content">
<div class="paragraph">
<p>The RESTEasy JavaScript client API can automatically marshall JSON and XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">orders</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Orders</span> {

    <span class="annotation">@XmlRootElement</span>
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Order</span> {
        <span class="annotation">@XmlElement</span>
        <span class="directive">private</span> <span class="predefined-type">String</span> id;

        <span class="directive">public</span> Order(){}

        <span class="directive">public</span> Order(<span class="predefined-type">String</span> id){
            <span class="local-variable">this</span>.id = id;
        }
    }

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{id}/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@PUT</span>
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">default</span> <span class="type">void</span> putOrderXML(Order order){
        <span class="comment">// store order</span>
    }

    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{id}/json</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@PUT</span>
    <span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">default</span> <span class="type">void</span> putOrderJSON(Order order){
        <span class="comment">// store order</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s look at what the preceding Jakarta RESTful Web Services API would give on the client side:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// this saves a JSON object</span>
Orders.putOrderJSON({<span class="predefined">$entity</span>: {<span class="key">id</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">23</span><span class="delimiter">&quot;</span></span>}});

<span class="comment">// It is a bit more work with XML</span>
<span class="keyword">var</span> order = document.createElement(<span class="string"><span class="delimiter">&quot;</span><span class="content">order</span><span class="delimiter">&quot;</span></span>);
<span class="keyword">var</span> id = document.createElement(<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>);
order.appendChild(id);
id.appendChild(document.createTextNode(<span class="string"><span class="delimiter">&quot;</span><span class="content">23</span><span class="delimiter">&quot;</span></span>));
Orders.putOrderXML({<span class="predefined">$entity</span>: order});</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_javascript_api_to_build_ajax_queries"><a class="anchor" href="#_using_the_javascript_api_to_build_ajax_queries"></a>56.2. Using the JavaScript API to build AJAX queries</h3>
<div class="paragraph">
<p>The RESTEasy JavaScript API can also be used to manually construct your requests.</p>
</div>
<div class="sect3">
<h4 id="_the_rest_object"><a class="anchor" href="#_the_rest_object"></a>56.2.1. The REST object</h4>
<div class="paragraph">
<p>The REST object contains the following read-write properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">apiURL
 Set by default to the Jakarta RESTful Web Services root URL, used by every JavaScript client API functions when constructing the requests.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">log</p></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="title">Example 6. Using the REST object</div>
<div class="content">
<div class="paragraph">
<p>The REST object can be used to override RESTEasy JavaScript API client behaviour:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// Change the base URL used by the API:</span>
REST.apiURL = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://api.service.com</span><span class="delimiter">&quot;</span></span>;

<span class="comment">// log everything in a div element</span>
REST.<span class="function">log</span> = <span class="keyword">function</span>(text){
 jQuery(<span class="string"><span class="delimiter">&quot;</span><span class="content">#log-div</span><span class="delimiter">&quot;</span></span>).append(text);
};</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_rest_request_class"><a class="anchor" href="#_the_rest_request_class"></a>56.2.2. The REST.Request class</h4>
<div class="paragraph">
<p>The REST.Request class is used to build custom requests.
It has the following members:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Member</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">execute(callback)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Executes the request with all the information set in the current object. The value is never returned but passed to the optional argument callback.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setAccepts(acceptHeader)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the Accept request header. Defaults to */*.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setCredentials(username, password)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the request credentials.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setEntity(entity)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the request entity.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setContentType(contentTypeHeader)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the Content-Type request header.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setURI(uri)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the request URI. This should be an absolute URI.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setMethod(method)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the request method. Defaults to GET.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setAsync(async)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls whether the request should be asynchronous. Defaults to true.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addCookie(name, value)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ets the given cookie in the current document when executing the request. Beware that this will be persistent in your browser.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addQueryParameter(name, value)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds a query parameter to the URI query part.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addMatrixParameter(name, value)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds a matrix parameter (path parameter) to the last path segment of the request URI.</p></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="title">Example 7. Using the REST.Request class</div>
<div class="content">
<div class="paragraph">
<p>The REST.Request class can be used to build custom requests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="keyword">var</span> r = <span class="keyword">new</span> REST.Request();
r.setURI(<span class="string"><span class="delimiter">&quot;</span><span class="content">http://api.service.com/orders/23/json</span><span class="delimiter">&quot;</span></span>);
r.setMethod(<span class="string"><span class="delimiter">&quot;</span><span class="content">PUT</span><span class="delimiter">&quot;</span></span>);
r.setContentType(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>);
r.setEntity({<span class="key">id</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">23</span><span class="delimiter">&quot;</span></span>});
r.addMatrixParameter(<span class="string"><span class="delimiter">&quot;</span><span class="content">JSESSIONID</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">12309812378123</span><span class="delimiter">&quot;</span></span>);
r.execute(<span class="keyword">function</span>(status, request, entity){
 log(<span class="string"><span class="delimiter">&quot;</span><span class="content">Response is </span><span class="delimiter">&quot;</span></span>+status);
});</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_caching_features"><a class="anchor" href="#_caching_features"></a>56.3. Caching Features</h3>
<div class="paragraph">
<p>RESTEasy AJAX Client works well with server side caching features.
But the buggy browsers cache will  always prevent the function to work properly.
To use the RESTEasy caching feature with its AJAX client, enable the 'antiBrowserCache' option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">REST.antiBrowserCache = <span class="predefined-constant">true</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above setting should be set once before calling any APIs.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wadl"><a class="anchor" href="#_wadl"></a>57. RESTEasy WADL Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy has support to generate WADL for its resources. It supports several different containers. The following text
shows how to use this feature in different containers.</p>
</div>
<div class="sect2">
<h3 id="_resteasy_wadl_support_for_servlet_container_deprecated"><a class="anchor" href="#_resteasy_wadl_support_for_servlet_container_deprecated"></a>57.1. RESTEasy WADL Support for Servlet Container <strong>(Deprecated)</strong></h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The content introduced in this section is outdated, and the <code>ResteasyWadlServlet</code> class is deprecated because it
doesn&#8217;t support the GRAMMAR generation. Please check the <code>ResteasyWadlDefaultResource</code> introduced in the later section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>RESTEasy WADL uses <code>ResteasyWadlServlet</code> to support servlet container.
It must be registered in the web.xml to enable WADL feature.
Here is an example to show the usages of ResteasyWadlServlet in web.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;web-app&gt;</span>
    <span class="tag">&lt;servlet&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>RESTEasy WADL<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;servlet-class&gt;</span>org.jboss.resteasy.wadl.ResteasyWadlServlet<span class="tag">&lt;/servlet-class&gt;</span>
    <span class="tag">&lt;/servlet&gt;</span>

    <span class="tag">&lt;servlet-mapping&gt;</span>
        <span class="tag">&lt;servlet-name&gt;</span>RESTEasy WADL<span class="tag">&lt;/servlet-name&gt;</span>
        <span class="tag">&lt;url-pattern&gt;</span>/application.xml<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding configuration in web.xml shows how to enable ResteasyWadlServlet and map it to /application.xml, so then the WADL can be accessed from the configured URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>/application.xml</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resteasy_wadl_support_for_servlet_containerupdated"><a class="anchor" href="#_resteasy_wadl_support_for_servlet_containerupdated"></a>57.2. RESTEasy WADL Support for Servlet Container(Updated)</h3>
<div class="paragraph">
<p>This section introduces the recommended way to enable WADL support in a Servlet Container.
First, add a class that extends the <code>ResteasyWadlDefaultResource</code> to serve a resource path.
Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.wadl.ResteasyWadlDefaultResource</span>;
<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Path</span>;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyWadlResource</span> <span class="directive">extends</span> ResteasyWadlDefaultResource {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the sample shows above, it implements the <code>ResteasyWadlDefaultResource</code> and serves this URL by default:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>/application.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable the GRAMMAR generation, extend the <code>ResteasyWadlDefaultResource</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.jboss.resteasy.wadl.ResteasyWadlDefaultResource</span>;
<span class="keyword">import</span> <span class="include">org.jboss.resteasy.wadl.ResteasyWadlWriter</span>;

<span class="keyword">import</span> <span class="include">jakarta.ws.rs.Path</span>;

<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyWadlResource</span> <span class="directive">extends</span> ResteasyWadlDefaultResource {

    <span class="directive">public</span> MyWadlResource() {
        ResteasyWadlWriter.ResteasyWadlGrammar wadlGrammar = <span class="keyword">new</span> ResteasyWadlWriter.ResteasyWadlGrammar();
        wadlGrammar.enableSchemaGeneration();
        getWadlWriter().setWadlGrammar(wadlGrammar);

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the above setup, the WADL module will generate GRAMMAR automatically and register the service under this url:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>/wadl-extended/xsd0.xsd</code></pre>
</div>
</div>
<div class="paragraph">
<p>Above is the basic usage of the WADL module under a servlet container deployment.</p>
</div>
</div>
<div class="sect2">
<h3 id="_resteasy_wadl_support_for_sun_jdk_http_server"><a class="anchor" href="#_resteasy_wadl_support_for_sun_jdk_http_server"></a>57.3. RESTEasy WADL support for Sun JDK HTTP Server</h3>
<div class="paragraph">
<p>RESTEasy provides a <code>ResteasyWadlDefaultResource</code> to generate WADL info for its embedded containers.
Here is an example to show how to use it with RESTEasy&#8217;s Sun JDK HTTP Server container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>com.sun.net.httpserver.HttpServer httpServer =
    com.sun.net.httpserver.HttpServer.create(new InetSocketAddress(port), 10);

org.jboss.resteasy.plugins.server.sun.http.HttpContextBuilder contextBuilder =
    new org.jboss.resteasy.plugins.server.sun.http.HttpContextBuilder();

contextBuilder.getDeployment().getActualResourceClasses()
    .add(ResteasyWadlDefaultResource.class);
contextBuilder.bind(httpServer);

ResteasyWadlDefaultResource.getServices()
    .put(&quot;/&quot;,
        ResteasyWadlGenerator
            .generateServiceRegistry(contextBuilder.getDeployment()));

httpServer.start();</code></pre>
</div>
</div>
<div class="paragraph">
<p>From the above code example, we can see how <code>ResteasyWadlDefaultResource</code> is registered in the deployment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>contextBuilder.getDeployment().getActualResourceClasses()
    .add(ResteasyWadlDefaultResource.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another important task is to use <code>ResteasyWadlGenerator</code> to generate the WADL info for the resources in the deployment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ResteasyWadlDefaultResource.getServices()
    .put(&quot;/&quot;,
        ResteasyWadlGenerator
            .generateServiceRegistry(contextBuilder.getDeployment()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the above configuration is set, users can access "/application.xml" to fetch the WADL info, because
<code>ResteasyWadlDefaultResource</code> has <code>@Path</code> set to "/application.xml" as default:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>@Path(&quot;/application.xml&quot;)
public class ResteasyWadlDefaultResource</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resteasy_wadl_support_for_netty_container"><a class="anchor" href="#_resteasy_wadl_support_for_netty_container"></a>57.4. RESTEasy WADL support for Netty Container</h3>
<div class="paragraph">
<p>RESTEasy WADL support for Netty Container is similar to the support for JDK HTTP Server.
It uses ResteasyWadlDefaultResource to serve '/application.xml' and ResteasyWadlGenerator to generate WADL info for resources.
Here is the sample code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ResteasyDeployment deployment = new ResteasyDeploymentImpl();

netty = new NettyJaxrsServer();
netty.setDeployment(deployment);
netty.setPort(port);
netty.setRootResourcePath(&quot;&quot;);
netty.setSecurityDomain(null);
netty.start();

deployment.getRegistry()
    .addPerRequestResource(ResteasyWadlDefaultResource.class);
ResteasyWadlDefaultResource.getServices()
    .put(&quot;/&quot;, ResteasyWadlGenerator.generateServiceRegistry(deployment));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note for all embedded containers like JDK HTTP Server and Netty Container, if the resources in the deployment changes at runtime, the ResteasyWadlGenerator.generateServiceRegistry() needs to be re-run to refresh the WADL info.</p>
</div>
</div>
<div class="sect2">
<h3 id="_resteasy_wadl_support_for_undertow_container"><a class="anchor" href="#_resteasy_wadl_support_for_undertow_container"></a>57.5. RESTEasy WADL Support for Undertow Container</h3>
<div class="paragraph">
<p>The RESTEasy Undertow Container is an embedded Servlet Container, and RESTEasy WADL provides a connector to it.
To use RESTEasy Undertow Container together with WADL support, add these three components into project maven dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>resteasy-wadl<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>resteasy-wadl-undertow-connector<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>resteasy-undertow<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The resteasy-wadl-undertow-connector provides a WadlUndertowConnector to help use WADL in RESTEasy Undertow Container.
Here is the code example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>UndertowJaxrsServer server = new UndertowJaxrsServer().start();
WadlUndertowConnector connector = new WadlUndertowConnector();
connector.deployToServer(server, MyApp.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The MyApp class shown in above code is a standard Jakarta RESTful Web Services Application class in your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ApplicationPath</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/base</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MyApp</span> <span class="directive">extends</span> Application {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; getClasses() {
        <span class="keyword">return</span> <span class="predefined-type">Set</span>.of(YourResource.class);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the Application is deployed to the <code>UndertowJaxrsServer</code> via <code>WadlUndertowConnector</code>, the user can access the
WADL info at "/application.xml" prefixed by the <code>@ApplicationPath</code> in the Application class.
To override the <code>@ApplicationPath</code>, use the other method in WadlUndertowConnector:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>public UndertowJaxrsServer deployToServer(UndertowJaxrsServer server, Class&lt;? extends Application&gt; application, String contextPath)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The "deployToServer" method shown above accepts a "contextPath" parameter, which can be used to override the
<code>@ApplicationPath</code> value in the Application class.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tracing_feature"><a class="anchor" href="#_tracing_feature"></a>58. RESTEasy Tracing Feature</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>58.1. Overview</h3>
<div class="paragraph">
<p>Tracing feature is a way for the users of the RESTEasy to understand what&#8217;s going on internally in the container when a request is processed.
It&#8217;s different from the pure logging system or profiling feature, which provides more general information about the request and response.</p>
</div>
<div class="paragraph">
<p>The tracing feature provides more internal states of the Jakarta RESTful Web Services container.
For example, it could be able to show what filters a request is going through, or how long a request is processed and other kinds of information.</p>
</div>
<div class="paragraph">
<p>Currently, it doesn&#8217;t have a standard or spec to define the tracing feature, so the tracing feature is tightly coupled
with the concrete Jakarta RESTful Web Services implementation itself. This chapter, discusses the design and usage of the tracing feature.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tracing_info_mode"><a class="anchor" href="#_tracing_info_mode"></a>58.2. Tracing Info Mode</h3>
<div class="paragraph">
<p>The RESTEasy tracing feature supports three logging mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OFF</p>
</li>
<li>
<p>ON_DEMAND</p>
</li>
<li>
<p>ALL</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>"ALL" will enable the tracing feature.
"ON_DEMAND" mode will give the control to the client side: A client can send a tracing request via HTTP header and get the tracing info back from response headers.
"OFF" mode disables the tracing feature, and is the default mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tracing_info_level"><a class="anchor" href="#_tracing_info_level"></a>58.3. Tracing Info Level</h3>
<div class="paragraph">
<p>The tracing info has three levels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SUMMARY</p>
</li>
<li>
<p>TRACE</p>
</li>
<li>
<p>VERBOSE</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The "SUMMARY" level will emit some brief tracing information.
The "TRACE" level will produce more detailed tracing information, and the "VERBOSE" level will generate extremely detailed tracing information.</p>
</div>
<div class="paragraph">
<p>The tracing feature relies on the JBoss Logging framework to produce the tracing info.
The JBoss Logging configuration controls the final output of the tracing info.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_usages"><a class="anchor" href="#_basic_usages"></a>58.4. Basic Usages</h3>
<div class="paragraph">
<p>By default, the tracing feature is turned off.
To enable the tracing feature, add the following dependency in your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-tracing-api<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because the tracing feature is an optional feature, the above dependency is provided by the
<a href="https://github.com/resteasy/resteasy-extensions">resteasy-extensions</a> project.</p>
</div>
<div class="paragraph">
<p>After including the dependency in the project, set the tracing mode and tracing level via the context-param parameters
in the project&#8217;s web.xml file.
Here is the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>resteasy.server.tracing.type<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>ALL<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>resteasy.server.tracing.threshold<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>SUMMARY<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Besides the above configuration, the user needs to make sure that the underlying log manager is configured
properly, so the tracing output can be viewed. Here is an example of the "logging.properties" for the JBoss Log Manager:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># Additional logger names to configure (root logger is always configured)
#loggers=org.foo.bar, org.foo.baz
# Root logger level
logger.level=ALL
# Declare handlers for the root logger
logger.handlers=CONSOLE,FILE
# Declare handlers for additional loggers
#logger.org.foo.bar.handlers=XXX, YYY
# Console handler configuration
handler.CONSOLE=org.jboss.logmanager.handlers.ConsoleHandler
handler.CONSOLE.properties=autoFlush
handler.CONSOLE.level=ALL
handler.CONSOLE.autoFlush=true
handler.CONSOLE.formatter=PATTERN
# File handler configuration
handler.FILE=org.jboss.logmanager.handlers.FileHandler
handler.FILE.level=ALL
handler.FILE.properties=autoFlush,fileName
handler.FILE.autoFlush=true
handler.FILE.fileName=/tmp/jboss.log
handler.FILE.formatter=PATTERN
# The log format pattern for both logs
formatter.PATTERN=org.jboss.logmanager.formatters.PatternFormatter
formatter.PATTERN.properties=pattern
formatter.PATTERN.pattern=%d{HH:mm:ss,SSS} %-5p [%c{1}] %m%n</code></pre>
</div>
</div>
<div class="paragraph">
<p>In above setting, the logger level is set to "ALL", and the output log file to "/tmp/jboss.log".  This example is reporting all the tracing information.</p>
</div>
<div class="paragraph">
<p>After enabling the tracing feature above, the tracing output looks like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>16:21:40,110 INFO  [general] org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@721299ff START baseUri=[http://localhost:8081/] requestUri=[http://localhost:8081/type] method=[GET] authScheme=[n/a] accept=n/a accept-encoding=n/a accept-charset=n/a accept-language=n/a content-type=n/a content-length=n/a  [ ---- ms]
16:21:40,110 TRACE [general] org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@721299ff START_HEADERS Other request headers: Connection=[Keep-Alive] Host=[localhost:8081] User-Agent=[Apache-HttpClient/4.5.4 (Java/1.8.0_201)]  [ ---- ms]
16:21:40,114 INFO  [general] org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@721299ff PRE_MATCH_SUMMARY PreMatchRequest summary: 0 filters [ 0.04 ms]
16:21:40,118 DEBUG [general] org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@721299ff REQUEST_FILTER Filter by [io.weli.tracing.HttpMethodOverride @60353244] [ 0.02 ms]
...
16:21:40,164 INFO  [general] org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@721299ff RESPONSE_FILTER_SUMMARY Response summary: 1 filters [ 8.11 ms]
16:21:40,164 INFO  [general] org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@721299ff FINISHED Response status: 200 [ ---- ms]</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are several part to the entries in the log information above.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Level Of The Log Entry</p>
<div class="paragraph">
<p>The entries log level is reported, such as "TRACE", "INFO", "DEBUG". The tracing feature maps its own tracing info
levels to the JBoss Logger output levels like this.</p>
</div>
</li>
<li>
<p>The Request Scope Id</p>
<div class="paragraph">
<p>A request id is listed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@721299ff</code></pre>
</div>
</div>
<div class="paragraph">
<p>This identifies which request the log entry belongs to.</p>
</div>
</li>
<li>
<p>The Type Of The Tracing Log</p>
<div class="paragraph">
<p>tracing log entries are divided into multiple categories, such as "START_HEADERS", "REQUEST_FILTER", "FINISHED", etc.</p>
</div>
</li>
<li>
<p>The Detail Of The Log Entry</p>
<div class="paragraph">
<p>The last part of a log entry is the detail message of this entry.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In next section describes how the tracing info is fetched from client side.</p>
</div>
</div>
<div class="sect2">
<h3 id="_client_side_tracing_info"><a class="anchor" href="#_client_side_tracing_info"></a>58.5. Client Side Tracing Info</h3>
<div class="paragraph">
<p>From the client side, request can be sent to the server side.
If the server side is configured properly to produce tracing info, the info will be sent back to client side via response headers.
For example, a request is sent to the server like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -i http://localhost:8081/foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>The tracing information is retrieved from the response header follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>HTTP/1.1 200 OK
X-RESTEasy-Tracing-026: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7a49a8aa MBW         [ ---- / 61.57 ms |  ---- %] [org.jboss.resteasy.plugins.providers.InputStreamProvider @1cbf0b08] is skipped
...
Date: Wed, 27 Mar 2019 09:39:50 GMT
Connection: keep-alive
X-RESTEasy-Tracing-000: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7a49a8aa START       [ ---- /  ---- ms |  ---- %] baseUri=[http://localhost:8081/] requestUri=[http://localhost:8081/type] method=[GET] authScheme=[n/a] accept=*/* accept-encoding=n/a accept-charset=n/a accept-language=n/a content-type=n/a content-length=n/a
...
X-RESTEasy-Tracing-025: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7a49a8aa MBW         [ ---- / 61.42 ms |  ---- %] [org.jboss.resteasy.plugins.providers.FileRangeWriter @35b791fa] is skipped</code></pre>
</div>
</div>
<div class="paragraph">
<p>From above output, the tracing info is in the response headers, and it is marked in sequence as in the form of "X-RESTEasy-Tracing-nnn".</p>
</div>
</div>
<div class="sect2">
<h3 id="_json_formatted_response"><a class="anchor" href="#_json_formatted_response"></a>58.6. Json Formatted Response</h3>
<div class="paragraph">
<p>The tracing log can be returned to client side in JSON format.
To use this feature, the user must specify a JSON provider for the tracing module to generate JSON formatted info.
There are two JSON providers to choose from.
Both support JSON data marshalling.
The first choice is to use the jackson2 provider:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-jackson2-provider<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The second choice is to use the json-binding provider:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>resteasy-json-binding-provider<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After including one of the above modules, send a request to server.
The JSON formatted tracing information will be returned.
Here is a request example (the example is provided at last section of this chapter):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -H &quot;X-RESTEasy-Tracing-Accept-Format: JSON&quot; -i http://localhost:8081/type</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above curl command, "X-RESTEasy-Tracing-Accept-Format: JSON" was added into the request header.
This is requesting the json formatted tracing info from server, and the tracing info in response header is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>X-RESTEasy-Tracing-000: [{&quot;event&quot;:&quot;START&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:195286694509932,&quot;text&quot;:&quot;baseUri=[http://localhost:8081/] requestUri=[http://localhost:8081/type] method=[GET] authScheme=[n/a] accept=*/* accept-encoding=n/a accept-charset=n/a accept-language=n/a content-type=n/a content-length=n/a &quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7f8a33b9&quot;},{&quot;event&quot;:&quot;START_HEADERS&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:195286695053606,&quot;text&quot;:&quot;Other request headers: Accept=[*/*] Host=[localhost:8081] User-Agent=[curl/7.54.0] X-RESTEasy-Tracing-Accept-Format=[JSON] &quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7f8a33b9&quot;}...{&quot;event&quot;:&quot;FINISHED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:195286729758836,&quot;text&quot;:&quot;Response status: 200&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7f8a33b9&quot;}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above text is the raw output from the response.
It can be formatted it to make it readable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">X-RESTEasy-Tracing-000</span><span class="delimiter">&quot;</span></span>: [
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">event</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">START</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">duration</span><span class="delimiter">&quot;</span></span>: <span class="integer">0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">timestamp</span><span class="delimiter">&quot;</span></span>: <span class="integer">195286694509932</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">baseUri=[http://localhost:8081/] requestUri=[http://localhost:8081/type] method=[GET] authScheme=[n/a] accept=*/* accept-encoding=n/a accept-charset=n/a accept-language=n/a content-type=n/a content-length=n/a </span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">requestId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7f8a33b9</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">event</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">START_HEADERS</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">duration</span><span class="delimiter">&quot;</span></span>: <span class="integer">0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">timestamp</span><span class="delimiter">&quot;</span></span>: <span class="integer">195286695053606</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Other request headers: Accept=[*/*] Host=[localhost:8081] User-Agent=[curl/7.54.0] X-RESTEasy-Tracing-Accept-Format=[JSON] </span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">requestId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7f8a33b9</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">event</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">PRE_MATCH_SUMMARY</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">duration</span><span class="delimiter">&quot;</span></span>: <span class="integer">14563</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">timestamp</span><span class="delimiter">&quot;</span></span>: <span class="integer">195286697637157</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">PreMatchRequest summary: 0 filters</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">requestId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7f8a33b9</span><span class="delimiter">&quot;</span></span>
        },
        {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">event</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">FINISHED</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">duration</span><span class="delimiter">&quot;</span></span>: <span class="integer">0</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">timestamp</span><span class="delimiter">&quot;</span></span>: <span class="integer">195286729758836</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Response status: 200</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">requestId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@7f8a33b9</span><span class="delimiter">&quot;</span></span>
        }
    ]
}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>From above shows the tracing info is returned as JSON text.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_demand_mode_usage"><a class="anchor" href="#_on_demand_mode_usage"></a>58.7. ON_DEMAND Mode Usage</h3>
<div class="paragraph">
<p>To use the ON_DEMAND mode, set the tracing mode via the context-param parameters in the project&#8217;s web.xml file.
Here is the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>resteasy.server.tracing.type<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>ON_DEMAND<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>From the client side, the user can send a request with additional tracing headers to enable the tracing feature and set the tracing level at per-request level.
Here is the trigger header to enable the tracing information for this request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>X-RESTEasy-Tracing-Accept</code></pre>
</div>
</div>
<div class="paragraph">
<p>By putting this header with any value in your header, the tracing information will be enabled for the request.
To control the tracing level, send this header with relative level value in the request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>X-RESTEasy-Tracing-Threshold</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is an example showing how to send the request with tracing feature enabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl --header &quot;X-RESTEasy-Tracing-Accept: ok&quot; --header &quot;X-RESTEasy-Tracing-Threshold: VERBOSE&quot; -i http://localhost:8081/foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the  tracing information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>X-RESTEasy-Tracing-026: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  5.95 ms |  ---- %] [org.jboss.resteasy.plugins.providers.FileProvider @37a3c619] is skipped
X-RESTEasy-Tracing-027: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  5.96 ms |  ---- %] [org.jboss.resteasy.plugins.providers.ByteArrayProvider @646b8da5] is skipped
X-RESTEasy-Tracing-028: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  5.97 ms |  ---- %] [org.jboss.resteasy.plugins.providers.StreamingOutputProvider @3b2a4bf4] is skipped
X-RESTEasy-Tracing-029: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  5.98 ms |  ---- %] [org.jboss.resteasy.plugins.providers.ReaderProvider @24729366] is skipped
X-RESTEasy-Tracing-030: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  5.99 ms |  ---- %] [org.jboss.resteasy.plugins.providers.DataSourceProvider @d481aff] is skipped
X-RESTEasy-Tracing-031: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  6.00 ms |  ---- %] [org.jboss.resteasy.plugins.providers.AsyncStreamingOutputProvider @35f6b856] is skipped
X-RESTEasy-Tracing-032: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  6.01 ms |  ---- %] [org.jboss.resteasy.plugins.providers.FileRangeWriter @5cea30f7] is skipped
X-RESTEasy-Tracing-033: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  6.02 ms |  ---- %] [org.jboss.resteasy.plugins.providers.InputStreamProvider @6c3361af] is skipped
X-RESTEasy-Tracing-034: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5e84478b MBW         [ ---- /  6.02 ms |  ---- %] WriteTo by org.jboss.resteasy.plugins.providers.StringTextStar</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition, this header can be used to set the tracing info format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>X-RESTEasy-Tracing-Accept-Format</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, set the value to 'JSON' to get the JSON formatted tracing info.
Here is the command example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl --header &quot;X-RESTEasy-Tracing-Accept: ok&quot; --header &quot;X-RESTEasy-Tracing-Threshold: VERBOSE&quot; --header &quot;X-RESTEasy-Tracing-Accept-Format: JSON&quot; -i http://localhost:8081/foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JSON formatted tracing info from the response header will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>X-RESTEasy-Tracing-000: [{&quot;event&quot;:&quot;START&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675323356714,&quot;text&quot;:&quot;baseUri=[http://localhost:8081/] requestUri=[http://localhost:8081/level] method=[GET] authScheme=[n/a] accept=*/* accept-encoding=n/a accept-charset=n/a accept-language=n/a content-type=n/a content-length=n/a &quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;START_HEADERS&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675323563245,&quot;text&quot;:&quot;Other request headers: Accept=[*/*] Host=[localhost:8081] User-Agent=[curl/7.79.1] X-RESTEasy-Tracing-Accept=[ok] X-RESTEasy-Tracing-Accept-Format=[JSON] X-RESTEasy-Tracing-Threshold=[VERBOSE] &quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;PRE_MATCH_SUMMARY&quot;,&quot;duration&quot;:5361,&quot;timestamp&quot;:1108675323671984,&quot;text&quot;:&quot;PreMatchRequest summary: 0 filters&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;REQUEST_FILTER_SUMMARY&quot;,&quot;duration&quot;:3675,&quot;timestamp&quot;:1108675324245024,&quot;text&quot;:&quot;Request summary: 0 filters&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MATCH_RUNTIME_RESOURCE&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675324473886,&quot;text&quot;:&quot;Matched resource: template=[[org.jboss.resteasy.core.registry.ClassExpression @335ce24a]] regexp=[\\Q\\E(.*)] matches=[[org.jboss.resteasy.core.registry.SegmentNode @3f56df02]] from=[]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MATCH_SUMMARY&quot;,&quot;duration&quot;:189460,&quot;timestamp&quot;:1108675324593863,&quot;text&quot;:&quot;RequestMatching summary&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MATCH_RESOURCE&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675324720925,&quot;text&quot;:&quot;Resource instance: [org.jboss.resteasy.core.ResourceMethodInvoker @1d4d0e20]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MATCH_RESOURCE_METHOD&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675324897726,&quot;text&quot;:&quot;Matched method  : public java.lang.String org.jboss.resteasy.tracing.examples.TracingConfigResource.level(jakarta.ws.rs.core.Configuration)&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;REQUEST_FILTER&quot;,&quot;duration&quot;:9518,&quot;timestamp&quot;:1108675325000692,&quot;text&quot;:&quot;Filter by [org.jboss.resteasy.plugins.providers.jackson.PatchMethodFilter @748a2754 #2147483647]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;REQUEST_FILTER&quot;,&quot;duration&quot;:3702,&quot;timestamp&quot;:1108675325018731,&quot;text&quot;:&quot;Filter by [org.jboss.resteasy.plugins.providers.sse.SseEventSinkInterceptor @7dad4808 #2147483647]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;REQUEST_FILTER_SUMMARY&quot;,&quot;duration&quot;:49575,&quot;timestamp&quot;:1108675325026071,&quot;text&quot;:&quot;Request summary: 2 filters&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;METHOD_INVOKE&quot;,&quot;duration&quot;:512182,&quot;timestamp&quot;:1108675325569769,&quot;text&quot;:&quot;Resource [SINGLETON|class org.jboss.resteasy.tracing.examples.TracingConfigResource|org.jboss.resteasy.tracing.examples.TracingConfigResource@2634d8ed] method=[public java.lang.String org.jboss.resteasy.tracing.examples.TracingConfigResource.level(jakarta.ws.rs.core.Configuration)]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;DISPATCH_RESPONSE&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675325849901,&quot;text&quot;:&quot;Response: [org.jboss.resteasy.specimpl.BuiltResponse @1b63a199 &lt;200/SUCCESSFUL|OK|java.lang.String @2e2fb68e&gt;]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;RESPONSE_FILTER&quot;,&quot;duration&quot;:7044,&quot;timestamp&quot;:1108675326500226,&quot;text&quot;:&quot;Filter by [org.jboss.resteasy.plugins.interceptors.MessageSanitizerContainerResponseFilter @bba8498 #4000]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_FIND&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326755389,&quot;text&quot;:&quot;Find MBW for type=[java.lang.String] genericType=[java.lang.String] mediaType=[[jakarta.ws.rs.core.MediaType @1cc060ef]] annotations=[@jakarta.ws.rs.GET(), @jakarta.ws.rs.Path(\&quot;/level\&quot;)]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SELECTED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326771918,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.StringTextStar @23ffcf54] IS writeable&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326783918,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.FileProvider @37a3c619] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326790367,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.ByteArrayProvider @646b8da5] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326796138,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.StreamingOutputProvider @3b2a4bf4] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326801733,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.ReaderProvider @24729366] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326810040,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.DataSourceProvider @d481aff] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326820622,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.AsyncStreamingOutputProvider @35f6b856] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326831804,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.FileRangeWriter @5cea30f7] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326840405,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.InputStreamProvider @6c3361af] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_FIND&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326885669,&quot;text&quot;:&quot;Find MBW for type=[java.lang.String] genericType=[java.lang.String] mediaType=[[jakarta.ws.rs.core.MediaType @1cc060ef]] annotations=[@jakarta.ws.rs.GET(), @jakarta.ws.rs.Path(\&quot;/level\&quot;)]&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SELECTED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326901119,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.StringTextStar @23ffcf54] IS writeable&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326929864,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.FileProvider @37a3c619] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326935210,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.ByteArrayProvider @646b8da5] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326942651,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.StreamingOutputProvider @3b2a4bf4] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326948715,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.ReaderProvider @24729366] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326954536,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.DataSourceProvider @d481aff] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326961563,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.AsyncStreamingOutputProvider @35f6b856] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326968934,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.FileRangeWriter @5cea30f7] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_SKIPPED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326974075,&quot;text&quot;:&quot;[org.jboss.resteasy.plugins.providers.InputStreamProvider @6c3361af] is skipped&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;MBW_WRITE_TO&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675326996329,&quot;text&quot;:&quot;WriteTo by org.jboss.resteasy.plugins.providers.StringTextStar&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;WI_SUMMARY&quot;,&quot;duration&quot;:528614,&quot;timestamp&quot;:1108675327196716,&quot;text&quot;:&quot;WriteTo summary: 0 interceptors&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;RESPONSE_FILTER_SUMMARY&quot;,&quot;duration&quot;:1671988,&quot;timestamp&quot;:1108675328127602,&quot;text&quot;:&quot;Response summary: 1 filters&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;},{&quot;event&quot;:&quot;FINISHED&quot;,&quot;duration&quot;:0,&quot;timestamp&quot;:1108675328830911,&quot;text&quot;:&quot;Response status: 200&quot;,&quot;requestId&quot;:&quot;org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@78dd0a57&quot;}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Above is the basic usage introduction of the ON_DEMAND tracing mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_list_of_tracing_events"><a class="anchor" href="#_list_of_tracing_events"></a>58.8. List Of Tracing Events</h3>
<div class="paragraph">
<p>The tracing events are defined in <a href="https://github.com/resteasy/resteasy-extensions/blob/master/tracing/src/main/java/org/jboss/resteasy/tracing/api/RESTEasyServerTracingEvent.java">RESTEasyServerTracingEvent</a>.
Here is a complete list of the tracing events and its descriptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DISPATCH_RESPONSE</p>
<div class="paragraph">
<p>Resource method invocation results to Jakarta RESTful Web Services Response.</p>
</div>
</li>
<li>
<p>EXCEPTION_MAPPING</p>
<div class="paragraph">
<p>ExceptionMapper invoked.</p>
</div>
</li>
<li>
<p>FINISHED</p>
<div class="paragraph">
<p>Request processing finished.</p>
</div>
</li>
<li>
<p>MATCH_LOCATOR</p>
<div class="paragraph">
<p>Matched sub-resource locator method.</p>
</div>
</li>
<li>
<p>MATCH_PATH_FIND</p>
<div class="paragraph">
<p>Matching path pattern.</p>
</div>
</li>
<li>
<p>MATCH_PATH_NOT_MATCHED</p>
<div class="paragraph">
<p>Path pattern not matched.</p>
</div>
</li>
<li>
<p>MATCH_PATH_SELECTED</p>
<div class="paragraph">
<p>Path pattern matched/selected.</p>
</div>
</li>
<li>
<p>MATCH_PATH_SKIPPED</p>
<div class="paragraph">
<p>Path pattern skipped as higher-priority pattern has been selected already.</p>
</div>
</li>
<li>
<p>MATCH_RESOURCE</p>
<div class="paragraph">
<p>Matched resource instance.</p>
</div>
</li>
<li>
<p>MATCH_RESOURCE_METHOD</p>
<div class="paragraph">
<p>Matched resource method.</p>
</div>
</li>
<li>
<p>MATCH_RUNTIME_RESOURCE</p>
<div class="paragraph">
<p>Matched runtime resource.</p>
</div>
</li>
<li>
<p>MATCH_SUMMARY</p>
<div class="paragraph">
<p>Matching summary.</p>
</div>
</li>
<li>
<p>METHOD_INVOKE</p>
<div class="paragraph">
<p>Resource method invoked.</p>
</div>
</li>
<li>
<p>PRE_MATCH</p>
<div class="paragraph">
<p>RESTEasy HttpRequestPreprocessor invoked.</p>
</div>
</li>
<li>
<p>PRE_MATCH_SUMMARY</p>
<div class="paragraph">
<p>RESTEasy HttpRequestPreprocessor invoked.</p>
</div>
</li>
<li>
<p>REQUEST_FILTER</p>
<div class="paragraph">
<p>ContainerRequestFilter invoked.</p>
</div>
</li>
<li>
<p>REQUEST_FILTER_SUMMARY</p>
<div class="paragraph">
<p>ContainerRequestFilter invocation summary.</p>
</div>
</li>
<li>
<p>RESPONSE_FILTER</p>
<div class="paragraph">
<p>ContainerResponseFilter invoked.</p>
</div>
</li>
<li>
<p>RESPONSE_FILTER_SUMMARY</p>
<div class="paragraph">
<p>ContainerResponseFilter invocation summary.</p>
</div>
</li>
<li>
<p>START</p>
<div class="paragraph">
<p>Request processing started.</p>
</div>
</li>
<li>
<p>START_HEADERS</p>
<div class="paragraph">
<p>All HTTP request headers.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_tracing_example"><a class="anchor" href="#_tracing_example"></a>58.9. Tracing Example</h3>
<div class="paragraph">
<p>The "resteasy-example" project, contains a
<a href="https://github.com/resteasy/resteasy-examples/tree/main/tracing-example">RESTEasy Tracing Example</a> to show the usages
of tracing features. Please check the example to see the usages in action.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validation"><a class="anchor" href="#_validation"></a>59. Validation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTEasy provides the support for validation mandated by the <a href="https://jakarta.ee/specifications/restful-ws/3.1/jakarta-restful-ws-spec-3.1">Jakarta RESTful Web Services, given the presence of an
implementation of the https://jakarta.ee/specifications/bean-validation/3.1/[Bean Validation specification</a> such as <a href="http://hibernate.org/validator/">Hibernate Validator</a>.</p>
</div>
<div class="paragraph">
<p>Validation provides a declarative way of imposing constraints on fields and properties of beans, bean classes, and the parameters and return values of bean methods.
For example, in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">all</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@TestClassConstraint</span>(<span class="integer">5</span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TestResource</span> {
   <span class="annotation">@Size</span>(min=<span class="integer">2</span>, max=<span class="integer">4</span>)
   <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">s</span><span class="delimiter">&quot;</span></span>)
   <span class="predefined-type">String</span> s;

   <span class="directive">private</span> <span class="predefined-type">String</span> t;

   <span class="annotation">@Size</span>(min=<span class="integer">3</span>)
   <span class="directive">public</span> <span class="predefined-type">String</span> getT() {
      <span class="keyword">return</span> t;
   }

   <span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">t</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="type">void</span> setT(<span class="predefined-type">String</span> t) {
      <span class="local-variable">this</span>.t = t;
   }

   <span class="annotation">@POST</span>
   <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">{s}/{t}/{u}</span><span class="delimiter">&quot;</span></span>)
   <span class="annotation">@Pattern</span>(regexp=<span class="string"><span class="delimiter">&quot;</span><span class="content">[a-c]+</span><span class="delimiter">&quot;</span></span>)
   <span class="directive">public</span> <span class="predefined-type">String</span> post(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">u</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> u) {
      <span class="keyword">return</span> u;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>the field <code>s</code> is constrained by the Bean Validation built-in annotation <code>@Size</code> to have between 2 and 4 characters, the property <code>t</code> is constrained to have at least 3 characters, and the <code>TestResource</code> object is constrained by the application defined annotation <code>@TestClassConstraint</code> to have the combined lengths of <code>s</code> and <code>t</code> less than 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Constraint</span>(validatedBy = TestClassValidator.class)
<span class="annotation">@Target</span>({TYPE})
<span class="annotation">@Retention</span>(RUNTIME)
<span class="directive">public</span> <span class="annotation">@interface</span> TestClassConstraint {
   <span class="predefined-type">String</span> message() <span class="keyword">default</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Concatenation of s and t must have length &gt; {value}</span><span class="delimiter">&quot;</span></span>;
   <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> groups() <span class="keyword">default</span> {};
   <span class="predefined-type">Class</span>&lt;? <span class="directive">extends</span> Payload&gt;<span class="type">[]</span> payload() <span class="keyword">default</span> {};
   <span class="type">int</span> value();
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">TestClassValidator</span> <span class="directive">implements</span> ConstraintValidator&lt;TestClassConstraint, TestResource&gt; {
   <span class="type">int</span> length;

   <span class="directive">public</span> <span class="type">void</span> initialize(TestClassConstraint constraintAnnotation) {
      length = constraintAnnotation.value();
   }

   <span class="directive">public</span> <span class="type">boolean</span> isValid(TestResource value, ConstraintValidatorContext context) {
      <span class="keyword">return</span> value.retrieveS().length() + value.getT().length() &lt; length;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the links above for more about how to create validation annotations.</p>
</div>
<div class="paragraph">
<p>Also, the method parameter <code>u</code> is constrained to have no more than 5 characters, and the return value of method <code>post</code>
is constrained by the built-in annotation <code>@Pattern</code> to match the regular expression "[a-c]+".</p>
</div>
<div class="paragraph">
<p>The sequence of validation constraint testing is as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the resource and validate property, and class constraints.</p>
</li>
<li>
<p>Validate the resource method parameters.</p>
</li>
<li>
<p>If no violations have been detected, call the resource method and validate the return value</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Though fields and properties are technically different, they are subject to the same kinds of constraints, so
they are treated the same in the context of validation. Together, they will both be referred to as "properties" herein.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_violation_reporting"><a class="anchor" href="#_violation_reporting"></a>59.1. Violation reporting</h3>
<div class="paragraph">
<p>If a validation problem occurs, either a problem with the validation definitions or a constraint violation, RESTEasy
will set the return header <code>org.jboss.resteasy.api.validation.Validation.VALIDATION_HEADER</code> ("validation-exception") to "true".</p>
</div>
<div class="paragraph">
<p>If RESTEasy detects a structural validation problem, such as a validation annotation with a  missing validator class,
it will return a String representation of a <code>jakarta.validation.ValidationException</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>jakarta.validation.ValidationException: HV000028: Unexpected exception during isValid call.[org.jboss.resteasy.test.validation.TestValidationExceptions$OtherValidationException]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If any constraint violations are detected, RESTEasy will return a report in one of a variety of formats.
If one of "application/xml" or "application/json" occur in the "Accept" request header, RESTEasy will return an
appropriately marshalled instance of <code>org.jboss.resteasy.api.validation.ViolationReport</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">violationReport</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ViolationReport</span> {

   <span class="directive">public</span> <span class="predefined-type">ArrayList</span>&lt;ResteasyConstraintViolation&gt; getPropertyViolations() {
      <span class="keyword">return</span> propertyViolations;
   }

   <span class="directive">public</span> <span class="predefined-type">ArrayList</span>&lt;ResteasyConstraintViolation&gt; getClassViolations() {
      <span class="keyword">return</span> classViolations;
   }

   <span class="directive">public</span> <span class="predefined-type">ArrayList</span>&lt;ResteasyConstraintViolation&gt; getParameterViolations() {
      <span class="keyword">return</span> parameterViolations;
   }

   <span class="directive">public</span> <span class="predefined-type">ArrayList</span>&lt;ResteasyConstraintViolation&gt; getReturnValueViolations() {
      <span class="keyword">return</span> returnValueViolations;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>org.jboss.resteasy.api.validation.ResteasyConstraintViolation</code> is defined:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">resteasyConstraintViolation</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ResteasyConstraintViolation</span> <span class="directive">implements</span> <span class="predefined-type">Serializable</span> {

   <span class="comment">/**
    * @return type of constraint
    */</span>
   <span class="directive">public</span> ConstraintType.Type getConstraintType() {
      <span class="keyword">return</span> constraintType;
   }

   <span class="comment">/**
    * @return description of element violating constraint
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getPath() {
      <span class="keyword">return</span> path;
   }

   <span class="comment">/**
    * @return description of constraint violation
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getMessage() {
      <span class="keyword">return</span> message;
   }

   <span class="comment">/**
    * @return object in violation of constraint
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> getValue() {
      <span class="keyword">return</span> value;
   }

   <span class="comment">/**
    * @return String representation of violation
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
      <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">[</span><span class="delimiter">&quot;</span></span> + type() + <span class="string"><span class="delimiter">&quot;</span><span class="content">]</span><span class="char">\r</span><span class="content">[</span><span class="delimiter">&quot;</span></span> + path + <span class="string"><span class="delimiter">&quot;</span><span class="content">]</span><span class="char">\r</span><span class="content">[</span><span class="delimiter">&quot;</span></span> + message + <span class="string"><span class="delimiter">&quot;</span><span class="content">]</span><span class="char">\r</span><span class="content">[</span><span class="delimiter">&quot;</span></span> + value + <span class="string"><span class="delimiter">&quot;</span><span class="content">]</span><span class="char">\r</span><span class="delimiter">&quot;</span></span>;
   }

   <span class="comment">/**
    * @return String form of violation type
    */</span>
   <span class="directive">public</span> <span class="predefined-type">String</span> type() {
      <span class="keyword">return</span> constraintType.toString();
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and <code>org.jboss.resteasy.api.validation.ConstraintType</code> is the enumeration</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ConstraintType</span> {
   <span class="directive">public</span> <span class="type">enum</span> <span class="predefined-type">Type</span> {CLASS, PROPERTY, PARAMETER, RETURN_VALUE}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If both "application/xml" or "application/json" occur in the "Accept" request header, the media type is chosen according to the ranking given by implicit or explicit "q" parameter values.
In the case of a tie, the returned media type is indeterminate.</p>
</div>
<div class="paragraph">
<p>If neither "application/xml" or "application/json" occur in the "Accept" request header, RESTEasy returns a report with a String representation of each <code>ResteasyConstraintViolation</code>, where each field is delimited by '[' and ']', followed by a '\r', with a final '\r' at the end.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>[PROPERTY]
[s]
[size must be between 2 and 4]
[a]

[PROPERTY]
[t]
[size must be between 3 and 5]
[z]

[CLASS]
[]
[Concatenation of s and t must have length &gt; 5]
[org.jboss.resteasy.validation.TestResource@68467a6f]

[PARAMETER]
[test.&lt;cross-parameter&gt;]
[Parameters must total &lt;= 7]
[[5, 7]]

[RETURN_VALUE]
[g.&lt;return value&gt;]
[size must be between 2 and 4]
[abcde]</code></pre>
</div>
</div>
<div class="paragraph">
<p>where the four fields are</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>type of constraint</p>
</li>
<li>
<p>path to violating element (e.g., property name, class name, method name and parameter name)</p>
</li>
<li>
<p>message</p>
</li>
<li>
<p>violating element</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <code>ViolationReport</code> can be reconsititued from the <code>String</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Client client = ClientBuilder.newClient();
Invocation.Builder request = client.target(...).request();
Response response = request.get();
<span class="keyword">if</span> (<span class="predefined-type">Boolean</span>.valueOf(response.getHeaders().getFirst(Validation.VALIDATION_HEADER))) {
   <span class="predefined-type">String</span> s = response.readEntity(<span class="predefined-type">String</span>.class);
   ViolationReport report = <span class="keyword">new</span> ViolationReport(s);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the path field is considered to be too much server side information, it can be suppressed by setting the parameter
"resteasy.validation.suppress.path" to "true". In that case, "*" will be returned in the path fields.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validation_service_providers"><a class="anchor" href="#_validation_service_providers"></a>Validation Service Providers</h3>
<div class="paragraph">
<p>The form of validation mandated by the Jakarta RESTful Web Services specification, based on Bean Validation 1.1 or greater, is supported
by the RESTEasy module resteasy-validator-provider, which produces the artifact resteasy-validator-provider-version.jar.
Validation is turned on by default (assuming resteasy-validator-provider-version.jar is available), though parameter and
return value validation can be turned off or modified in the validation.xml configuration file.
See the <a href="https://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/">Hibernate Validator</a> documentation for the details.</p>
</div>
<div class="paragraph">
<p>RESTEasy obtains a bean validation implementation by looking in the available <code>META-INF/services/jakarta.ws.rs.Providers</code>
files for an implementation of <code>ContextResolverGeneralValidator</code>, where <code>org.jboss.resteasy.spi.GeneralValidator</code> is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">GeneralValidator</span> {
   <span class="comment">/**
    * Validates all constraints on {@code object}.
    *
    * @param object object to validate
    * @param groups the group or list of groups targeted for validation (defaults to
    *        {@link Default})
    * @return constraint violations or an empty set if none
    * @throws IllegalArgumentException if object is {@code null}
    *         or if {@code null} is passed to the varargs groups
    * @throws ValidationException if a non recoverable error happens
    *         during the validation process
    */</span>
   <span class="type">void</span> validate(HttpRequest request, <span class="predefined-type">Object</span> object, <span class="predefined-type">Class</span>&lt;?&gt;... groups);
   <span class="comment">/**
    * Validates all constraints placed on the parameters of the given method.
    *
    * @param &lt;T&gt; the type hosting the method to validate
    * @param object the object on which the method to validate is invoked
    * @param method the method for which the parameter constraints is validated
    * @param parameterValues the values provided by the caller for the given method's
    *        parameters
    * @param groups the group or list of groups targeted for validation (defaults to
    *        {@link Default})
    * @return a set with the constraint violations caused by this validation;
    *         will be empty if no error occurs, but never {@code null}
    * @throws IllegalArgumentException if {@code null} is passed for any of the parameters
    *         or if parameters don't match with each other
    * @throws ValidationException if a non recoverable error happens during the
    *         validation process
    */</span>
   <span class="type">void</span> validateAllParameters(HttpRequest request, <span class="predefined-type">Object</span> object, <span class="predefined-type">Method</span> method, <span class="predefined-type">Object</span><span class="type">[]</span> parameterValues, <span class="predefined-type">Class</span>&lt;?&gt;... groups);

   <span class="comment">/**
    * Validates all return value constraints of the given method.
    *
    * @param &lt;T&gt; the type hosting the method to validate
    * @param object the object on which the method to validate is invoked
    * @param method the method for which the return value constraints is validated
    * @param returnValue the value returned by the given method
    * @param groups the group or list of groups targeted for validation (defaults to
    *        {@link Default})
    * @return a set with the constraint violations caused by this validation;
    *         will be empty if no error occurs, but never {@code null}
    * @throws IllegalArgumentException if {@code null} is passed for any of the object,
    *         method or groups parameters or if parameters don't match with each other
    * @throws ValidationException if a non recoverable error happens during the
    *         validation process
    */</span>
   <span class="type">void</span> validateReturnValue(
         HttpRequest request, <span class="predefined-type">Object</span> object, <span class="predefined-type">Method</span> method, <span class="predefined-type">Object</span> returnValue, <span class="predefined-type">Class</span>&lt;?&gt;... groups);

   <span class="comment">/**
    * Indicates if validation is turned on for a class.
    *
    * @param clazz Class to be examined
    * @return true if and only if validation is turned on for clazz
    */</span>
   <span class="type">boolean</span> isValidatable(<span class="predefined-type">Class</span>&lt;?&gt; clazz);

   <span class="comment">/**
    * Indicates if validation is turned on for a method.
    *
    * @param method method to be examined
    * @return true if and only if validation is turned on for method
    */</span>
   <span class="type">boolean</span> isMethodValidatable(<span class="predefined-type">Method</span> method);

   <span class="type">void</span> checkViolations(HttpRequest request);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The methods and the javadoc are adapted from the Bean Validation 1.1 classes <code>jakarta.validation.Validator</code> and <code>jakarta.validation.executable.ExecutableValidator</code>.</p>
</div>
<div class="paragraph">
<p>RESTEasy module resteasy-validator-provider supplies an implementation of <code>GeneralValidator</code>.
An alternative implementation may be supplied by implementing <code>ContextResolverGeneralValidator</code> and <code>org.jboss.resteasy.spi.validation.GeneralValidator</code>.</p>
</div>
<div class="paragraph">
<p>A validator intended to function in the presence of CDI must also implement the sub-interface</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">GeneralValidatorCDI</span> <span class="directive">extends</span> GeneralValidator {
   <span class="comment">/**
    * Indicates if validation is turned on for a class.
    *
    * This method should be called from the resteasy-core module. It should
    * test if injectorFactor is an instance of CdiInjectorFactory, which indicates
    * that CDI is active.  If so, it should return false. Otherwise, it should
    * return the same value returned by GeneralValidator.isValidatable().
    *
    * @param clazz Class to be examined
    * @param injectorFactory the InjectorFactory used for clazz
    * @return true if and only if validation is turned on for clazz
    */</span>
   <span class="type">boolean</span> isValidatable(<span class="predefined-type">Class</span>&lt;?&gt; clazz, InjectorFactory injectorFactory);

   <span class="comment">/**
    * Indicates if validation is turned on for a class.
    * This method should be called only from the resteasy-cdi module.
    *
    * @param clazz Class to be examined
    * @return true if and only if validation is turned on for clazz
    */</span>
   <span class="type">boolean</span> isValidatableFromCDI(<span class="predefined-type">Class</span>&lt;?&gt; clazz);

   <span class="comment">/**
    * Throws a ResteasyViolationException if any validation violations have been detected.
    * The method should be called only from the resteasy-cdi module.
    * @param request
    */</span>
   <span class="type">void</span> checkViolationsfromCDI(HttpRequest request);

   <span class="comment">/**
    * Throws a ResteasyViolationException if either a ConstraintViolationException or a
    * ResteasyConstraintViolationException is embedded in the cause hierarchy of e.
    *
    * @param request
    * @param e
    */</span>
   <span class="type">void</span> checkForConstraintViolations(HttpRequest request, <span class="exception">Exception</span> e);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The validator in resteasy-validator-provider implements GeneralValidatorCDI.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validation_implementations"><a class="anchor" href="#_validation_implementations"></a>59.2. Validation Implementations</h3>
<div class="paragraph">
<p>As mentioned above, RESTEasy validation requires an implementation of the <a href="https://jakarta.ee/specifications/bean-validation/3.1/">Bean Validation specification</a> such as <a href="http://hibernate.org/validator/">Hibernate Validator</a>.
Hibernate Validator is supplied automatically when RESTEasy is running in the context of WildFly.
Otherwise, it should be made available.
For example, in maven</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.hibernate.validator<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>hibernate-validator/artifactId<span class="error">&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_i18n"><a class="anchor" href="#_i18n"></a>60. Internationalization and Localization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the help of the JBoss Logging project, all log and exception messages in RESTEasy can be internationalized.
for more about JBoss Logging Tooling, see
<a href="https://jboss-logging.github.io/jboss-logging-tools/">https://jboss-logging.github.io/jboss-logging-tools/</a>, Chapters 4 and 5.</p>
</div>
<div class="sect2">
<h3 id="_internationalization"><a class="anchor" href="#_internationalization"></a>60.1. Internationalization</h3>
<div class="paragraph">
<p>Each module in RESTEasy that produces any text in the form of logging messages or exception messages has an interface named
org.jboss.resteasy&#8230;&#8203;i18n.Messages which contains the default messages. Those modules which do any logging also have an
interface named org.jboss.resteasy&#8230;&#8203;i18n.LogMessages which gives access to an underlying logger. With the exception of
the resteasy-core-spi module, all messages are in the <code>Messages</code> class. resteasy-core-spi has exception messages in the
<code>Messages</code> class and log messages in the <code>LogMessages</code> class.</p>
</div>
<div class="paragraph">
<p>Each message is prefixed by the project code "RESTEASY" followed by an ID which is unique to RESTEasy.
These IDs belong to the following ranges:</p>
</div>
<table class="tableblock frame-ends grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Range</th>
<th class="tableblock halign-left valign-top">Module</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000-2999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-core-spi log messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000-4499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-core-spi exception messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4500-4999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-client</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5000-5499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">providers/resteasy-atom</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5500-5999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">providers/fastinfoset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6000-6499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">providers/resteasy-html</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6500-6999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">providers/jaxb</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7500-7999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">providers/multipart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8000-8499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">providers/resteasy-hibernatevalidator-provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8500-8999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">providers/resteasy-validator-provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9500-9999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">async-http-servlet-3.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000-10499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-core</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10500-10999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-cdi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11500-11999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-jsapi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12000-12499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-links</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12500-12999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-servlet-initializer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13000-13499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resteasy-spring</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13500-13999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security/resteasy-crypto</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14000-14499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security/jose-jwt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14500-14999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security/keystone/keystone-as7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15000-15499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security/keystone/keystone-core</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15500-15999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security/resteasy-oauth</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16000-16499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security/skeleton-key-idm/skeleton-key-as7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16500-16999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security/skeleton-key-idm/skeleton-key-core</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17000-17499</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security/skeleton-key-idm/skeleton-key-idp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17500-17999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">server-adapters/resteasy-jdk-http</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">18500-18999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">server-adapters/resteasy-netty4</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, the Jakarta XML Binding provider contains the interface
<code>org.jboss.resteasy.plugins.providers.jaxb.i18.Messages</code>
which looks like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@MessageBundle</span>(projectCode = <span class="string"><span class="delimiter">&quot;</span><span class="content">RESTEASY</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">Messages</span> {
   Messages MESSAGES = org.jboss.logging.Messages.getBundle(Messages.class);
   <span class="type">int</span> BASE = <span class="integer">6500</span>;

   <span class="annotation">@Message</span>(id = BASE, value = <span class="string"><span class="delimiter">&quot;</span><span class="content">Collection wrapping failed, expected root element name of %s got %s</span><span class="delimiter">&quot;</span></span>)
   <span class="predefined-type">String</span> collectionWrappingFailedLocalPart(<span class="predefined-type">String</span> element, <span class="predefined-type">String</span> localPart);

   <span class="annotation">@Message</span>(id = BASE + <span class="octal">05</span>, value = <span class="string"><span class="delimiter">&quot;</span><span class="content">Collection wrapping failed, expect namespace of %s got %s</span><span class="delimiter">&quot;</span></span>)
   <span class="predefined-type">String</span> collectionWrappingFailedNamespace(<span class="predefined-type">String</span> namespace, <span class="predefined-type">String</span> uri);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of a message is retrieved by referencing a method and passing the appropriate parameters.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">throw</span> <span class="keyword">new</span> JAXBUnmarshalException(Messages.MESSAGES.collectionWrappingFailedLocalPart(wrapped.element(), ele.getName().getLocalPart()));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_localization"><a class="anchor" href="#_localization"></a>61. Localization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When RESTEasy is built with the "i18n" profile, a template properties file containing the default messages is created in a subdirectory of target/generated-translation-files. In the Jakarta XML Binding provider, for example, the
<code>Messages.i18n_locale_COUNTRY_VARIANT.properties</code> goes in the <code>org/jboss/resteasy/plugins/providers/jaxb/i18n</code>
directory, and the first few lines are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># Id: 6500
# Message: Collection wrapping failed, expected root element name of {0} got {1}
# @param 1: element -
# @param 2: localPart -
collectionWrappingFailedLocalPart=Collection wrapping failed, expected root element name of {0} got {1}
# Id: 6505
# Message: Collection wrapping failed, expect namespace of {0} got {1}
# @param 1: namespace -
# @param 2: uri -
collectionWrappingFailedNamespace=Collection wrapping failed, expect namespace of {0} got {1}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To provide the translation of the messages for a particular locale, the file should be renamed, replacing "locale", "COUNTRY", and "VARIANT" as appropriate (possibly omitting the latter two), and copied to the <code>src/main/resources</code> directory.
In the Jakarta XML Binding provider, it would go in src/main/resources/org/jboss/resteasy/plugins/providers/jaxb/i18n`.</p>
</div>
<div class="paragraph">
<p>For testing purposes, each module containing a Messages interface has two sample properties files, for the locale "en" and the imaginary locale "xx", in the <code>src/test/resources</code> directory.
They are copied to <code>src/main/resources</code> when the module is built and deleted when it is cleaned.</p>
</div>
<div class="paragraph">
<p>The <code>Messages.i18n_xx.properties</code> file in the Jakarta XML Binding provider, for example, looks like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># Id: 6500
# Message: Collection wrapping failed, expected root element name of {0} got {1}
# @param 1: element -
# @param 2: localPart -
collectionWrappingFailedLocalPart=Collection wrapping failed, expected root element name of {0} got {1}
# Id: 6505
# Message: Collection wrapping failed, expect namespace of {0} got {1}
# @param 1: namespace -
# @param 2: uri -
collectionWrappingFailedNamespace=aaa {0} bbb {1} ccc</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the value of <code>collectionWrappingFailedNamespace</code> is modified.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maven_and_resteasy"><a class="anchor" href="#_maven_and_resteasy"></a>62. Maven and RESTEasy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JBoss&#8217;s Maven Repository is at: <a href="https://repository.jboss.org/nexus/content/groups/public/" class="bare">https://repository.jboss.org/nexus/content/groups/public/</a>. The RESTEasy dependencies
from this repository are synchronized to Maven Central. Note it may take up to a day for this synchronization to happen.</p>
</div>
<div class="paragraph">
<p>RESTEasy is modularized into multiple components. Each component is accessible as a Maven artifact. As a convenience
RESTEasy provides a BOM containing the complete set of components with the appropriate versions for the "stack".</p>
</div>
<div class="paragraph">
<p>It is recommended to declare the BOM in your POM file, that way you will always be sure to get the correct version of the artifacts.
In addition, you will not need to declare the version of each RESTEasy artifact called out in the dependencies section.</p>
</div>
<div class="paragraph">
<p>Declare the BOM file in the dependencyManagement section of the POM file like this.
Note that Maven version 3.9.0 or higher is required to process BOM files.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencyManagement&gt;</span>
    <span class="tag">&lt;dependencies&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>resteasy-bom<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
            <span class="tag">&lt;scope&gt;</span>import<span class="tag">&lt;/scope&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/dependencyManagement&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Declare the specific RESTEasy artifacts you require in the dependencies section of the POM file like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>resteasy-client<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to reference a RESTEasy artifact version not in the current BOM by specifying a version in the dependency itself.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>resteasy-client<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>6.2.11.Final<span class="tag">&lt;version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_from_older_versions"><a class="anchor" href="#_migration_from_older_versions"></a>63. Migration from older versions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_migration_to_resteasy_3_0_series"><a class="anchor" href="#_migration_to_resteasy_3_0_series"></a>63.1. Migration to RESTEasy 3.0 series</h3>
<div class="paragraph">
<p>Many facilities from RESTEasy 2 appear in a different form in RESTEasy 3.
For example, much of the client framework in RESTEasy 2 is formalized, in modified form, in JAX-RS 2.0.
RESTEasy versions 3.0.x implement both the older deprecated form and the newer conformant form.
The deprecated form is moved to legacy module in RESTEasy 3.1 and finally removed in RESTEasy 4.
For more information on upgrading from various deprecated facilities in RESTEasy 2, see <a href="http://docs.jboss.org/resteasy/docs/resteasy-upgrade-guide-en-US.pdf" class="bare">http://docs.jboss.org/resteasy/docs/resteasy-upgrade-guide-en-US.pdf</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_migration_to_resteasy_3.1"><a class="anchor" href="#_migration_to_resteasy_3.1"></a>63.2. Migration to RESTEasy 3.1 series</h3>
<div class="paragraph">
<p>RESTEasy 3.1.0.Final release comes with many changes compared to previous 3.0 point releases.
User discernible changes in RESTEasy 3.1.0.Final include</p>
</div>
<div class="ulist">
<ul>
<li>
<p>module reorganization</p>
</li>
<li>
<p>package reorganization</p>
</li>
<li>
<p>new features</p>
</li>
<li>
<p>minor behavioral changes</p>
</li>
<li>
<p>miscellaneous changes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this chapter we focus on changes that might cause existing code to fail or behave in new ways.
The audience for this discussion may be partitioned into three subsets, depending on the version of RESTEasy currently in use, the API currently in use, and the API to be used after an upgrade to RESTEasy 3.1.
The following APIs are available:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>RESTEasy 2</strong>: RESTEasy 2 implements the JAX-RS 1 specification, and adds a variety of additional facilities, such as a client API, a caching system, an interceptor framework, etc. All of these user facing classes and interfaces comprise the RESTEasy 2 API.</p>
</li>
<li>
<p><strong>RESTEasy 3</strong>: RESTEasy 3 implements the JAX-RS 2 specification, and adds some additional facilities. Many of the non-spec facilities from the RESTEasy 2 API are formalized, in altered form, in JAX-RS 2, in which case the older facilites are deprecated. The non-deprecated user facing classes and interfaces in RESTEasy 3 comprise the RESTEasy 3 API.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These definitions are rather informal and imprecise, since the user facing classes / interfaces in Resteasy 3.0.19.Final, for example, are a proper superset of the user facing classes / interfaces in RESTEasy 3.0.1.Final.
For this discussion, we identify the API with the version currently in use in a given project.</p>
</div>
<div class="paragraph">
<p>Now, there are three potential target audiences of users planning to upgrade to RESTEasy 3.1.0.Final:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Those currently using RESTEasy API 3 with some RESTEasy 3.0.x release</p>
</li>
<li>
<p>Those currently using RESTEasy API 2 with some RESTEasy 2.x or 3.0.x release and planning to upgrade to RESTEasy API 3</p>
</li>
<li>
<p>Those currently using RESTEasy API 2 with some RESTEasy 2.x or 3.0.x release and planning to continue to use RESTEasy API 2</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Of these, users in Group 2 have the most work to do in upgrading from RESTEasy API 2 to RESTEasy API 3.
They should consult the separate guide <a href="http://docs.jboss.org/resteasy/docs/resteasy-upgrade-guide-en-US.pdf">Upgrading from RESTEasy 2 to RESTEasy 3</a>.</p>
</div>
<div class="paragraph">
<p>Ideally, users in Groups 1 and 3 might make some changes to take advantage of new features but would have no changes forced on them by reorganization or altered behavior.
Indeed, that is almost the case, but there are a few changes that they should be aware of.</p>
</div>
<div class="sect3">
<h4 id="_upgrading_with_resteasy_3_api"><a class="anchor" href="#_upgrading_with_resteasy_3_api"></a>63.2.1. Upgrading with RESTEasy 3 API</h4>
<div class="paragraph">
<p>All RESTEasy changes are documented in JIRA issues.
Issues that describe detectable changes in release 3.1.0.Final that might impact existing applications include</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://issues.jboss.org/browse/RESTEASY-1341">RESTEASY-1341: Build method of org.jboss.resteasy.client.jaxrs.internal.ClientInvocationBuilder always return the same instance.</a></p>
<div class="paragraph">
<p>When a <code>build()</code> method from</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.jboss.resteasy.client.jaxrs.internal.ClientInvocationBuilder</code> in resteasy-client,</p>
</li>
<li>
<p><code>org.jboss.resteasy.specimpl.LinkBuilderImpl</code> in resteasy-core,</p>
</li>
<li>
<p><code>org.jboss.resteasy.specimpl.ResteasyUriBuilder</code> in resteasy-jaxrs</p>
<div class="paragraph">
<p>is called, it will return a new object.
This behavior might be seen indirectly.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Builder builder = client.target(generateURL(path)).request();
Link link = <span class="keyword">new</span> LinkBuilderImpl().uri(href).build();
<span class="predefined-type">URI</span> uri = uriInfo.getBaseUriBuilder().path(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>).build();</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://issues.jboss.org/browse/RESTEASY-1433">RESTEASY-1433: Compile with JDK 1.8 source/target version</a></p>
<div class="paragraph">
<p>As it says.
Depending on the application, it might be necessary to recompile with a target of JDK 1.8 so that calls to RESTEasy code can work.</p>
</div>
</li>
<li>
<p><a href="https://issues.jboss.org/browse/RESTEASY-1484">RESTEASY-1484: CVE-2016-6346: Abuse of GZIPInterceptor in can lead to denial of service attack</a></p>
<div class="paragraph">
<p>Prior to release 3.1.0.Final, the default behavior of RESTEasy was to use GZIP to compress and decompress messages whenever "gzip" appeared in the Content-Encoding header.
However, decompressing messages can lead to security issues, so, as of release 3.1.0.Final, GZIP compression has to be enabled explicitly.
For details, see Chapter <a href="#_gzip">GZIP Compression/Decompression</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Because of some package reorganization due to RESTEASY-1531 (see below), the GZIP interceptors, which used to be
in package <code>org.jboss.resteasy.plugins.interceptors.encoding</code> are now in <code>org.jboss.resteasy.plugins.interceptors</code>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p><a href="https://issues.jboss.org/browse/RESTEASY-1531">RESTEASY-1531: Restore removed RESTEasy internal classes into a deprecated/disabled module</a></p>
<div class="paragraph">
<p>This issue is related to refactoring deprecated elements of the RESTEasy 2 API into a separate module, and, ideally, would have no bearing at all on RESTEasy 3.
However, a reorganization of packages has led to moving some non-deprecated API elements in the resteasy-core module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.jboss.resteasy.client.ClientURI</code> is now <code>org.jboss.resteasy.annotations.ClientURI</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.core.interception.JaxrsInterceptorRegistryListener</code> is now <code>org.jboss.resteasy.core.interception.jaxrs.JaxrsInterceptorRegistryListener</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.spi.interception.DecoratorProcessor</code> is now <code>org.jboss.resteasy.spi.DecoratorProcessor</code></p>
</li>
<li>
<p>All of the dynamic features and interceptors in the package <code>org.jboss.resteasy.plugins.interceptors.encoding</code> are now in
<code>org.jboss.resteasy.plugins.interceptors</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_migration_to_resteasy_3_5_series"><a class="anchor" href="#_migration_to_resteasy_3_5_series"></a>63.3. Migration to RESTEasy 3.5+ series</h3>
<div class="paragraph">
<p>RESTEasy 3.5 series is a spin-off of the old RESTEasy 3.0 series, featuring Jakarta RESTful Web Services implementation.</p>
</div>
<div class="paragraph">
<p>The reason why 3.5 comes from 3.0 instead of the 3.1 / 4.0 development streams is basically providing users with a selection of RESTEasy 4 critical / strategic new features, while ensuring full backward compatibility.
As a consequence, no major issues are expected when upgrading RESTEasy from 3.0.x to 3.5.x.
The 3.6 and all other 3.x minors after that are backward compatible evolutions of 3.5 series.</p>
</div>
<div class="paragraph">
<p>The natural upgrade path for users already on RESTEasy 3.1 series is straight to RESTEasy 4 instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_migration_to_resteasy_4_series"><a class="anchor" href="#_migration_to_resteasy_4_series"></a>63.4. Migration to RESTEasy 4 series</h3>
<div class="paragraph">
<p>User migrating from RESTEasy 3.0 and 3.5+ series should be aware of the changes mentioned in the <a href="#_migration_to_resteasy_3.1">RESTEasy 3.1 migration section</a>.
In addition to that, the aspects from the following sections are to be considered.</p>
</div>
<div class="sect3">
<h4 id="_public_private_api"><a class="anchor" href="#_public_private_api"></a>63.4.1. Public / private API</h4>
<div class="paragraph">
<p>The <code>resteasy-jaxrs</code> and <code>resteasy-client</code> modules in RESTEasy 3 contain most of the framework classes and there&#8217;s no real demarcation between what is internal implementation detail and what is for public consumption.
In WildFly, the artifact archives from those modules are also included in a public module.
Given the common expectation of full backward compatibility of whatever comes from public modules, to allow for easier project evolution and maintenance, in RESTEasy 4.0.0.Final those big components have been split as follows:</p>
</div>
<div class="sect4">
<h5 id="_resteasy_core_spi"><a class="anchor" href="#_resteasy_core_spi"></a>resteasy-core-spi</h5>
<div class="paragraph">
<p>The public classes of the former <code>resteasy-jaxrs</code> module; the following packages are included:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.jboss.resteasy.annotations</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.api.validation</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.spi</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.plugins.providers.validation</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_resteasy_core"><a class="anchor" href="#_resteasy_core"></a>resteasy-core</h5>
<div class="paragraph">
<p>The internal details of the former <code>resteasy-jaxrs</code> module, including classes from the following packages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.jboss.resteasy.core</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.mock</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.plugins</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.specimpl</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.tracing</code></p>
</li>
<li>
<p><code>org.jboss.resteasy.util</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_resteasy_client_api"><a class="anchor" href="#_resteasy_client_api"></a>resteasy-client-api</h5>
<div class="paragraph">
<p>The public classes from the former <code>resteasy-client</code> module, basically whatever is used for configuring the RESTEasy client additions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ClientHttpEngine</code> and <code>ClientHttpEngineBuilder</code></p>
</li>
<li>
<p><code>ProxyBuilder</code> and <code>ProxyConfig</code></p>
</li>
<li>
<p><code>ResteasyClient</code></p>
</li>
<li>
<p><code>ResteasyClientBuilder</code></p>
</li>
<li>
<p><code>ResteasyWebTarget</code></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The <code>ClientHttpEngineBuilder</code> has been deprecated and the <code>ClientHttpEngineFactory</code> should be used instead.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_resteasy_client"><a class="anchor" href="#_resteasy_client"></a>resteasy-client</h5>
<div class="paragraph">
<p>The remainings of the former <code>resteasy-client</code> module, internal details.</p>
</div>
<div class="paragraph">
<p>As a consequence of the split, all modules except <code>resteasy-core-spi</code> and <code>resteasy-client-api</code> are effectively private / internal.
User applications and integration code should not directly rely on classes from those modules, which can be changed without going through any formal deprecation process.</p>
</div>
<div class="paragraph">
<p>Unfortunately, the refactoring that led to this implied some unavoidable class moves and changes breaking backward compatibility.
A detailed list of the potentially problematic changes is available on the <a href="https://github.com/resteasy/Resteasy/pull/1697">refactoring PR</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_deprecated_classes_and_modules_removal"><a class="anchor" href="#_deprecated_classes_and_modules_removal"></a>63.4.2. Deprecated classes and modules removal</h4>
<div class="paragraph">
<p>All classes and modules that were deprecated in RESTEasy 3 have been dropped in 4.
In particular, this includes the legacy modules (<code>resteasy-legacy</code>, <code>security-legacy</code>) that were introduced in 3.1.</p>
</div>
<div class="paragraph">
<p>In addition to the legacy modules, few other modules have been dropped for multiple different reasons, including dependency on unsupported / abandoned libraries, better options available, etc:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>resteasy-jackson-provider</code>, users should rely on <code>resteasy-jackson2-provider</code> instead;</p>
</li>
<li>
<p><code>resteasy-jettison-provider</code>, users should rely on <code>resteasy-jackson2-provider</code> instead;</p>
</li>
<li>
<p><code>abdera-atom-provider</code>;</p>
</li>
<li>
<p><code>resteasy-yaml-provider</code>;</p>
</li>
<li>
<p><code>resteasy-rx-java</code>, users should rely on <code>resteasy-rx-java2</code> instead;</p>
</li>
<li>
<p><code>tjws</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>resteasy-validator-provider-11</code> is also gone, with the <code>resteasy-validator-provider</code> one now supporting Bean Validation 2.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_behavior_changes"><a class="anchor" href="#_behavior_changes"></a>63.4.3. Behavior changes</h4>
<div class="paragraph">
<p>With the <code>ClientHttpEngine</code> based on Apache HTTP Client 4.0 having gone (it was previously deprecated) and the engine based on version 4.3 of the same library being the default, the user might want to double check the notes about connection close in <a href="#_apache_4_3">Apache HTTP Client 4.3 APIs</a>.</p>
</div>
<div class="paragraph">
<p>The conversion of <code>String</code> objects to <code>MediaType</code> objects is quite common in RESTEasy; for performances reasons a cache has been added to store the results of that conversion; by default the cache keeps the result of 200 conversions, but the number can be configured by setting the <code>org.jboss.resteasy.max_mediatype_cache_size</code> system property.</p>
</div>
</div>
<div class="sect3">
<h4 id="_other_changes"><a class="anchor" href="#_other_changes"></a>63.4.4. Other changes</h4>
<div class="ulist">
<ul>
<li>
<p>In releases 3.x, when bean validation <a href="#_validation">Validation</a> threw instances of exceptions</p>
<div class="ulist">
<ul>
<li>
<p><code>jakarta.validation.ConstraintDefinitionException</code></p>
</li>
<li>
<p><code>jakarta.validation.ConstraintDeclarationException</code></p>
</li>
<li>
<p><code>jakarta.validation.GroupDefinitionException</code></p>
<div class="paragraph">
<p>they were wrapped in a <code>org.jboss.resteasy.api.validation.Resteasy.ResteasyViolationException</code>, which <code>org.jboss.resteasy.api.validation.ResteasyViolationExceptionMapper</code>, the built-in implementation of <code>jakarta.ws.rs.ext.ExceptionMapperjakarta.validation.ValidationException</code>, then turned into descriptive text.
As of release 4.0.0, instances of <code>ConstraintDefinitionException</code>, etc., are thrown as is.
They are still caught by <code>ResteasyViolationExceptionMapper</code>, so, in general, there is no detectable change.
It should be noted, however, that an implementation of <code>ExceptionMapperResteasyViolationException</code>, which, prior to release 4.0.0, would have caught wrapped instances of <code>ConstraintDefinitionException</code>, will not catch unwrapped instances.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>ResteasyProviderFactory</code> is now an abstract class and is meant to be created using its <code>getInstance()</code> and <code>newInstance()</code> methods. Moreover, on client side, the resolution of the current instance is cached for each thread local context classloader.</p>
</li>
<li>
<p>The <code>ResteasyClient</code> and <code>ResteasyClientBuilder</code> are now abstract classes (from <code>resteasy-client-api</code>) and are not
meant for user direct instantiation; plain Jakarta RESTful Web Services API usage is expected instead:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//ResteasyClient client = new ResteasyClientBuilder().build(); NO!</span>
<span class="comment">//if plain Jakarta RESTful Web Services is enough ...</span>
Client client = ClientBuilder.newClient();

<span class="comment">//if RESTEasy API is needed ...</span>
ResteasyClient client = (ResteasyClient)ClientBuilder.newClient();


<span class="comment">//ResteasyClientBuilder builder = new ResteasyClientBuilder(); NO!</span>
<span class="comment">//if plain Jakarta RESTful Web Services is enough ...</span>
ClientBuilder builder = ClientBuilder.newBuilder();

<span class="comment">//if RESTEasy API is needed ...</span>
ResteayClientBuilder builder = (ResteasyClientBuilder)ClientBuilder.newBuilder();</code></pre>
</div>
</div>
</li>
<li>
<p>The package <code>org.jboss.resteasy.plugins.stats</code> (which contains a resource and some related classes) has been moved out of the <code>resteasy-jaxb-provider</code> module into a <code>new resteasy-stats</code> module.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_books_you_can_read"><a class="anchor" href="#_books_you_can_read"></a>64. Books You Can Read</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are a number of great books that you can learn REST and Jakarta RESTful Web Services from</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://oreilly.com/catalog/9780596529260/">RESTful Web Services</a> by Leonard Richardson and Sam Ruby. A great introduction to REST.</p>
</li>
<li>
<p><a href="http://oreilly.com/catalog/9780596158040/">RESTful Java with JAX-RS</a> by Bill Burke. Overview of REST and detailed explanation of JAX-RS. Book examples are distributed with RESTEasy.</p>
</li>
<li>
<p><a href="http://oreilly.com/catalog/9780596808679/">RESTful Web Services Cookbook</a> by Subbu Allamaraju and Mike Amundsen. Detailed cookbook on how to design RESTful services.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 6.2.11.Final<br>
Last updated 2024-11-11 15:37:31 -0800
</div>
</div>
</body>
</html>